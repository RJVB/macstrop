diff --git a/ChangeLog b/ChangeLog
index 809b43f1..dc79b9a9 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -972,7 +972,7 @@ sox-12.18.1	2006-05-07
 
   o The "filter" effect could go into infinite drain mode.  Now
     only drain 1 buffer.  noisered as well.
-  o SoX was ignoring user aborts (ctrl-c) if it occured during
+  o SoX was ignoring user aborts (ctrl-c) if it occurred during
     effect drain operations.  This was bad if effects had
     bugs and stuck in infinite loop.
   o Stop SoX from crashing when file type could not be auto
diff --git a/Makefile.am b/Makefile.am
index 12076b13..e35071d9 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -3,7 +3,7 @@
 ACLOCAL_AMFLAGS = -I m4
 
 SUBDIRS = lpc10 libgsm src
-DIST_SUBDIRS = lpc10 libgsm src msvc9 msvc10
+DIST_SUBDIRS = lpc10 libgsm src msvc9 msvc10 msvc14
 
 RM = rm -f
 
diff --git a/configure.ac b/configure.ac
index 23138a95..a9339a56 100644
--- a/configure.ac
+++ b/configure.ac
@@ -170,10 +170,6 @@ if test "$GCC" = "yes"; then
 
     CFLAGS="$CFLAGS -Wall -W -Wmissing-prototypes -Wstrict-prototypes -pedantic"
 
-    AS_VERSION_COMPARE([$gccver], [4.3],
-       [WARN_CFLAGS="-Wconversion"],
-       [WARN_CFLAGS="-Wtraditional-conversion"],
-       [WARN_CFLAGS="-Wtraditional-conversion"])
     dnl Define stricter policy on GNU/Linux, all symbols must be resolved
     case $target in
       *linux* | *solaris*)
@@ -207,7 +203,7 @@ AC_HEADER_STDC
 AC_CHECK_HEADERS(fcntl.h unistd.h byteswap.h sys/stat.h sys/time.h sys/timeb.h sys/types.h sys/utsname.h termios.h glob.h fenv.h)
 
 dnl Checks for library functions.
-AC_CHECK_FUNCS(strcasecmp strdup popen vsnprintf gettimeofday mkstemp fmemopen)
+AC_CHECK_FUNCS(strcasecmp strdup popen vsnprintf gettimeofday mkstemp fmemopen aligned_alloc)
 
 dnl Check if math library is needed.
 AC_SEARCH_LIBS([pow], [m])
@@ -381,7 +377,7 @@ using_id3tag=no
 if test "$with_id3tag" != "no"; then
     using_id3tag=yes
     AC_CHECK_HEADER(id3tag.h,
-        [AC_CHECK_LIB(id3tag, id3_file_open, MP3_LIBS="$MP3_LIBS -lid3tag -lz",using_id3tag=no, -lz)],
+        [AC_CHECK_LIB(id3tag, id3_file_open, ID3_LIBS="-lid3tag -lz", using_id3tag=no, -lz)],
         using_id3tag=no)
     if test "$with_id3tag" = "yes" -a "$using_id3tag" = "no"; then
         AC_MSG_FAILURE([cannot find id3tag])
@@ -391,6 +387,7 @@ if test "$using_id3tag" = yes; then
    AC_DEFINE(HAVE_ID3TAG, 1, [Define to 1 if you have id3tag.])
 fi
 AM_CONDITIONAL(HAVE_ID3TAG, test x$using_id3tag = xyes)
+AC_SUBST(ID3_LIBS)
 
 
 
diff --git a/libsox.3 b/libsox.3
index 1233bc79..2af84484 100644
--- a/libsox.3
+++ b/libsox.3
@@ -175,7 +175,7 @@ failures. Currently, relies on \fBsox_warn\fR to print information.
 successfully read or written. If an error occurs, or the end-of-file
 is reached, the return value is a short item count or SOX_EOF. TODO:
 \fBsox_read\fR does not distiguish between end-of-file and error. Need
-an feof() and ferror() concept to determine which occured.
+an feof() and ferror() concept to determine which occurred.
 .P
 Upon successful completion \fBsox_close\fR returns 0. Otherwise, SOX_EOF
 is returned. In either case, any further access (including another
diff --git a/msvc10/LibSoX.vcxproj b/msvc10/LibSoX.vcxproj
index b2e9d5a3..ed202ff1 100644
--- a/msvc10/LibSoX.vcxproj
+++ b/msvc10/LibSoX.vcxproj
@@ -111,7 +111,6 @@
     <ClInclude Include="..\src\formats.h" />
     <ClInclude Include="..\src\g711.h" />
     <ClInclude Include="..\src\g72x.h" />
-    <ClInclude Include="..\src\ignore-warning.h" />
     <ClInclude Include="..\src\ima_rw.h" />
     <ClInclude Include="..\src\mcompand_xover.h" />
     <ClInclude Include="..\src\mp3-util.h" />
@@ -144,6 +143,8 @@
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
     </ClCompile>
+    <ClCompile Include="..\src\dsdiff.c" />
+    <ClCompile Include="..\src\dsf.c" />
     <ClCompile Include="..\src\example0.c">
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
@@ -172,6 +173,7 @@
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
     </ClCompile>
+    <ClCompile Include="..\src\sdm.c" />
     <ClCompile Include="..\src\skeleff.c">
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
       <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
@@ -204,6 +206,7 @@
     <ClCompile Include="..\src\dft_filter.c" />
     <ClCompile Include="..\src\dither.c" />
     <ClCompile Include="..\src\divide.c" />
+    <ClCompile Include="..\src\dop.c" />
     <ClCompile Include="..\src\downsample.c" />
     <ClCompile Include="..\src\earwax.c" />
     <ClCompile Include="..\src\echo.c" />
diff --git a/msvc10/LibSoX.vcxproj.filters b/msvc10/LibSoX.vcxproj.filters
index f39449ca..8396624d 100644
--- a/msvc10/LibSoX.vcxproj.filters
+++ b/msvc10/LibSoX.vcxproj.filters
@@ -73,9 +73,6 @@
     <ClInclude Include="..\src\g72x.h">
       <Filter>Headers</Filter>
     </ClInclude>
-    <ClInclude Include="..\src\ignore-warning.h">
-      <Filter>Headers</Filter>
-    </ClInclude>
     <ClInclude Include="..\src\ima_rw.h">
       <Filter>Headers</Filter>
     </ClInclude>
@@ -213,6 +210,9 @@
     <ClCompile Include="..\src\divide.c">
       <Filter>Effect Sources</Filter>
     </ClCompile>
+    <ClCompile Include="..\src\dop.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
     <ClCompile Include="..\src\earwax.c">
       <Filter>Effect Sources</Filter>
     </ClCompile>
@@ -597,5 +597,14 @@
     <ClCompile Include="..\src\downsample.c">
       <Filter>Effect Sources</Filter>
     </ClCompile>
+    <ClCompile Include="..\src\dsdiff.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dsf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sdm.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
   </ItemGroup>
 </Project>
diff --git a/msvc14/.gitignore b/msvc14/.gitignore
new file mode 100644
index 00000000..95181889
--- /dev/null
+++ b/msvc14/.gitignore
@@ -0,0 +1,12 @@
+*.user
+Debug
+ipch
+Makefile
+Makefile.in
+Release
+Sox.ncb
+Sox.opensdf
+Sox.sdf
+SoX.VC.db
+SoX.VC.VC.opendb
+*.suo
diff --git a/msvc14/LibFlac.vcxproj b/msvc14/LibFlac.vcxproj
new file mode 100644
index 00000000..5a63567f
--- /dev/null
+++ b/msvc14/LibFlac.vcxproj
@@ -0,0 +1,134 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}</ProjectGuid>
+    <RootNamespace>LibFlac</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../flac/src/libFLAC/include;../../flac/include;../../libogg/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;FLAC__HAS_OGG;FLAC__CPU_IA32;FLAC__USE_3DNOW;PACKAGE_VERSION="1.3.2";FLAC__NO_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>false</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../flac/src/libFLAC/include;../../flac/include;../../libogg/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;FLAC__HAS_OGG;FLAC__CPU_IA32;FLAC__USE_3DNOW;PACKAGE_VERSION="1.3.2";FLAC__NO_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>false</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\flac\src\libFLAC\bitmath.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\bitreader.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\bitwriter.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\cpu.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\crc.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\fixed.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\float.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\format.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\lpc.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\md5.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\memory.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\metadata_iterators.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\metadata_object.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\ogg_decoder_aspect.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\ogg_encoder_aspect.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\ogg_helper.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\ogg_mapping.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\stream_decoder.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\stream_encoder.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\stream_encoder_framing.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\window.c" />
+    <ClCompile Include="..\..\flac\src\libFLAC\windows_unicode_filenames.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\flac\include\FLAC\all.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\assert.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\callback.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\export.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\format.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\metadata.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\ordinals.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\stream_decoder.h" />
+    <ClInclude Include="..\..\flac\include\FLAC\stream_encoder.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibGsm.vcxproj b/msvc14/LibGsm.vcxproj
new file mode 100644
index 00000000..c4f4a42d
--- /dev/null
+++ b/msvc14/LibGsm.vcxproj
@@ -0,0 +1,122 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{BEE9F57C-384E-4C99-87EB-629BF45C8A89}</ProjectGuid>
+    <RootNamespace>LibGsm</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;LTP_CUT;FAST;USE_FLOAT_MUL;WAV49;SASR;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4101;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;LTP_CUT;FAST;USE_FLOAT_MUL;WAV49;SASR;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4101;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\libgsm\add.c" />
+    <ClCompile Include="..\libgsm\code.c" />
+    <ClCompile Include="..\libgsm\decode.c" />
+    <ClCompile Include="..\libgsm\gsm_create.c" />
+    <ClCompile Include="..\libgsm\gsm_decode.c" />
+    <ClCompile Include="..\libgsm\gsm_destroy.c" />
+    <ClCompile Include="..\libgsm\gsm_encode.c" />
+    <ClCompile Include="..\libgsm\gsm_option.c" />
+    <ClCompile Include="..\libgsm\long_term.c" />
+    <ClCompile Include="..\libgsm\lpc.c" />
+    <ClCompile Include="..\libgsm\preprocess.c" />
+    <ClCompile Include="..\libgsm\rpe.c" />
+    <ClCompile Include="..\libgsm\short_term.c" />
+    <ClCompile Include="..\libgsm\table.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\libgsm\aliases.h" />
+    <ClInclude Include="..\libgsm\gsm.h" />
+    <ClInclude Include="..\libgsm\private.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibId3Tag.vcxproj b/msvc14/LibId3Tag.vcxproj
new file mode 100644
index 00000000..b28dff5c
--- /dev/null
+++ b/msvc14/LibId3Tag.vcxproj
@@ -0,0 +1,140 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{40EA92B6-38AA-4E67-894D-92C37C946402}</ProjectGuid>
+    <RootNamespace>LibId3Tag</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../libid3tag/msvc++;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4013;4018;4146;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../libid3tag/msvc++;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4013;4018;4146;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libid3tag\compat.c" />
+    <ClCompile Include="..\..\libid3tag\crc.c" />
+    <ClCompile Include="..\..\libid3tag\debug.c" />
+    <ClCompile Include="..\..\libid3tag\field.c" />
+    <ClCompile Include="..\..\libid3tag\file.c" />
+    <ClCompile Include="..\..\libid3tag\frame.c" />
+    <ClCompile Include="..\..\libid3tag\frametype.c" />
+    <ClCompile Include="..\..\libid3tag\genre.c" />
+    <ClCompile Include="..\..\libid3tag\latin1.c" />
+    <ClCompile Include="..\..\libid3tag\parse.c" />
+    <ClCompile Include="..\..\libid3tag\render.c" />
+    <ClCompile Include="..\..\libid3tag\tag.c" />
+    <ClCompile Include="..\..\libid3tag\ucs4.c" />
+    <ClCompile Include="..\..\libid3tag\utf16.c" />
+    <ClCompile Include="..\..\libid3tag\utf8.c" />
+    <ClCompile Include="..\..\libid3tag\util.c" />
+    <ClCompile Include="..\..\libid3tag\version.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libid3tag\compat.h" />
+    <ClInclude Include="..\..\libid3tag\crc.h" />
+    <ClInclude Include="..\..\libid3tag\debug.h" />
+    <ClInclude Include="..\..\libid3tag\field.h" />
+    <ClInclude Include="..\..\libid3tag\file.h" />
+    <ClInclude Include="..\..\libid3tag\frame.h" />
+    <ClInclude Include="..\..\libid3tag\frametype.h" />
+    <ClInclude Include="..\..\libid3tag\genre.h" />
+    <ClInclude Include="..\..\libid3tag\global.h" />
+    <ClInclude Include="..\..\libid3tag\id3tag.h" />
+    <ClInclude Include="..\..\libid3tag\latin1.h" />
+    <ClInclude Include="..\..\libid3tag\parse.h" />
+    <ClInclude Include="..\..\libid3tag\render.h" />
+    <ClInclude Include="..\..\libid3tag\tag.h" />
+    <ClInclude Include="..\..\libid3tag\ucs4.h" />
+    <ClInclude Include="..\..\libid3tag\utf16.h" />
+    <ClInclude Include="..\..\libid3tag\utf8.h" />
+    <ClInclude Include="..\..\libid3tag\util.h" />
+    <ClInclude Include="..\..\libid3tag\version.h" />
+    <ClInclude Include="..\..\libid3tag\msvc++\config.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibLpc10.vcxproj b/msvc14/LibLpc10.vcxproj
new file mode 100644
index 00000000..ec65a4a2
--- /dev/null
+++ b/msvc14/LibLpc10.vcxproj
@@ -0,0 +1,143 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}</ProjectGuid>
+    <RootNamespace>LibLpc10</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>SoX;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4146;4244;4723;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>SoX;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4146;4244;4723;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\lpc10\analys.c" />
+    <ClCompile Include="..\lpc10\bsynz.c" />
+    <ClCompile Include="..\lpc10\chanwr.c" />
+    <ClCompile Include="..\lpc10\dcbias.c" />
+    <ClCompile Include="..\lpc10\decode.c" />
+    <ClCompile Include="..\lpc10\deemp.c" />
+    <ClCompile Include="..\lpc10\difmag.c" />
+    <ClCompile Include="..\lpc10\dyptrk.c" />
+    <ClCompile Include="..\lpc10\encode.c" />
+    <ClCompile Include="..\lpc10\energy.c" />
+    <ClCompile Include="..\lpc10\f2clib.c" />
+    <ClCompile Include="..\lpc10\ham84.c" />
+    <ClCompile Include="..\lpc10\hp100.c" />
+    <ClCompile Include="..\lpc10\invert.c" />
+    <ClCompile Include="..\lpc10\irc2pc.c" />
+    <ClCompile Include="..\lpc10\ivfilt.c" />
+    <ClCompile Include="..\lpc10\lpcdec.c" />
+    <ClCompile Include="..\lpc10\lpcenc.c" />
+    <ClCompile Include="..\lpc10\lpcini.c" />
+    <ClCompile Include="..\lpc10\lpfilt.c" />
+    <ClCompile Include="..\lpc10\median.c" />
+    <ClCompile Include="..\lpc10\mload.c" />
+    <ClCompile Include="..\lpc10\onset.c" />
+    <ClCompile Include="..\lpc10\pitsyn.c" />
+    <ClCompile Include="..\lpc10\placea.c" />
+    <ClCompile Include="..\lpc10\placev.c" />
+    <ClCompile Include="..\lpc10\preemp.c" />
+    <ClCompile Include="..\lpc10\prepro.c" />
+    <ClCompile Include="..\lpc10\random.c" />
+    <ClCompile Include="..\lpc10\rcchk.c" />
+    <ClCompile Include="..\lpc10\synths.c" />
+    <ClCompile Include="..\lpc10\tbdm.c" />
+    <ClCompile Include="..\lpc10\voicin.c" />
+    <ClCompile Include="..\lpc10\vparms.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\lpc10\f2c.h" />
+    <ClInclude Include="..\lpc10\lpc10.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibMad.vcxproj b/msvc14/LibMad.vcxproj
new file mode 100644
index 00000000..4e81b6de
--- /dev/null
+++ b/msvc14/LibMad.vcxproj
@@ -0,0 +1,152 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}</ProjectGuid>
+    <RootNamespace>LibMad</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>DynamicLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>DynamicLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <LinkIncremental Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">false</LinkIncremental>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>Mad;../../libmad;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4018;4146;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+    <Link>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).dll</OutputFile>
+      <ModuleDefinitionFile>Mad/LibMad.def</ModuleDefinitionFile>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <SetChecksum>true</SetChecksum>
+      <ImportLibrary>$(OutDir)lib\$(TargetName).lib</ImportLibrary>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>Mad;../../libmad;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4018;4146;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+    <Link>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).dll</OutputFile>
+      <ModuleDefinitionFile>Mad/LibMad.def</ModuleDefinitionFile>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <OptimizeReferences>true</OptimizeReferences>
+      <EnableCOMDATFolding>true</EnableCOMDATFolding>
+      <SetChecksum>true</SetChecksum>
+      <ImportLibrary>$(OutDir)lib\$(TargetName).lib</ImportLibrary>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libmad\bit.c" />
+    <ClCompile Include="..\..\libmad\decoder.c" />
+    <ClCompile Include="..\..\libmad\fixed.c" />
+    <ClCompile Include="..\..\libmad\frame.c" />
+    <ClCompile Include="..\..\libmad\huffman.c" />
+    <ClCompile Include="..\..\libmad\layer12.c" />
+    <ClCompile Include="..\..\libmad\layer3.c" />
+    <ClCompile Include="..\..\libmad\stream.c" />
+    <ClCompile Include="..\..\libmad\synth.c" />
+    <ClCompile Include="..\..\libmad\timer.c" />
+    <ClCompile Include="..\..\libmad\version.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <None Include="Mad\LibMad.def" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libmad\bit.h" />
+    <ClInclude Include="..\..\libmad\decoder.h" />
+    <ClInclude Include="..\..\libmad\fixed.h" />
+    <ClInclude Include="..\..\libmad\frame.h" />
+    <ClInclude Include="..\..\libmad\global.h" />
+    <ClInclude Include="..\..\libmad\huffman.h" />
+    <ClInclude Include="..\..\libmad\layer12.h" />
+    <ClInclude Include="..\..\libmad\layer3.h" />
+    <ClInclude Include="..\..\libmad\mad.h" />
+    <ClInclude Include="..\..\libmad\stream.h" />
+    <ClInclude Include="..\..\libmad\synth.h" />
+    <ClInclude Include="..\..\libmad\timer.h" />
+    <ClInclude Include="..\..\libmad\version.h" />
+    <ClInclude Include="Mad\config.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibMp3Lame.vcxproj b/msvc14/LibMp3Lame.vcxproj
new file mode 100644
index 00000000..a97afc91
--- /dev/null
+++ b/msvc14/LibMp3Lame.vcxproj
@@ -0,0 +1,189 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{4DFD6FD1-96F1-434A-AC69-01783B876354}</ProjectGuid>
+    <RootNamespace>LibMp3Lame</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>DynamicLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>DynamicLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <LinkIncremental Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">false</LinkIncremental>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>Mp3Lame;../../lame;../../lame/include;../../lame/libmp3lame;../../lame/mpglib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+    </ClCompile>
+    <Link>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).dll</OutputFile>
+      <ModuleDefinitionFile>..\..\lame\include\lame.def</ModuleDefinitionFile>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <SetChecksum>true</SetChecksum>
+      <ImportLibrary>$(OutDir)lib\$(TargetName).lib</ImportLibrary>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>Mp3Lame;../../lame;../../lame/include;../../lame/libmp3lame;../../lame/mpglib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_NONSTDC_NO_WARNINGS;_CRT_SECURE_NO_WARNINGS;HAVE_CONFIG_H;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+    </ClCompile>
+    <Link>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).dll</OutputFile>
+      <ModuleDefinitionFile>..\..\lame\include\lame.def</ModuleDefinitionFile>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <OptimizeReferences>true</OptimizeReferences>
+      <EnableCOMDATFolding>true</EnableCOMDATFolding>
+      <SetChecksum>true</SetChecksum>
+      <ImportLibrary>$(OutDir)lib\$(TargetName).lib</ImportLibrary>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\lame\libmp3lame\bitstream.c" />
+    <ClCompile Include="..\..\lame\mpglib\common.c" />
+    <ClCompile Include="..\..\lame\mpglib\dct64_i386.c" />
+    <ClCompile Include="..\..\lame\mpglib\decode_i386.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\encoder.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\fft.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\gain_analysis.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\id3tag.c" />
+    <ClCompile Include="..\..\lame\mpglib\interface.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\lame.c" />
+    <ClCompile Include="..\..\lame\mpglib\layer1.c" />
+    <ClCompile Include="..\..\lame\mpglib\layer2.c" />
+    <ClCompile Include="..\..\lame\mpglib\layer3.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\mpglib_interface.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\newmdct.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\presets.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\psymodel.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\quantize.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\quantize_pvt.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\reservoir.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\set_get.c" />
+    <ClCompile Include="..\..\lame\mpglib\tabinit.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\tables.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\takehiro.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\util.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\vbrquantize.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\VbrTag.c" />
+    <ClCompile Include="..\..\lame\libmp3lame\version.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <None Include="..\..\lame\include\lame.def" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\lame\libmp3lame\bitstream.h" />
+    <ClInclude Include="..\..\lame\mpglib\common.h" />
+    <ClInclude Include="..\..\lame\configMS.h" />
+    <ClInclude Include="..\..\lame\mpglib\dct64_i386.h" />
+    <ClInclude Include="..\..\lame\mpglib\decode_i386.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\encoder.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\fft.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\gain_analysis.h" />
+    <ClInclude Include="..\..\lame\mpglib\huffman.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\id3tag.h" />
+    <ClInclude Include="..\..\lame\mpglib\interface.h" />
+    <ClInclude Include="..\..\lame\mpglib\l2tables.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\l3side.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\lame-analysis.h" />
+    <ClInclude Include="..\..\lame\include\lame.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\lame_global_flags.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\lameerror.h" />
+    <ClInclude Include="..\..\lame\mpglib\layer1.h" />
+    <ClInclude Include="..\..\lame\mpglib\layer2.h" />
+    <ClInclude Include="..\..\lame\mpglib\layer3.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\machine.h" />
+    <ClInclude Include="..\..\lame\mpglib\mpg123.h" />
+    <ClInclude Include="..\..\lame\mpglib\mpglib.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\newmdct.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\psymodel.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\quantize.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\quantize_pvt.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\reservoir.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\set_get.h" />
+    <ClInclude Include="..\..\lame\mpglib\tabinit.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\tables.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\util.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\vbrquantize.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\VbrTag.h" />
+    <ClInclude Include="..\..\lame\libmp3lame\version.h" />
+    <ClInclude Include="Mp3Lame\config.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibOgg.vcxproj b/msvc14/LibOgg.vcxproj
new file mode 100644
index 00000000..60775a52
--- /dev/null
+++ b/msvc14/LibOgg.vcxproj
@@ -0,0 +1,107 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{C5C229AC-316D-42CB-9CA3-329619618972}</ProjectGuid>
+    <RootNamespace>LibOgg</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../libogg/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;LIBOGG_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../libogg/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;LIBOGG_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libogg\src\bitwise.c" />
+    <ClCompile Include="..\..\libogg\src\framing.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libogg\include\ogg\ogg.h" />
+    <ClInclude Include="..\..\libogg\include\ogg\os_types.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibPng.vcxproj b/msvc14/LibPng.vcxproj
new file mode 100644
index 00000000..d8692a19
--- /dev/null
+++ b/msvc14/LibPng.vcxproj
@@ -0,0 +1,124 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{46E7AC9D-3E96-4B34-B493-501BC277D6F9}</ProjectGuid>
+    <RootNamespace>LibPng</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>Png;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>Png;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libpng\png.c" />
+    <ClCompile Include="..\..\libpng\pngerror.c" />
+    <ClCompile Include="..\..\libpng\pngget.c" />
+    <ClCompile Include="..\..\libpng\pngmem.c" />
+    <ClCompile Include="..\..\libpng\pngpread.c" />
+    <ClCompile Include="..\..\libpng\pngread.c" />
+    <ClCompile Include="..\..\libpng\pngrio.c" />
+    <ClCompile Include="..\..\libpng\pngrtran.c" />
+    <ClCompile Include="..\..\libpng\pngrutil.c" />
+    <ClCompile Include="..\..\libpng\pngset.c" />
+    <ClCompile Include="..\..\libpng\pngtrans.c" />
+    <ClCompile Include="..\..\libpng\pngwio.c" />
+    <ClCompile Include="..\..\libpng\pngwrite.c" />
+    <ClCompile Include="..\..\libpng\pngwtran.c" />
+    <ClCompile Include="..\..\libpng\pngwutil.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libpng\png.h" />
+    <ClInclude Include="..\..\libpng\pngconf.h" />
+    <ClInclude Include="Png\inttypes.h" />
+    <ClInclude Include="Png\pnglibconf.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSndFile.vcxproj b/msvc14/LibSndFile.vcxproj
new file mode 100644
index 00000000..c4233a52
--- /dev/null
+++ b/msvc14/LibSndFile.vcxproj
@@ -0,0 +1,191 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{342BDA83-C83F-4168-8425-E1DF72F47018}</ProjectGuid>
+    <RootNamespace>LibSndFile</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>SndFile;..\..\libsndfile\src;../../flac/include;../../libogg/include;../../libvorbis/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;LIBSNDFILE_EXPORTS;inline=__inline;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>false</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>SndFile;..\..\libsndfile\src;../../flac/include;../../libogg/include;../../libvorbis/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;LIBSNDFILE_EXPORTS;inline=__inline;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>false</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libsndfile\src\aiff.c" />
+    <ClCompile Include="..\..\libsndfile\src\alaw.c" />
+    <ClCompile Include="..\..\libsndfile\src\au.c" />
+    <ClCompile Include="..\..\libsndfile\src\audio_detect.c" />
+    <ClCompile Include="..\..\libsndfile\src\avr.c" />
+    <ClCompile Include="..\..\libsndfile\src\broadcast.c" />
+    <ClCompile Include="..\..\libsndfile\src\caf.c" />
+    <ClCompile Include="..\..\libsndfile\src\chanmap.c" />
+    <ClCompile Include="..\..\libsndfile\src\chunk.c" />
+    <ClCompile Include="..\..\libsndfile\src\command.c" />
+    <ClCompile Include="..\..\libsndfile\src\common.c" />
+    <ClCompile Include="..\..\libsndfile\src\dither.c" />
+    <ClCompile Include="..\..\libsndfile\src\double64.c" />
+    <ClCompile Include="..\..\libsndfile\src\dwd.c" />
+    <ClCompile Include="..\..\libsndfile\src\dwvw.c" />
+    <ClCompile Include="..\..\libsndfile\src\file_io.c" />
+    <ClCompile Include="..\..\libsndfile\src\flac.c" />
+    <ClCompile Include="..\..\libsndfile\src\float32.c" />
+    <ClCompile Include="..\..\libsndfile\src\g72x.c" />
+    <ClCompile Include="..\..\libsndfile\src\gsm610.c" />
+    <ClCompile Include="..\..\libsndfile\src\htk.c" />
+    <ClCompile Include="..\..\libsndfile\src\id3.c" />
+    <ClCompile Include="..\..\libsndfile\src\ima_adpcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\ima_oki_adpcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\interleave.c" />
+    <ClCompile Include="..\..\libsndfile\src\ircam.c" />
+    <ClCompile Include="..\..\libsndfile\src\macos.c" />
+    <ClCompile Include="..\..\libsndfile\src\mat4.c" />
+    <ClCompile Include="..\..\libsndfile\src\mat5.c" />
+    <ClCompile Include="..\..\libsndfile\src\mpc2k.c" />
+    <ClCompile Include="..\..\libsndfile\src\ms_adpcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\nist.c" />
+    <ClCompile Include="..\..\libsndfile\src\ogg.c" />
+    <ClCompile Include="..\..\libsndfile\src\ogg_pcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\ogg_speex.c" />
+    <ClCompile Include="..\..\libsndfile\src\ogg_vorbis.c" />
+    <ClCompile Include="..\..\libsndfile\src\paf.c" />
+    <ClCompile Include="..\..\libsndfile\src\pcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\pvf.c" />
+    <ClCompile Include="..\..\libsndfile\src\raw.c" />
+    <ClCompile Include="..\..\libsndfile\src\rf64.c" />
+    <ClCompile Include="..\..\libsndfile\src\rx2.c" />
+    <ClCompile Include="..\..\libsndfile\src\sd2.c" />
+    <ClCompile Include="..\..\libsndfile\src\sds.c" />
+    <ClCompile Include="..\..\libsndfile\src\sndfile.c" />
+    <ClCompile Include="..\..\libsndfile\src\strings.c" />
+    <ClCompile Include="..\..\libsndfile\src\svx.c" />
+    <ClCompile Include="..\..\libsndfile\src\txw.c" />
+    <ClCompile Include="..\..\libsndfile\src\ulaw.c" />
+    <ClCompile Include="..\..\libsndfile\src\voc.c" />
+    <ClCompile Include="..\..\libsndfile\src\vox_adpcm.c" />
+    <ClCompile Include="..\..\libsndfile\src\w64.c" />
+    <ClCompile Include="..\..\libsndfile\src\wav.c" />
+    <ClCompile Include="..\..\libsndfile\src\wav_w64.c" />
+    <ClCompile Include="..\..\libsndfile\src\windows.c" />
+    <ClCompile Include="..\..\libsndfile\src\wve.c" />
+    <ClCompile Include="..\..\libsndfile\src\xi.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libsndfile\src\common.h" />
+    <ClInclude Include="..\..\libsndfile\src\GSM610\config.h" />
+    <ClInclude Include="..\..\libsndfile\src\G72x\g72x.h" />
+    <ClInclude Include="..\..\libsndfile\src\G72x\g72x_priv.h" />
+    <ClInclude Include="..\..\libsndfile\src\GSM610\gsm.h" />
+    <ClInclude Include="..\..\libsndfile\src\GSM610\gsm610_priv.h" />
+    <ClInclude Include="..\..\libsndfile\src\ima_oki_adpcm.h" />
+    <ClInclude Include="..\..\libsndfile\src\sf_unistd.h" />
+    <ClInclude Include="..\..\libsndfile\src\sfconfig.h" />
+    <ClInclude Include="..\..\libsndfile\src\sfendian.h" />
+    <ClInclude Include="..\..\libsndfile\src\test_main.h" />
+    <ClInclude Include="..\..\libsndfile\src\wav_w64.h" />
+    <ClInclude Include="SndFile\config.h" />
+    <ClInclude Include="SndFile\sndfile.h" />
+  </ItemGroup>
+  <ItemGroup>
+    <ProjectReference Include="LibFlac.vcxproj">
+      <Project>{38203d05-af71-4ff2-a183-a7d9cb8d2ae0}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibOgg.vcxproj">
+      <Project>{c5c229ac-316d-42cb-9ca3-329619618972}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSndFileG72x.vcxproj">
+      <Project>{7016d4c2-a0ab-4bfd-9aa1-4ecdccbe6301}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSndFileGSM610.vcxproj">
+      <Project>{d2572de1-610e-46a4-8dd2-8a693347d76a}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibVorbis.vcxproj">
+      <Project>{524a24cd-0973-4733-8eb9-f419dc6f9997}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSndFileG72x.vcxproj b/msvc14/LibSndFileG72x.vcxproj
new file mode 100644
index 00000000..73f8d60d
--- /dev/null
+++ b/msvc14/LibSndFileG72x.vcxproj
@@ -0,0 +1,108 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}</ProjectGuid>
+    <RootNamespace>G72x</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libsndfile\src\G72x\g721.c" />
+    <ClCompile Include="..\..\libsndfile\src\G72x\g723_16.c" />
+    <ClCompile Include="..\..\libsndfile\src\G72x\g723_24.c" />
+    <ClCompile Include="..\..\libsndfile\src\G72x\g723_40.c" />
+    <ClCompile Include="..\..\libsndfile\src\G72x\g72x.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libsndfile\src\G72x\g72x.h" />
+    <ClInclude Include="..\..\libsndfile\src\G72x\g72x_priv.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSndFileGSM610.vcxproj b/msvc14/LibSndFileGSM610.vcxproj
new file mode 100644
index 00000000..610ca844
--- /dev/null
+++ b/msvc14/LibSndFileGSM610.vcxproj
@@ -0,0 +1,118 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{D2572DE1-610E-46A4-8DD2-8A693347D76A}</ProjectGuid>
+    <RootNamespace>GSM610</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;inline=__inline;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;inline=__inline;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libsndfile\src\GSM610\add.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\code.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\decode.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\gsm_create.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\gsm_decode.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\gsm_destroy.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\gsm_encode.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\gsm_option.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\long_term.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\lpc.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\preprocess.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\rpe.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\short_term.c" />
+    <ClCompile Include="..\..\libsndfile\src\GSM610\table.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libsndfile\src\GSM610\config.h" />
+    <ClInclude Include="..\..\libsndfile\src\GSM610\gsm.h" />
+    <ClInclude Include="..\..\libsndfile\src\GSM610\gsm610_priv.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSoX.vcxproj b/msvc14/LibSoX.vcxproj
new file mode 100644
index 00000000..33285984
--- /dev/null
+++ b/msvc14/LibSoX.vcxproj
@@ -0,0 +1,348 @@
+<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{F17BE535-C7E8-4930-A6FD-32498D73A533}</ProjectGuid>
+    <RootNamespace>LibSoX</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>SoX;Png;../../flac/include;../../lame/include;../../lame;../../libid3tag;../../libmad;../../libpng;../../libogg/include;sndfile;../../speex/include;../../speexdsp/include;../../libvorbis/include;../../wavpack/include;../../wavpack;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_LIB;_CRT_SECURE_NO_WARNINGS;_DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level4</WarningLevel>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4100;4125;4127;4295;4244;4706</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>SoX;Png;../../flac/include;../../lame/include;../../lame;../../libid3tag;../../libmad;../../libpng;../../libogg/include;sndfile;../../speex/include;../../speexdsp/include;../../libvorbis/include;../../wavpack/include;../../wavpack;../../zlib;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_LIB;_CRT_SECURE_NO_WARNINGS;NDEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level4</WarningLevel>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4100;4125;4127;4295;4244;4706</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClInclude Include="..\src\adpcm.h" />
+    <ClInclude Include="..\src\adpcms.h" />
+    <ClInclude Include="..\src\aiff.h" />
+    <ClInclude Include="..\src\amr.h" />
+    <ClInclude Include="..\src\band.h" />
+    <ClInclude Include="..\src\biquad.h" />
+    <ClInclude Include="..\src\compandt.h" />
+    <ClInclude Include="..\src\cvsd.h" />
+    <ClInclude Include="..\src\cvsdfilt.h" />
+    <ClInclude Include="..\src\dft_filter.h" />
+    <ClInclude Include="..\src\dither.h" />
+    <ClInclude Include="..\src\effects.h" />
+    <ClInclude Include="..\src\fft4g.h" />
+    <ClInclude Include="..\src\fifo.h" />
+    <ClInclude Include="..\src\formats.h" />
+    <ClInclude Include="..\src\g711.h" />
+    <ClInclude Include="..\src\g72x.h" />
+    <ClInclude Include="..\src\ima_rw.h" />
+    <ClInclude Include="..\src\mcompand_xover.h" />
+    <ClInclude Include="..\src\mp3-util.h" />
+    <ClInclude Include="..\src\noisered.h" />
+    <ClInclude Include="..\src\rate_filters.h" />
+    <ClInclude Include="..\src\rate_half_fir.h" />
+    <ClInclude Include="..\src\rate_poly_fir.h" />
+    <ClInclude Include="..\src\rate_poly_fir0.h" />
+    <ClInclude Include="..\src\raw.h" />
+    <ClInclude Include="..\src\sox.h" />
+    <ClInclude Include="..\src\sox_i.h" />
+    <ClInclude Include="..\src\sox_sample_test.h" />
+    <ClInclude Include="..\src\soxomp.h" />
+    <ClInclude Include="..\src\util.h" />
+    <ClInclude Include="..\src\vox.h" />
+    <ClInclude Include="..\src\win32-ltdl.h" />
+    <ClInclude Include="..\src\xmalloc.h" />
+    <ClInclude Include="SoX\soxconfig.h" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClCompile Include="..\src\alsa.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\ao.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\coreaudio.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\dsdiff.c" />
+    <ClCompile Include="..\src\dsf.c" />
+    <ClCompile Include="..\src\example0.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\example1.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\example2.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\example3.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\example4.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\id3.c" />
+    <ClCompile Include="..\src\oss.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\pulseaudio.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\sdm.c" />
+    <ClCompile Include="..\src\skeleff.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\skelform.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\sndio.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\sox_sample_test.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\sunaudio.c">
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">true</ExcludedFromBuild>
+      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">true</ExcludedFromBuild>
+    </ClCompile>
+    <ClCompile Include="..\src\bend.c" />
+    <ClCompile Include="..\src\biquad.c" />
+    <ClCompile Include="..\src\biquads.c" />
+    <ClCompile Include="..\src\chorus.c" />
+    <ClCompile Include="..\src\compand.c" />
+    <ClCompile Include="..\src\compandt.c" />
+    <ClCompile Include="..\src\contrast.c" />
+    <ClCompile Include="..\src\dcshift.c" />
+    <ClCompile Include="..\src\delay.c" />
+    <ClCompile Include="..\src\dft_filter.c" />
+    <ClCompile Include="..\src\dither.c" />
+    <ClCompile Include="..\src\divide.c" />
+    <ClCompile Include="..\src\dop.c" />
+    <ClCompile Include="..\src\downsample.c" />
+    <ClCompile Include="..\src\earwax.c" />
+    <ClCompile Include="..\src\echo.c" />
+    <ClCompile Include="..\src\echos.c" />
+    <ClCompile Include="..\src\fade.c" />
+    <ClCompile Include="..\src\fir.c" />
+    <ClCompile Include="..\src\firfit.c" />
+    <ClCompile Include="..\src\flanger.c" />
+    <ClCompile Include="..\src\gain.c" />
+    <ClCompile Include="..\src\hilbert.c" />
+    <ClCompile Include="..\src\input.c" />
+    <ClCompile Include="..\src\ladspa.c" />
+    <ClCompile Include="..\src\loudness.c" />
+    <ClCompile Include="..\src\mcompand.c" />
+    <ClCompile Include="..\src\noiseprof.c" />
+    <ClCompile Include="..\src\noisered.c" />
+    <ClCompile Include="..\src\output.c" />
+    <ClCompile Include="..\src\overdrive.c" />
+    <ClCompile Include="..\src\pad.c" />
+    <ClCompile Include="..\src\phaser.c" />
+    <ClCompile Include="..\src\rate.c" />
+    <ClCompile Include="..\src\remix.c" />
+    <ClCompile Include="..\src\repeat.c" />
+    <ClCompile Include="..\src\reverb.c" />
+    <ClCompile Include="..\src\reverse.c" />
+    <ClCompile Include="..\src\silence.c" />
+    <ClCompile Include="..\src\sinc.c" />
+    <ClCompile Include="..\src\spectrogram.c" />
+    <ClCompile Include="..\src\speed.c" />
+    <ClCompile Include="..\src\speexdsp.c" />
+    <ClCompile Include="..\src\splice.c" />
+    <ClCompile Include="..\src\stat.c" />
+    <ClCompile Include="..\src\stats.c" />
+    <ClCompile Include="..\src\stretch.c" />
+    <ClCompile Include="..\src\swap.c" />
+    <ClCompile Include="..\src\synth.c" />
+    <ClCompile Include="..\src\tempo.c" />
+    <ClCompile Include="..\src\tremolo.c" />
+    <ClCompile Include="..\src\trim.c" />
+    <ClCompile Include="..\src\upsample.c" />
+    <ClCompile Include="..\src\vad.c" />
+    <ClCompile Include="..\src\vol.c" />
+    <ClCompile Include="..\src\8svx.c" />
+    <ClCompile Include="..\src\aifc-fmt.c" />
+    <ClCompile Include="..\src\aiff-fmt.c" />
+    <ClCompile Include="..\src\al-fmt.c" />
+    <ClCompile Include="..\src\amr-nb.c" />
+    <ClCompile Include="..\src\amr-wb.c" />
+    <ClCompile Include="..\src\au.c" />
+    <ClCompile Include="..\src\avr.c" />
+    <ClCompile Include="..\src\caf.c" />
+    <ClCompile Include="..\src\cdr.c" />
+    <ClCompile Include="..\src\cvsd-fmt.c" />
+    <ClCompile Include="..\src\dat.c" />
+    <ClCompile Include="..\src\dvms-fmt.c" />
+    <ClCompile Include="..\src\f4-fmt.c" />
+    <ClCompile Include="..\src\f8-fmt.c" />
+    <ClCompile Include="..\src\fap.c" />
+    <ClCompile Include="..\src\flac.c" />
+    <ClCompile Include="..\src\gsm.c" />
+    <ClCompile Include="..\src\gsrt.c" />
+    <ClCompile Include="..\src\hcom.c" />
+    <ClCompile Include="..\src\htk.c" />
+    <ClCompile Include="..\src\ima-fmt.c" />
+    <ClCompile Include="..\src\ima_rw.c" />
+    <ClCompile Include="..\src\la-fmt.c" />
+    <ClCompile Include="..\src\lpc10.c" />
+    <ClCompile Include="..\src\lu-fmt.c" />
+    <ClCompile Include="..\src\mat4.c" />
+    <ClCompile Include="..\src\mat5.c" />
+    <ClCompile Include="..\src\maud.c" />
+    <ClCompile Include="..\src\mp3.c" />
+    <ClCompile Include="..\src\nulfile.c" />
+    <ClCompile Include="..\src\paf.c" />
+    <ClCompile Include="..\src\prc.c" />
+    <ClCompile Include="..\src\pvf.c" />
+    <ClCompile Include="..\src\raw-fmt.c" />
+    <ClCompile Include="..\src\s1-fmt.c" />
+    <ClCompile Include="..\src\s2-fmt.c" />
+    <ClCompile Include="..\src\s3-fmt.c" />
+    <ClCompile Include="..\src\s4-fmt.c" />
+    <ClCompile Include="..\src\sd2.c" />
+    <ClCompile Include="..\src\sf.c" />
+    <ClCompile Include="..\src\smp.c" />
+    <ClCompile Include="..\src\sndfile.c" />
+    <ClCompile Include="..\src\sounder.c" />
+    <ClCompile Include="..\src\soundtool.c" />
+    <ClCompile Include="..\src\sox-fmt.c" />
+    <ClCompile Include="..\src\sphere.c" />
+    <ClCompile Include="..\src\tx16w.c" />
+    <ClCompile Include="..\src\u1-fmt.c" />
+    <ClCompile Include="..\src\u2-fmt.c" />
+    <ClCompile Include="..\src\u3-fmt.c" />
+    <ClCompile Include="..\src\u4-fmt.c" />
+    <ClCompile Include="..\src\ul-fmt.c" />
+    <ClCompile Include="..\src\voc.c" />
+    <ClCompile Include="..\src\vorbis.c" />
+    <ClCompile Include="..\src\vox-fmt.c" />
+    <ClCompile Include="..\src\vox.c" />
+    <ClCompile Include="..\src\w64.c" />
+    <ClCompile Include="..\src\wav.c" />
+    <ClCompile Include="..\src\waveaudio.c" />
+    <ClCompile Include="..\src\wavpack.c">
+      <DisableSpecificWarnings Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">4142;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+      <DisableSpecificWarnings Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">4142;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+    <ClCompile Include="..\src\wve.c" />
+    <ClCompile Include="..\src\xa.c" />
+    <ClCompile Include="..\src\xi.c" />
+    <ClCompile Include="..\src\adpcm.c" />
+    <ClCompile Include="..\src\adpcms.c" />
+    <ClCompile Include="..\src\aiff.c" />
+    <ClCompile Include="..\src\cvsd.c" />
+    <ClCompile Include="..\src\effects.c" />
+    <ClCompile Include="..\src\effects_i.c" />
+    <ClCompile Include="..\src\effects_i_dsp.c" />
+    <ClCompile Include="..\src\fft4g.c" />
+    <ClCompile Include="..\src\formats.c" />
+    <ClCompile Include="..\src\formats_i.c" />
+    <ClCompile Include="..\src\g711.c" />
+    <ClCompile Include="..\src\g721.c" />
+    <ClCompile Include="..\src\g723_24.c" />
+    <ClCompile Include="..\src\g723_40.c" />
+    <ClCompile Include="..\src\g72x.c" />
+    <ClCompile Include="..\src\getopt.c" />
+    <ClCompile Include="..\src\libsox.c" />
+    <ClCompile Include="..\src\libsox_i.c" />
+    <ClCompile Include="..\src\raw.c" />
+    <ClCompile Include="..\src\util.c" />
+    <ClCompile Include="..\src\win32-ltdl.c" />
+    <ClCompile Include="..\src\xmalloc.c" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSoX.vcxproj.filters b/msvc14/LibSoX.vcxproj.filters
new file mode 100644
index 00000000..cf58a84b
--- /dev/null
+++ b/msvc14/LibSoX.vcxproj.filters
@@ -0,0 +1,613 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup>
+    <Filter Include="Headers">
+      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
+      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
+    </Filter>
+    <Filter Include="Config Headers">
+      <UniqueIdentifier>{28638e5e-b540-47d4-bee5-296f96ea65d7}</UniqueIdentifier>
+    </Filter>
+    <Filter Include="Excluded Sources">
+      <UniqueIdentifier>{88d3ba5f-c07b-47a6-8d31-2ca7a9890e6d}</UniqueIdentifier>
+    </Filter>
+    <Filter Include="Effect Sources">
+      <UniqueIdentifier>{2fe3c03a-d755-4882-afbf-c1eb806117c0}</UniqueIdentifier>
+    </Filter>
+    <Filter Include="Format Sources">
+      <UniqueIdentifier>{6ad57da4-219f-4dd0-8c47-883521cd0af6}</UniqueIdentifier>
+    </Filter>
+    <Filter Include="Shared Sources">
+      <UniqueIdentifier>{027d9299-ae71-4cad-8b6c-01d28b65d3d3}</UniqueIdentifier>
+    </Filter>
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\src\adpcm.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\adpcms.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\aiff.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\amr.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\band.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\biquad.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\compandt.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\cvsd.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\cvsdfilt.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\dft_filter.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\dither.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\effects.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\fft4g.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\fifo.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\formats.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\g711.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\g72x.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\ima_rw.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\mcompand_xover.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\mp3-util.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\noisered.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\rate_filters.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\rate_half_fir.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\rate_poly_fir.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\rate_poly_fir0.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\raw.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\sox.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\sox_i.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\sox_sample_test.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\soxomp.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\util.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\vox.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\win32-ltdl.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="..\src\xmalloc.h">
+      <Filter>Headers</Filter>
+    </ClInclude>
+    <ClInclude Include="SoX\soxconfig.h">
+      <Filter>Config Headers</Filter>
+    </ClInclude>
+  </ItemGroup>
+  <ItemGroup>
+    <ClCompile Include="..\src\alsa.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\ao.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\coreaudio.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\example0.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\example1.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\example2.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\example3.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\example4.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\oss.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\pulseaudio.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\skeleff.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\skelform.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sndio.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sox_sample_test.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sunaudio.c">
+      <Filter>Excluded Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\bend.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\biquad.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\biquads.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\chorus.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\compand.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\compandt.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\contrast.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dcshift.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\delay.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dft_filter.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dither.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\divide.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dop.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\earwax.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\echo.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\echos.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\fade.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\fir.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\firfit.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\flanger.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\gain.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\input.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\ladspa.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\loudness.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\mcompand.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\noiseprof.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\noisered.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\output.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\overdrive.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\pad.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\phaser.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\rate.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\remix.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\repeat.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\reverb.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\reverse.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\silence.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sinc.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\spectrogram.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\speed.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\speexdsp.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\splice.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\stat.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\stats.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\stretch.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\swap.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\synth.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\tempo.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\tremolo.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\trim.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\vad.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\vol.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\8svx.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\aifc-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\aiff-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\al-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\amr-nb.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\amr-wb.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\au.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\avr.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\caf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\cdr.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\cvsd-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dat.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dvms-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\f4-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\f8-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\fap.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\flac.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\gsm.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\gsrt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\hcom.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\htk.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\ima-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\ima_rw.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\la-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\lpc10.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\lu-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\mat4.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\mat5.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\maud.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\mp3.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\nulfile.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\paf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\prc.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\pvf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\raw-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\s1-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\s2-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\s3-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\s4-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sd2.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\smp.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sndfile.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sounder.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\soundtool.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sox-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sphere.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\tx16w.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\u1-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\u2-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\u3-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\u4-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\ul-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\voc.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\vorbis.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\vox-fmt.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\vox.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\w64.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\wav.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\waveaudio.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\wavpack.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\wve.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\xa.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\xi.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\adpcm.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\adpcms.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\aiff.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\cvsd.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\effects.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\effects_i.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\effects_i_dsp.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\fft4g.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\formats.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\formats_i.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\g711.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\g721.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\g723_24.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\g723_40.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\g72x.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\getopt.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\libsox.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\libsox_i.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\raw.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\util.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\win32-ltdl.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\xmalloc.c">
+      <Filter>Shared Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\hilbert.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\upsample.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\downsample.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dsdiff.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\dsf.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\sdm.c">
+      <Filter>Effect Sources</Filter>
+    </ClCompile>
+    <ClCompile Include="..\src\id3.c">
+      <Filter>Format Sources</Filter>
+    </ClCompile>
+  </ItemGroup>
+</Project>
\ No newline at end of file
diff --git a/msvc14/LibSpeex.vcxproj b/msvc14/LibSpeex.vcxproj
new file mode 100644
index 00000000..2691c3ca
--- /dev/null
+++ b/msvc14/LibSpeex.vcxproj
@@ -0,0 +1,164 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{60902B83-8B26-4DBD-B635-4CECF5F4744C}</ProjectGuid>
+    <RootNamespace>LibSpeex</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../speex/include;../../speex/win32;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;HAVE_CONFIG_H;M_PI=3.14159265358979323846;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4018;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../speex/include;../../speex/win32;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;HAVE_CONFIG_H;M_PI=3.14159265358979323846;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4018;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\speex\libspeex\bits.c" />
+    <ClCompile Include="..\..\speex\libspeex\cb_search.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_10_16_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_10_32_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_20_32_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_5_256_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_5_64_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\exc_8_128_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\fftwrap.c" />
+    <ClCompile Include="..\..\speex\libspeex\filters.c" />
+    <ClCompile Include="..\..\speex\libspeex\gain_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\gain_table_lbr.c" />
+    <ClCompile Include="..\..\speex\libspeex\hexc_10_32_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\hexc_table.c" />
+    <ClCompile Include="..\..\speex\libspeex\high_lsp_tables.c" />
+    <ClCompile Include="..\..\speex\libspeex\kiss_fft.c" />
+    <ClCompile Include="..\..\speex\libspeex\kiss_fftr.c" />
+    <ClCompile Include="..\..\speex\libspeex\lpc.c" />
+    <ClCompile Include="..\..\speex\libspeex\lsp.c" />
+    <ClCompile Include="..\..\speex\libspeex\lsp_tables_nb.c" />
+    <ClCompile Include="..\..\speex\libspeex\ltp.c" />
+    <ClCompile Include="..\..\speex\libspeex\modes.c" />
+    <ClCompile Include="..\..\speex\libspeex\modes_wb.c" />
+    <ClCompile Include="..\..\speex\libspeex\nb_celp.c" />
+    <ClCompile Include="..\..\speex\libspeex\quant_lsp.c" />
+    <ClCompile Include="..\..\speex\libspeex\sb_celp.c" />
+    <ClCompile Include="..\..\speex\libspeex\smallft.c" />
+    <ClCompile Include="..\..\speex\libspeex\speex.c" />
+    <ClCompile Include="..\..\speex\libspeex\speex_callbacks.c" />
+    <ClCompile Include="..\..\speex\libspeex\speex_header.c" />
+    <ClCompile Include="..\..\speex\libspeex\stereo.c" />
+    <ClCompile Include="..\..\speex\libspeex\vbr.c" />
+    <ClCompile Include="..\..\speex\libspeex\vq.c" />
+    <ClCompile Include="..\..\speex\libspeex\window.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\speex\libspeex\cb_search.h" />
+    <ClInclude Include="..\..\speex\libspeex\cb_search_sse.h" />
+    <ClInclude Include="..\..\speex\win32\config.h" />
+    <ClInclude Include="..\..\speex\libspeex\fftwrap.h" />
+    <ClInclude Include="..\..\speex\libspeex\filters.h" />
+    <ClInclude Include="..\..\speex\libspeex\filters_sse.h" />
+    <ClInclude Include="..\..\speex\libspeex\fixed_bfin.h" />
+    <ClInclude Include="..\..\speex\libspeex\fixed_debug.h" />
+    <ClInclude Include="..\..\speex\libspeex\fixed_generic.h" />
+    <ClInclude Include="..\..\speex\libspeex\kiss_fft.h" />
+    <ClInclude Include="..\..\speex\libspeex\kiss_fftr.h" />
+    <ClInclude Include="..\..\speex\libspeex\lpc.h" />
+    <ClInclude Include="..\..\speex\libspeex\lsp.h" />
+    <ClInclude Include="..\..\speex\libspeex\ltp.h" />
+    <ClInclude Include="..\..\speex\libspeex\ltp_sse.h" />
+    <ClInclude Include="..\..\speex\libspeex\math_approx.h" />
+    <ClInclude Include="..\..\speex\libspeex\modes.h" />
+    <ClInclude Include="..\..\speex\libspeex\nb_celp.h" />
+    <ClInclude Include="..\..\speex\libspeex\os_support.h" />
+    <ClInclude Include="..\..\speex\libspeex\quant_lsp.h" />
+    <ClInclude Include="..\..\speex\libspeex\sb_celp.h" />
+    <ClInclude Include="..\..\speex\libspeex\smallft.h" />
+    <ClInclude Include="..\..\speex\libspeex\stack_alloc.h" />
+    <ClInclude Include="..\..\speex\libspeex\vbr.h" />
+    <ClInclude Include="..\..\speex\libspeex\vorbis_psy.h" />
+    <ClInclude Include="..\..\speex\libspeex\vq.h" />
+    <ClInclude Include="..\..\speex\libspeex\vq_sse.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibSpeexDsp.vcxproj b/msvc14/LibSpeexDsp.vcxproj
new file mode 100644
index 00000000..6933b989
--- /dev/null
+++ b/msvc14/LibSpeexDsp.vcxproj
@@ -0,0 +1,109 @@
+<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <RootNamespace>LibSpeexDsp</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+    <ProjectGuid>{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}</ProjectGuid>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../speexdsp/include;../../speexdsp/win32;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;HAVE_CONFIG_H;M_PI=3.14159265358979323846;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4018;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../speexdsp/include;../../speexdsp/win32;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;HAVE_CONFIG_H;M_PI=3.14159265358979323846;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4018;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\speexdsp\libspeexdsp\filterbank.c" />
+    <ClCompile Include="..\..\speexdsp\libspeexdsp\jitter.c" />
+    <ClCompile Include="..\..\speexdsp\libspeexdsp\mdf.c" />
+    <ClCompile Include="..\..\speexdsp\libspeexdsp\preprocess.c" />
+    <ClCompile Include="..\..\speexdsp\libspeexdsp\scal.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\speexdsp\win32\config.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibVorbis.vcxproj b/msvc14/LibVorbis.vcxproj
new file mode 100644
index 00000000..deca6a89
--- /dev/null
+++ b/msvc14/LibVorbis.vcxproj
@@ -0,0 +1,144 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{524A24CD-0973-4733-8EB9-F419DC6F9997}</ProjectGuid>
+    <RootNamespace>LibVorbis</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../../libogg/include;../../libvorbis/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;LIBVORBIS_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4554;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../../libogg/include;../../libvorbis/include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;LIBVORBIS_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <DisableSpecificWarnings>4554;4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\libvorbis\lib\analysis.c" />
+    <ClCompile Include="..\..\libvorbis\lib\bitrate.c" />
+    <ClCompile Include="..\..\libvorbis\lib\block.c" />
+    <ClCompile Include="..\..\libvorbis\lib\codebook.c" />
+    <ClCompile Include="..\..\libvorbis\lib\envelope.c" />
+    <ClCompile Include="..\..\libvorbis\lib\floor0.c" />
+    <ClCompile Include="..\..\libvorbis\lib\floor1.c" />
+    <ClCompile Include="..\..\libvorbis\lib\info.c" />
+    <ClCompile Include="..\..\libvorbis\lib\lookup.c" />
+    <ClCompile Include="..\..\libvorbis\lib\lpc.c" />
+    <ClCompile Include="..\..\libvorbis\lib\lsp.c" />
+    <ClCompile Include="..\..\libvorbis\lib\mapping0.c" />
+    <ClCompile Include="..\..\libvorbis\lib\mdct.c" />
+    <ClCompile Include="..\..\libvorbis\lib\psy.c" />
+    <ClCompile Include="..\..\libvorbis\lib\registry.c" />
+    <ClCompile Include="..\..\libvorbis\lib\res0.c" />
+    <ClCompile Include="..\..\libvorbis\lib\sharedbook.c" />
+    <ClCompile Include="..\..\libvorbis\lib\smallft.c" />
+    <ClCompile Include="..\..\libvorbis\lib\synthesis.c" />
+    <ClCompile Include="..\..\libvorbis\lib\vorbisenc.c" />
+    <ClCompile Include="..\..\libvorbis\lib\vorbisfile.c" />
+    <ClCompile Include="..\..\libvorbis\lib\window.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\libvorbis\lib\backends.h" />
+    <ClInclude Include="..\..\libvorbis\lib\bitrate.h" />
+    <ClInclude Include="..\..\libvorbis\lib\codebook.h" />
+    <ClInclude Include="..\..\libvorbis\lib\codec_internal.h" />
+    <ClInclude Include="..\..\libvorbis\lib\envelope.h" />
+    <ClInclude Include="..\..\libvorbis\lib\highlevel.h" />
+    <ClInclude Include="..\..\libvorbis\lib\lookup.h" />
+    <ClInclude Include="..\..\libvorbis\lib\lookup_data.h" />
+    <ClInclude Include="..\..\libvorbis\lib\lpc.h" />
+    <ClInclude Include="..\..\libvorbis\lib\lsp.h" />
+    <ClInclude Include="..\..\libvorbis\lib\masking.h" />
+    <ClInclude Include="..\..\libvorbis\lib\mdct.h" />
+    <ClInclude Include="..\..\libvorbis\lib\misc.h" />
+    <ClInclude Include="..\..\libvorbis\lib\os.h" />
+    <ClInclude Include="..\..\libvorbis\lib\psy.h" />
+    <ClInclude Include="..\..\libvorbis\lib\registry.h" />
+    <ClInclude Include="..\..\libvorbis\lib\scales.h" />
+    <ClInclude Include="..\..\libvorbis\lib\smallft.h" />
+    <ClInclude Include="..\..\libvorbis\lib\window.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibWavPack.vcxproj b/msvc14/LibWavPack.vcxproj
new file mode 100644
index 00000000..221225cc
--- /dev/null
+++ b/msvc14/LibWavPack.vcxproj
@@ -0,0 +1,129 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{7461CC57-B1CB-4766-B357-F51587449474}</ProjectGuid>
+    <RootNamespace>LibWavPack</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>../include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;OPT_MMX;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>../include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;OPT_MMX;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\wavpack\src\common_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\decorr_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\entropy_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\extra1.c" />
+    <ClCompile Include="..\..\wavpack\src\extra2.c" />
+    <ClCompile Include="..\..\wavpack\src\open_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\open_legacy.c" />
+    <ClCompile Include="..\..\wavpack\src\pack.c" />
+    <ClCompile Include="..\..\wavpack\src\pack_dns.c" />
+    <ClCompile Include="..\..\wavpack\src\pack_floats.c" />
+    <ClCompile Include="..\..\wavpack\src\pack_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\read_words.c" />
+    <ClCompile Include="..\..\wavpack\src\tags.c" />
+    <ClCompile Include="..\..\wavpack\src\tag_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack_floats.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack_seek.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack_utils.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack3.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack3_open.c" />
+    <ClCompile Include="..\..\wavpack\src\unpack3_seek.c" />
+    <ClCompile Include="..\..\wavpack\src\write_words.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\wavpack\src\unpack3.h" />
+    <ClInclude Include="..\..\wavpack\include\wavpack.h" />
+    <ClInclude Include="..\..\wavpack\src\wavpack_local.h" />
+    <ClInclude Include="..\..\wavpack\src\wavpack_version.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/LibZLib.vcxproj b/msvc14/LibZLib.vcxproj
new file mode 100644
index 00000000..56a8c37a
--- /dev/null
+++ b/msvc14/LibZLib.vcxproj
@@ -0,0 +1,127 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{90D19FCF-8560-4396-A250-DDF74D1B0E36}</ProjectGuid>
+    <RootNamespace>LibZLib</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>StaticLibrary</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\lib\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <PreprocessorDefinitions>WIN32;Z_SOLO;_DEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4142</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <PreprocessorDefinitions>WIN32;Z_SOLO;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <TreatWarningAsError>true</TreatWarningAsError>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4142</DisableSpecificWarnings>
+    </ClCompile>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\..\zlib\adler32.c" />
+    <ClCompile Include="..\..\zlib\compress.c" />
+    <ClCompile Include="..\..\zlib\crc32.c" />
+    <ClCompile Include="..\..\zlib\deflate.c" />
+    <ClCompile Include="..\..\zlib\infback.c" />
+    <ClCompile Include="..\..\zlib\inffast.c" />
+    <ClCompile Include="..\..\zlib\inflate.c" />
+    <ClCompile Include="..\..\zlib\inftrees.c" />
+    <ClCompile Include="..\..\zlib\trees.c" />
+    <ClCompile Include="..\..\zlib\uncompr.c" />
+    <ClCompile Include="..\..\zlib\zutil.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\..\zlib\crc32.h" />
+    <ClInclude Include="..\..\zlib\deflate.h" />
+    <ClInclude Include="..\..\zlib\inffast.h" />
+    <ClInclude Include="..\..\zlib\inffixed.h" />
+    <ClInclude Include="..\..\zlib\inflate.h" />
+    <ClInclude Include="..\..\zlib\inftrees.h" />
+    <ClInclude Include="..\..\zlib\trees.h" />
+    <ClInclude Include="..\..\zlib\zconf.h" />
+    <ClInclude Include="..\..\zlib\zconf.in.h" />
+    <ClInclude Include="..\..\zlib\zlib.h" />
+    <ClInclude Include="..\..\zlib\zutil.h" />
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/Mad/LibMad.def b/msvc14/Mad/LibMad.def
new file mode 100644
index 00000000..1b9c7f3f
--- /dev/null
+++ b/msvc14/Mad/LibMad.def
@@ -0,0 +1,60 @@
+; libSoX libmad export definitions for MSVC9: (c) 2009 SoX contributors
+;
+; This library is free software; you can redistribute it and/or modify it
+; under the terms of the GNU Lesser General Public License as published by
+; the Free Software Foundation; either version 2.1 of the License, or (at
+; your option) any later version.
+;
+; This library is distributed in the hope that it will be useful, but
+; WITHOUT ANY WARRANTY; without even the implied warranty of
+; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+; General Public License for more details.
+;
+; You should have received a copy of the GNU Lesser General Public License
+; along with this library; if not, write to the Free Software Foundation,
+; Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+;
+
+EXPORTS
+
+    mad_bit_crc
+    mad_bit_init
+    mad_bit_length
+    mad_bit_nextbyte
+    mad_bit_read
+    mad_bit_skip
+    
+    mad_decoder_init
+    mad_decoder_finish
+    mad_decoder_message
+    mad_decoder_run
+    
+    mad_frame_decode
+    mad_frame_finish
+    mad_frame_init
+    mad_frame_mute
+    
+    mad_header_decode
+    mad_header_init
+    
+    mad_stream_buffer
+    mad_stream_errorstr
+    mad_stream_finish
+    mad_stream_init
+    mad_stream_skip
+    mad_stream_sync
+    
+    mad_synth_frame
+    mad_synth_init
+    mad_synth_mute
+    
+    mad_timer_abs
+    mad_timer_add
+    mad_timer_compare
+    mad_timer_count
+    mad_timer_fraction
+    mad_timer_multiply
+    mad_timer_negate
+    mad_timer_set
+    mad_timer_string
+    mad_timer_zero
diff --git a/msvc14/Mad/config.h b/msvc14/Mad/config.h
new file mode 100644
index 00000000..8d2cd0d0
--- /dev/null
+++ b/msvc14/Mad/config.h
@@ -0,0 +1,19 @@
+/* libSoX libmad config for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <msvc++/config.h>
+#define FPM_INTEL
diff --git a/msvc14/Makefile.am b/msvc14/Makefile.am
new file mode 100644
index 00000000..4fe89144
--- /dev/null
+++ b/msvc14/Makefile.am
@@ -0,0 +1,31 @@
+EXTRA_DIST= \
+	LibFlac.vcxproj \
+	LibGsm.vcxproj \
+	LibId3Tag.vcxproj \
+	LibLpc10.vcxproj \
+	LibMad.vcxproj \
+	LibMp3Lame.vcxproj \
+	LibOgg.vcxproj \
+	LibPng.vcxproj \
+	LibSndFileG72x.vcxproj \
+	LibSndFileGSM610.vcxproj \
+	LibSndFile.vcxproj \
+	LibSoX.vcxproj \
+	LibSoX.vcxproj.filters \
+	LibSpeex.vcxproj \
+	LibVorbis.vcxproj \
+	LibWavPack.vcxproj \
+	LibZLib.vcxproj \
+	Readme.txt \
+	SoX.sln \
+	SoX.vcxproj \
+	Mad/config.h \
+	Mad/LibMad.def \
+	Mp3Lame/config.h \
+	Png/inttypes.h \
+	Png/pnglibconf.h \
+	SndFile/config.h \
+	SndFile/inttypes.h \
+	SndFile/sndfile.h \
+	SndFile/sys/time.h \
+	SoX/soxconfig.h
diff --git a/msvc14/Mp3Lame/config.h b/msvc14/Mp3Lame/config.h
new file mode 100644
index 00000000..94ccfc78
--- /dev/null
+++ b/msvc14/Mp3Lame/config.h
@@ -0,0 +1,19 @@
+/* libSoX libmp3lame config for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define HAVE_MPGLIB 1
+#include <configMS.h>
diff --git a/msvc14/Png/inttypes.h b/msvc14/Png/inttypes.h
new file mode 100644
index 00000000..cc91d620
--- /dev/null
+++ b/msvc14/Png/inttypes.h
@@ -0,0 +1,18 @@
+/* libSoX libpng stub file for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/* Nothing here. */
diff --git a/msvc14/Png/pnglibconf.h b/msvc14/Png/pnglibconf.h
new file mode 100644
index 00000000..6ea71740
--- /dev/null
+++ b/msvc14/Png/pnglibconf.h
@@ -0,0 +1,18 @@
+/* libSoX libpng config for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include "../../../libpng/scripts/pnglibconf.h.prebuilt"
\ No newline at end of file
diff --git a/msvc14/SndFile/config.h b/msvc14/SndFile/config.h
new file mode 100644
index 00000000..641836c0
--- /dev/null
+++ b/msvc14/SndFile/config.h
@@ -0,0 +1,311 @@
+/* libSoX libsndfile config for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define inline __inline
+typedef __int64 __int64_t;
+typedef __int64 int64_t;
+typedef __int32 int32_t;
+typedef unsigned __int32 uint32_t;
+typedef unsigned __int16 uint16_t;
+#define ptrdiff_t ssize_t
+#define __func__ __FUNCTION__
+#define FLAC__NO_DLL
+#if _MSC_VER < 1800
+#define lrint(f)  ((long)(f))
+#define lrintf(f) lrint(f)
+#endif
+#if _MSC_VER < 1900
+#define snprintf _snprintf
+#endif
+
+#define R_OK 4
+#define W_OK 2
+#define X_OK 0
+
+/* Set to 1 if the compile is GNU GCC. */
+#undef COMPILER_IS_GCC
+
+/* Target processor clips on negative float to int conversion. */
+#define CPU_CLIPS_NEGATIVE 0
+
+/* Target processor clips on positive float to int conversion. */
+#define CPU_CLIPS_POSITIVE 0
+
+/* Target processor is big endian. */
+#define CPU_IS_BIG_ENDIAN 0
+
+/* Target processor is little endian. */
+#define CPU_IS_LITTLE_ENDIAN 1
+
+/* Set to 1 to enable experimental code. */
+#undef ENABLE_EXPERIMENTAL_CODE
+
+/* Define to 1 if you have the <alsa/asoundlib.h> header file. */
+#undef HAVE_ALSA_ASOUNDLIB_H
+
+/* Define to 1 if you have the <byteswap.h> header file. */
+#undef HAVE_BYTESWAP_H
+
+/* Define to 1 if you have the `calloc' function. */
+#define HAVE_CALLOC 1
+
+/* Define to 1 if you have the `ceil' function. */
+#define HAVE_CEIL 1
+
+/* Set to 1 if S_IRGRP is defined. */
+#undef HAVE_DECL_S_IRGRP
+
+/* Define to 1 if you have the <dlfcn.h> header file. */
+#undef HAVE_DLFCN_H
+
+/* Define to 1 if you have the <endian.h> header file. */
+#undef HAVE_ENDIAN_H
+
+/* Will be set to 1 if flac, ogg and vorbis are available. */
+#define HAVE_EXTERNAL_LIBS 1
+
+/* Set to 1 if the compile supports the struct hack. */
+#define HAVE_FLEXIBLE_ARRAY 1
+
+/* Define to 1 if you have the `floor' function. */
+#define HAVE_FLOOR 1
+
+/* Define to 1 if you have the `fmod' function. */
+#define HAVE_FMOD 1
+
+/* Define to 1 if you have the `free' function. */
+#define HAVE_FREE 1
+
+/* Define to 1 if you have the `fstat' function. */
+#define HAVE_FSTAT 1
+
+/* Define to 1 if you have the `fsync' function. */
+#undef HAVE_FSYNC
+
+/* Define to 1 if you have the `ftruncate' function. */
+#undef HAVE_FTRUNCATE
+
+/* Define to 1 if you have the `getpagesize' function. */
+#undef HAVE_GETPAGESIZE
+
+/* Define to 1 if you have the `gettimeofday' function. */
+#undef HAVE_GETTIMEOFDAY
+
+/* Define to 1 if you have the `gmtime' function. */
+#define HAVE_GMTIME 1
+
+/* Define to 1 if you have the `gmtime_r' function. */
+#undef HAVE_GMTIME_R
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#undef HAVE_INTTYPES_H
+
+/* Set to 1 if you have JACK. */
+#undef HAVE_JACK
+
+/* Define to 1 if you have the `m' library (-lm). */
+#define HAVE_LIBM 1
+
+/* Define to 1 if you have the <locale.h> header file. */
+#define HAVE_LOCALE_H 1
+
+/* Define to 1 if you have the `localtime' function. */
+#define HAVE_LOCALTIME 1
+
+/* Define to 1 if you have the `localtime_r' function. */
+#undef HAVE_LOCALTIME_R
+
+/* Define to 1 if you have the `lseek' function. */
+#define HAVE_LSEEK 1
+
+/* Define to 1 if you have the `malloc' function. */
+#define HAVE_MALLOC 1
+
+/* Define to 1 if you have the <memory.h> header file. */
+#define HAVE_MEMORY_H 1
+
+/* Define to 1 if you have the `mmap' function. */
+#undef HAVE_MMAP
+
+/* Define to 1 if you have the `open' function. */
+#define HAVE_OPEN 1
+
+/* Define to 1 if you have the `pread' function. */
+#undef HAVE_PREAD
+
+/* Define to 1 if you have the `pwrite' function. */
+#undef HAVE_PWRITE
+
+/* Define to 1 if you have the `read' function. */
+#define HAVE_READ 1
+
+/* Define to 1 if you have the `realloc' function. */
+#define HAVE_REALLOC 1
+
+/* Define to 1 if you have the `setlocale' function. */
+#define HAVE_SETLOCALE 1
+
+/* Define to 1 if you have the `snprintf' function. */
+#define HAVE_SNPRINTF 1
+
+/* Set to 1 if you have libsqlite3. */
+#undef HAVE_SQLITE3
+
+/* Define to 1 if the system has the type `ssize_t'. */
+#undef HAVE_SSIZE_T
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#define HAVE_STDINT_H 1
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#define HAVE_STDLIB_H 1
+
+/* Define to 1 if you have the <strings.h> header file. */
+#undef HAVE_STRINGS_H
+
+/* Define to 1 if you have the <string.h> header file. */
+#define HAVE_STRING_H 1
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#define HAVE_SYS_STAT_H 1
+
+/* Define to 1 if you have the <sys/time.h> header file. */
+#undef HAVE_SYS_TIME_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#define HAVE_SYS_TYPES_H 1
+
+/* Define to 1 if you have <sys/wait.h> that is POSIX.1 compatible. */
+#undef HAVE_SYS_WAIT_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#undef HAVE_UNISTD_H
+
+/* Set to 1 if we have vorbis_version_string. */
+#undef HAVE_VORBIS_VERSION_STRING
+
+/* Define to 1 if you have the `vsnprintf' function. */
+#define HAVE_VSNPRINTF 1
+
+/* Define to 1 if you have the `write' function. */
+#define HAVE_WRITE 1
+
+/* Define to the sub-directory in which libtool stores uninstalled libraries.
+   */
+#undef LT_OBJDIR
+
+/* Define to 1 if your C compiler doesn't accept -c and -o together. */
+#undef NO_MINUS_C_MINUS_O
+
+/* Set to 1 if compiling for MacOSX */
+#undef OS_IS_MACOSX
+
+/* Set to 1 if compiling for Win32 */
+#define OS_IS_WIN32 1
+
+/* Name of package */
+#define PACKAGE "libsndfile"
+
+/* Define to the address where bug reports for this package should be sent. */
+#define PACKAGE_BUGREPORT "erikd@mega-nerd.com"
+
+/* Define to the full name of this package. */
+#define PACKAGE_NAME "libsndfile"
+
+/* Define to the full name and version of this package. */
+#define PACKAGE_STRING "libsndfile 1.0.20"
+
+/* Define to the one symbol short name of this package. */
+#define PACKAGE_TARNAME "libsndfile"
+
+/* Define to the version of this package. */
+#define PACKAGE_VERSION "1.0.20"
+
+/* Set to maximum allowed value of sf_count_t type. */
+//#define SF_COUNT_MAX (9223372036854775807i64)
+
+/* The size of `double', as computed by sizeof. */
+#define SIZEOF_DOUBLE (8)
+
+/* The size of `float', as computed by sizeof. */
+#define SIZEOF_FLOAT (4)
+
+/* The size of `int', as computed by sizeof. */
+#define SIZEOF_INT (4)
+
+/* The size of `int64_t', as computed by sizeof. */
+#define SIZEOF_INT64_T (8)
+
+/* The size of `loff_t', as computed by sizeof. */
+#undef SIZEOF_LOFF_T
+
+/* The size of `long', as computed by sizeof. */
+#define SIZEOF_LONG (4)
+
+/* The size of `long long', as computed by sizeof. */
+#define SIZEOF_LONG_LONG (8)
+
+/* The size of `off64_t', as computed by sizeof. */
+#undef SIZEOF_OFF64_T
+
+/* The size of `off_t', as computed by sizeof. */
+#define SIZEOF_OFF_T (4)
+
+/* Set to sizeof (long) if unknown. */
+#define SIZEOF_SF_COUNT_T (8)
+
+/* The size of `short', as computed by sizeof. */
+#define SIZEOF_SHORT (2)
+
+/* The size of `size_t', as computed by sizeof. */
+#define SIZEOF_SIZE_T (4)
+
+/* The size of `ssize_t', as computed by sizeof. */
+#undef SIZEOF_SSIZE_T
+
+/* The size of `void*', as computed by sizeof. */
+#define SIZEOF_VOIDP (4)
+
+/* The size of `wchar_t', as computed by sizeof. */
+#define SIZEOF_WCHAR_T (2)
+
+/* Define to 1 if you have the ANSI C header files. */
+#define STDC_HEADERS 1
+
+/* Set to long if unknown. */
+#define TYPEOF_SF_COUNT_T __int64
+
+/* Set to 1 to use the native windows API */
+#define USE_WINDOWS_API 1
+
+/* Version number of package */
+#define VERSION "1.0.20"
+
+/* Set to 1 if windows DLL is being built. */
+#define WIN32_TARGET_DLL 1
+
+/* Target processor is big endian. */
+#undef WORDS_BIGENDIAN
+
+/* Number of bits in a file offset, on hosts where this is settable. */
+#undef _FILE_OFFSET_BITS
+
+/* Define to make fseeko etc. visible, on some hosts. */
+#undef _LARGEFILE_SOURCE
+
+/* Define for large files, on AIX-style hosts. */
+#undef _LARGE_FILES
diff --git a/msvc14/SndFile/inttypes.h b/msvc14/SndFile/inttypes.h
new file mode 100644
index 00000000..15b87643
--- /dev/null
+++ b/msvc14/SndFile/inttypes.h
@@ -0,0 +1,18 @@
+/* libSoX libpng stub file for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define PRId64 "lld"
diff --git a/msvc14/SndFile/sndfile.h b/msvc14/SndFile/sndfile.h
new file mode 100644
index 00000000..641d7526
--- /dev/null
+++ b/msvc14/SndFile/sndfile.h
@@ -0,0 +1,19 @@
+/* libSoX libsndfile wrapper for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+typedef __int64 __int64_t;
+#include "../../libsndfile/src/sndfile.h.in"
diff --git a/msvc14/SndFile/sys/time.h b/msvc14/SndFile/sys/time.h
new file mode 100644
index 00000000..9511546f
--- /dev/null
+++ b/msvc14/SndFile/sys/time.h
@@ -0,0 +1,18 @@
+/* libSoX libsndfile stub file for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/* Nothing here. */
diff --git a/msvc14/SoX.sln b/msvc14/SoX.sln
new file mode 100644
index 00000000..7a41ff69
--- /dev/null
+++ b/msvc14/SoX.sln
@@ -0,0 +1,124 @@
+﻿
+Microsoft Visual Studio Solution File, Format Version 12.00
+# Visual Studio 14
+VisualStudioVersion = 14.0.25420.1
+MinimumVisualStudioVersion = 10.0.40219.1
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSoX", "LibSoX.vcxproj", "{F17BE535-C7E8-4930-A6FD-32498D73A533}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "SoX", "SoX.vcxproj", "{AC136601-504C-4E1A-9DC8-0CC493AA0983}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibFlac", "LibFlac.vcxproj", "{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibGsm", "LibGsm.vcxproj", "{BEE9F57C-384E-4C99-87EB-629BF45C8A89}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibLpc10", "LibLpc10.vcxproj", "{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibMad", "LibMad.vcxproj", "{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibMp3Lame", "LibMp3Lame.vcxproj", "{4DFD6FD1-96F1-434A-AC69-01783B876354}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibOgg", "LibOgg.vcxproj", "{C5C229AC-316D-42CB-9CA3-329619618972}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibPng", "LibPng.vcxproj", "{46E7AC9D-3E96-4B34-B493-501BC277D6F9}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibWavPack", "LibWavPack.vcxproj", "{7461CC57-B1CB-4766-B357-F51587449474}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibVorbis", "LibVorbis.vcxproj", "{524A24CD-0973-4733-8EB9-F419DC6F9997}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibZLib", "LibZLib.vcxproj", "{90D19FCF-8560-4396-A250-DDF74D1B0E36}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibId3Tag", "LibId3Tag.vcxproj", "{40EA92B6-38AA-4E67-894D-92C37C946402}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSndFileG72x", "LibSndFileG72x.vcxproj", "{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSndFileGSM610", "LibSndFileGSM610.vcxproj", "{D2572DE1-610E-46A4-8DD2-8A693347D76A}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSndFile", "LibSndFile.vcxproj", "{342BDA83-C83F-4168-8425-E1DF72F47018}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSpeex", "LibSpeex.vcxproj", "{60902B83-8B26-4DBD-B635-4CECF5F4744C}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LibSpeexDsp", "LibSpeexDsp.vcxproj", "{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}"
+EndProject
+Global
+	GlobalSection(SolutionConfigurationPlatforms) = preSolution
+		Debug|Win32 = Debug|Win32
+		Release|Win32 = Release|Win32
+	EndGlobalSection
+	GlobalSection(ProjectConfigurationPlatforms) = postSolution
+		{F17BE535-C7E8-4930-A6FD-32498D73A533}.Debug|Win32.ActiveCfg = Debug|Win32
+		{F17BE535-C7E8-4930-A6FD-32498D73A533}.Debug|Win32.Build.0 = Debug|Win32
+		{F17BE535-C7E8-4930-A6FD-32498D73A533}.Release|Win32.ActiveCfg = Release|Win32
+		{F17BE535-C7E8-4930-A6FD-32498D73A533}.Release|Win32.Build.0 = Release|Win32
+		{AC136601-504C-4E1A-9DC8-0CC493AA0983}.Debug|Win32.ActiveCfg = Debug|Win32
+		{AC136601-504C-4E1A-9DC8-0CC493AA0983}.Debug|Win32.Build.0 = Debug|Win32
+		{AC136601-504C-4E1A-9DC8-0CC493AA0983}.Release|Win32.ActiveCfg = Release|Win32
+		{AC136601-504C-4E1A-9DC8-0CC493AA0983}.Release|Win32.Build.0 = Release|Win32
+		{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}.Debug|Win32.ActiveCfg = Debug|Win32
+		{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}.Debug|Win32.Build.0 = Debug|Win32
+		{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}.Release|Win32.ActiveCfg = Release|Win32
+		{38203D05-AF71-4FF2-A183-A7D9CB8D2AE0}.Release|Win32.Build.0 = Release|Win32
+		{BEE9F57C-384E-4C99-87EB-629BF45C8A89}.Debug|Win32.ActiveCfg = Debug|Win32
+		{BEE9F57C-384E-4C99-87EB-629BF45C8A89}.Debug|Win32.Build.0 = Debug|Win32
+		{BEE9F57C-384E-4C99-87EB-629BF45C8A89}.Release|Win32.ActiveCfg = Release|Win32
+		{BEE9F57C-384E-4C99-87EB-629BF45C8A89}.Release|Win32.Build.0 = Release|Win32
+		{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}.Debug|Win32.ActiveCfg = Debug|Win32
+		{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}.Debug|Win32.Build.0 = Debug|Win32
+		{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}.Release|Win32.ActiveCfg = Release|Win32
+		{C588FF17-FB2F-48D9-BB99-40B6D52B9B85}.Release|Win32.Build.0 = Release|Win32
+		{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}.Debug|Win32.ActiveCfg = Debug|Win32
+		{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}.Debug|Win32.Build.0 = Debug|Win32
+		{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}.Release|Win32.ActiveCfg = Release|Win32
+		{B7A8AD9A-0D07-4453-B2DE-FEABD9546263}.Release|Win32.Build.0 = Release|Win32
+		{4DFD6FD1-96F1-434A-AC69-01783B876354}.Debug|Win32.ActiveCfg = Debug|Win32
+		{4DFD6FD1-96F1-434A-AC69-01783B876354}.Debug|Win32.Build.0 = Debug|Win32
+		{4DFD6FD1-96F1-434A-AC69-01783B876354}.Release|Win32.ActiveCfg = Release|Win32
+		{4DFD6FD1-96F1-434A-AC69-01783B876354}.Release|Win32.Build.0 = Release|Win32
+		{C5C229AC-316D-42CB-9CA3-329619618972}.Debug|Win32.ActiveCfg = Debug|Win32
+		{C5C229AC-316D-42CB-9CA3-329619618972}.Debug|Win32.Build.0 = Debug|Win32
+		{C5C229AC-316D-42CB-9CA3-329619618972}.Release|Win32.ActiveCfg = Release|Win32
+		{C5C229AC-316D-42CB-9CA3-329619618972}.Release|Win32.Build.0 = Release|Win32
+		{46E7AC9D-3E96-4B34-B493-501BC277D6F9}.Debug|Win32.ActiveCfg = Debug|Win32
+		{46E7AC9D-3E96-4B34-B493-501BC277D6F9}.Debug|Win32.Build.0 = Debug|Win32
+		{46E7AC9D-3E96-4B34-B493-501BC277D6F9}.Release|Win32.ActiveCfg = Release|Win32
+		{46E7AC9D-3E96-4B34-B493-501BC277D6F9}.Release|Win32.Build.0 = Release|Win32
+		{7461CC57-B1CB-4766-B357-F51587449474}.Debug|Win32.ActiveCfg = Debug|Win32
+		{7461CC57-B1CB-4766-B357-F51587449474}.Debug|Win32.Build.0 = Debug|Win32
+		{7461CC57-B1CB-4766-B357-F51587449474}.Release|Win32.ActiveCfg = Release|Win32
+		{7461CC57-B1CB-4766-B357-F51587449474}.Release|Win32.Build.0 = Release|Win32
+		{524A24CD-0973-4733-8EB9-F419DC6F9997}.Debug|Win32.ActiveCfg = Debug|Win32
+		{524A24CD-0973-4733-8EB9-F419DC6F9997}.Debug|Win32.Build.0 = Debug|Win32
+		{524A24CD-0973-4733-8EB9-F419DC6F9997}.Release|Win32.ActiveCfg = Release|Win32
+		{524A24CD-0973-4733-8EB9-F419DC6F9997}.Release|Win32.Build.0 = Release|Win32
+		{90D19FCF-8560-4396-A250-DDF74D1B0E36}.Debug|Win32.ActiveCfg = Debug|Win32
+		{90D19FCF-8560-4396-A250-DDF74D1B0E36}.Debug|Win32.Build.0 = Debug|Win32
+		{90D19FCF-8560-4396-A250-DDF74D1B0E36}.Release|Win32.ActiveCfg = Release|Win32
+		{90D19FCF-8560-4396-A250-DDF74D1B0E36}.Release|Win32.Build.0 = Release|Win32
+		{40EA92B6-38AA-4E67-894D-92C37C946402}.Debug|Win32.ActiveCfg = Debug|Win32
+		{40EA92B6-38AA-4E67-894D-92C37C946402}.Debug|Win32.Build.0 = Debug|Win32
+		{40EA92B6-38AA-4E67-894D-92C37C946402}.Release|Win32.ActiveCfg = Release|Win32
+		{40EA92B6-38AA-4E67-894D-92C37C946402}.Release|Win32.Build.0 = Release|Win32
+		{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}.Debug|Win32.ActiveCfg = Debug|Win32
+		{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}.Debug|Win32.Build.0 = Debug|Win32
+		{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}.Release|Win32.ActiveCfg = Release|Win32
+		{7016D4C2-A0AB-4BFD-9AA1-4ECDCCBE6301}.Release|Win32.Build.0 = Release|Win32
+		{D2572DE1-610E-46A4-8DD2-8A693347D76A}.Debug|Win32.ActiveCfg = Debug|Win32
+		{D2572DE1-610E-46A4-8DD2-8A693347D76A}.Debug|Win32.Build.0 = Debug|Win32
+		{D2572DE1-610E-46A4-8DD2-8A693347D76A}.Release|Win32.ActiveCfg = Release|Win32
+		{D2572DE1-610E-46A4-8DD2-8A693347D76A}.Release|Win32.Build.0 = Release|Win32
+		{342BDA83-C83F-4168-8425-E1DF72F47018}.Debug|Win32.ActiveCfg = Debug|Win32
+		{342BDA83-C83F-4168-8425-E1DF72F47018}.Debug|Win32.Build.0 = Debug|Win32
+		{342BDA83-C83F-4168-8425-E1DF72F47018}.Release|Win32.ActiveCfg = Release|Win32
+		{342BDA83-C83F-4168-8425-E1DF72F47018}.Release|Win32.Build.0 = Release|Win32
+		{60902B83-8B26-4DBD-B635-4CECF5F4744C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{60902B83-8B26-4DBD-B635-4CECF5F4744C}.Debug|Win32.Build.0 = Debug|Win32
+		{60902B83-8B26-4DBD-B635-4CECF5F4744C}.Release|Win32.ActiveCfg = Release|Win32
+		{60902B83-8B26-4DBD-B635-4CECF5F4744C}.Release|Win32.Build.0 = Release|Win32
+		{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}.Debug|Win32.Build.0 = Debug|Win32
+		{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}.Release|Win32.ActiveCfg = Release|Win32
+		{BF1A8B37-E85A-4467-B9B6-D207DF189F4C}.Release|Win32.Build.0 = Release|Win32
+	EndGlobalSection
+	GlobalSection(SolutionProperties) = preSolution
+		HideSolutionNode = FALSE
+	EndGlobalSection
+EndGlobal
diff --git a/msvc14/SoX.vcxproj b/msvc14/SoX.vcxproj
new file mode 100644
index 00000000..6417a03e
--- /dev/null
+++ b/msvc14/SoX.vcxproj
@@ -0,0 +1,194 @@
+﻿<?xml version="1.0" encoding="utf-8"?>
+<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <ItemGroup Label="ProjectConfigurations">
+    <ProjectConfiguration Include="Debug|Win32">
+      <Configuration>Debug</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+    <ProjectConfiguration Include="Release|Win32">
+      <Configuration>Release</Configuration>
+      <Platform>Win32</Platform>
+    </ProjectConfiguration>
+  </ItemGroup>
+  <PropertyGroup Label="Globals">
+    <ProjectGuid>{AC136601-504C-4E1A-9DC8-0CC493AA0983}</ProjectGuid>
+    <RootNamespace>SoX</RootNamespace>
+    <Keyword>Win32Proj</Keyword>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
+    <ConfigurationType>Application</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <WholeProgramOptimization>true</WholeProgramOptimization>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
+    <ConfigurationType>Application</ConfigurationType>
+    <CharacterSet>Unicode</CharacterSet>
+    <PlatformToolset>v140</PlatformToolset>
+  </PropertyGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
+  <ImportGroup Label="ExtensionSettings">
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <ImportGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="PropertySheets">
+    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
+  </ImportGroup>
+  <PropertyGroup Label="UserMacros" />
+  <PropertyGroup>
+    <_ProjectFileVersion>10.0.30319.1</_ProjectFileVersion>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <PostBuildEventUseInBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">false</PostBuildEventUseInBuild>
+    <OutDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\</OutDir>
+    <IntDir Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">$(SolutionDir)$(Configuration)\$(ProjectName)\</IntDir>
+    <LinkIncremental Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">false</LinkIncremental>
+    <PostBuildEventUseInBuild Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">false</PostBuildEventUseInBuild>
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" />
+    <CodeAnalysisRuleSet Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">AllRules.ruleset</CodeAnalysisRuleSet>
+    <CodeAnalysisRules Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+    <CodeAnalysisRuleAssemblies Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" />
+  </PropertyGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
+    <ClCompile>
+      <Optimization>Disabled</Optimization>
+      <AdditionalIncludeDirectories>SoX;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;SOX_IMPORT;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <MinimalRebuild>true</MinimalRebuild>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
+      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+    <Link>
+      <AdditionalDependencies>winmm.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).exe</OutputFile>
+      <DelayLoadDLLs>winmm.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <SubSystem>Console</SubSystem>
+      <OptimizeReferences>
+      </OptimizeReferences>
+      <SetChecksum>true</SetChecksum>
+      <TargetMachine>MachineX86</TargetMachine>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
+    <ClCompile>
+      <Optimization>MaxSpeed</Optimization>
+      <IntrinsicFunctions>true</IntrinsicFunctions>
+      <AdditionalIncludeDirectories>SoX;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;SOX_IMPORT;_CRT_SECURE_NO_WARNINGS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <StringPooling>true</StringPooling>
+      <ExceptionHandling>
+      </ExceptionHandling>
+      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
+      <FunctionLevelLinking>true</FunctionLevelLinking>
+      <FloatingPointModel>Fast</FloatingPointModel>
+      <RuntimeTypeInfo>false</RuntimeTypeInfo>
+      <PrecompiledHeader>
+      </PrecompiledHeader>
+      <WarningLevel>Level3</WarningLevel>
+      <SuppressStartupBanner>true</SuppressStartupBanner>
+      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
+      <CallingConvention>Cdecl</CallingConvention>
+      <DisableSpecificWarnings>4244;%(DisableSpecificWarnings)</DisableSpecificWarnings>
+    </ClCompile>
+    <Link>
+      <AdditionalDependencies>winmm.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <OutputFile>$(SolutionDir)$(Configuration)\$(ProjectName).exe</OutputFile>
+      <DelayLoadDLLs>winmm.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
+      <GenerateDebugInformation>true</GenerateDebugInformation>
+      <SubSystem>Console</SubSystem>
+      <OptimizeReferences>true</OptimizeReferences>
+      <EnableCOMDATFolding>true</EnableCOMDATFolding>
+      <SetChecksum>true</SetChecksum>
+      <TargetMachine>MachineX86</TargetMachine>
+    </Link>
+  </ItemDefinitionGroup>
+  <ItemGroup>
+    <ClCompile Include="..\src\sox.c" />
+    <ClCompile Include="..\src\win32-glob.c" />
+  </ItemGroup>
+  <ItemGroup>
+    <ClInclude Include="..\src\win32-glob.h" />
+  </ItemGroup>
+  <ItemGroup>
+    <ProjectReference Include="LibFlac.vcxproj">
+      <Project>{38203d05-af71-4ff2-a183-a7d9cb8d2ae0}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibGsm.vcxproj">
+      <Project>{bee9f57c-384e-4c99-87eb-629bf45c8a89}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibId3Tag.vcxproj">
+      <Project>{40ea92b6-38aa-4e67-894d-92c37c946402}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibLpc10.vcxproj">
+      <Project>{c588ff17-fb2f-48d9-bb99-40b6d52b9b85}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibOgg.vcxproj">
+      <Project>{c5c229ac-316d-42cb-9ca3-329619618972}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibPng.vcxproj">
+      <Project>{46e7ac9d-3e96-4b34-b493-501bc277d6f9}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSndFile.vcxproj">
+      <Project>{342bda83-c83f-4168-8425-e1df72f47018}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSndFileG72x.vcxproj">
+      <Project>{7016d4c2-a0ab-4bfd-9aa1-4ecdccbe6301}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSndFileGSM610.vcxproj">
+      <Project>{d2572de1-610e-46a4-8dd2-8a693347d76a}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSoX.vcxproj">
+      <Project>{f17be535-c7e8-4930-a6fd-32498d73a533}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSpeex.vcxproj">
+      <Project>{60902b83-8b26-4dbd-b635-4cecf5f4744c}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibSpeexDsp.vcxproj">
+      <Project>{bf1a8b37-e85a-4467-b9b6-d207df189f4c}</Project>
+    </ProjectReference>
+    <ProjectReference Include="LibVorbis.vcxproj">
+      <Project>{524a24cd-0973-4733-8eb9-f419dc6f9997}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibWavPack.vcxproj">
+      <Project>{7461cc57-b1cb-4766-b357-f51587449474}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+    <ProjectReference Include="LibZLib.vcxproj">
+      <Project>{90d19fcf-8560-4396-a250-ddf74d1b0e36}</Project>
+      <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
+    </ProjectReference>
+  </ItemGroup>
+  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
+  <ImportGroup Label="ExtensionTargets">
+  </ImportGroup>
+</Project>
diff --git a/msvc14/SoX/soxconfig.h b/msvc14/SoX/soxconfig.h
new file mode 100644
index 00000000..e869b934
--- /dev/null
+++ b/msvc14/SoX/soxconfig.h
@@ -0,0 +1,111 @@
+/* libSoX config file for MSVC9: (c) 2009 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/* Enable some extra warnings.
+   Track the number of times each warning has been helpful. */
+#pragma warning(3: 4287) /* 0 - constant sign mismatch */
+#pragma warning(3: 4296) /* 1 - expression is always false */
+#pragma warning(3: 4365) /* 0 - conversion sign mismatch */
+#pragma warning(3: 4431) /* 0 - default int assumed */
+#pragma warning(3: 4545) /* 0 - comma expression */
+#pragma warning(3: 4546) /* 0 - comma expression */
+#pragma warning(3: 4547) /* 0 - comma expression */
+#pragma warning(3: 4548) /* 0 - comma expression */
+#pragma warning(3: 4549) /* 0 - comma expression */
+#pragma warning(3: 4555) /* 0 - expression has no effect */
+#pragma warning(3: 4628) /* 0 - digraph */
+#pragma warning(3: 4826) /* 0 - conversion sign extension */
+#pragma warning(3: 4837) /* 0 - trigraph */
+#pragma warning(3: 4905) /* 0 - string assignment mismatch */
+#pragma warning(3: 4906) /* 0 - string assignment mismatch */
+
+/* Used only by sox.c: */
+#define MORE_INTERACTIVE
+
+#define PACKAGE_EXTRA "msvc"
+
+/* Special behavior defined by win32-ltdl: "./" is replaced with the name of the
+   directory containing sox.exe. */
+#define PKGLIBDIR "./soxlib"
+
+#define HAVE_AMRNB 1
+#define STATIC_AMRNB 1
+#define DL_AMRNB 1
+
+#define HAVE_AMRWB 1
+#define STATIC_AMRWB 1
+#define DL_AMRWB 1
+
+#define HAVE_FLAC 1
+#define STATIC_FLAC 1
+#define FLAC__NO_DLL
+
+#define HAVE_GSM 1
+#define STATIC_GSM 1
+
+#define HAVE_ID3TAG 1
+
+#define DL_LAME 1
+
+#define HAVE_LPC10 1
+#define STATIC_LPC10 1
+
+#define HAVE_MAD_H 1
+#define DL_MAD 1
+
+#define HAVE_MP3 1
+#define STATIC_MP3 1
+
+#define HAVE_OGG_VORBIS 1
+#define STATIC_OGG_VORBIS 1
+
+#define HAVE_PNG 1
+
+#define HAVE_SNDFILE 1
+#define HAVE_SNDFILE_1_0_18 1
+#define HAVE_SFC_SET_SCALE_INT_FLOAT_WRITE 1
+#define STATIC_SNDFILE 1
+
+#define HAVE_SPEEXDSP 1
+
+#define HAVE_WAVEAUDIO 1
+#define STATIC_WAVEAUDIO 1
+
+#define HAVE_WAVPACK 1
+#define HAVE_WAVPACK_H 1
+#define STATIC_WAVPACK 1
+
+#define HAVE_CONIO_H 1
+#define HAVE__FSEEKI64 1
+#define HAVE_FCNTL_H 1
+#define HAVE_IO_H 1
+#define HAVE_MEMORY_H 1
+#define HAVE_POPEN 1
+#define HAVE_STDINT_H 1
+#define HAVE_STDLIB_H 1
+#define HAVE_STRDUP 1
+#define HAVE_STRING_H 1
+#define HAVE_SYS_STAT_H 1
+#define HAVE_SYS_TIMEB_H 1
+#define HAVE_SYS_TYPES_H 1
+#define HAVE_VSNPRINTF 1
+#define HAVE_WIN32_GLOB_H 1
+#define HAVE_WIN32_LTDL_H 1
+
+#ifndef __cplusplus
+#define inline __inline
+#endif
diff --git a/msvc9/LibSoX.vcproj b/msvc9/LibSoX.vcproj
index 362f8d77..22c4a148 100644
--- a/msvc9/LibSoX.vcproj
+++ b/msvc9/LibSoX.vcproj
@@ -233,10 +233,6 @@
 				RelativePath="..\src\g72x.h"
 				>
 			</File>
-			<File
-				RelativePath="..\src\ignore-warning.h"
-				>
-			</File>
 			<File
 				RelativePath="..\src\ima_rw.h"
 				>
diff --git a/sox.1 b/sox.1
index 2c4ca470..b38ca437 100644
--- a/sox.1
+++ b/sox.1
@@ -2012,11 +2012,19 @@ option is not given, then the pseudo-random number generator used to
 generate the white noise will be `reseeded', i.e. the generated noise
 will be different between invocations.
 .SP
+If the target precision is 1-bit, the \fBsdm\fR effect is applied
+automatically with default settings. Invoke it manually to control its
+options.
+.SP
 This effect should not be followed by any other effect that
 affects the audio.
 .SP
 See also the `Dithering' section above.
 .TP
+\fBdop\fR
+DSD over PCM.  1-bit DSD data is packed into 24-bit samples for
+transport over non-DSD-aware links.
+.TP
 \fBdownsample\fR [\fIfactor\fR(2)]
 Downsample the signal by an integer factor: Only the first out of
 each \fIfactor\fR samples is retained, the others are discarded.
@@ -2535,7 +2543,7 @@ Non linear distortion.
 The \fIcolour\fR parameter controls the amount of even harmonic content
 in the over-driven output.
 .TP
-\fBpad\fR { \fIlength\fR[\fB@\fIposition(=)\fR] }
+\fBpad\fR { \fI[%]length\fR[\fB@\fIposition(=)\fR] }
 Pad the audio with silence, at the beginning, the end, or any
 specified points through the audio.
 .I length
@@ -2556,6 +2564,11 @@ inserts 4000 samples of silence 3 minutes into the audio.
 If silence is wanted only at the end of the audio, specify either the end
 position or specify a zero-length pad at the start.
 .SP
+If a pad specification starts with with a % sign, the output is padded
+to a multiple of \fIlength\fR at the specified position. For example,
+\fBpad 0 %10\fR adds silence at the end of the audio up to the next
+multiple of 10 seconds.
+.SP
 See also
 .B delay
 for an effect that can add silence at the beginning of
@@ -2991,6 +3004,36 @@ The sampling rate must be one of: 44\*d1, 48, 88\*d2, 96 kHz.
 .SP
 This effect supports the \fB\-\-plot\fR global option.
 .TP
+\fBsdm\fR [\fB\-f \fIfilter\fR] [\fB\-t \fIorder\fR] [\fB\-n \fInum\fR] [\fB-l \fIlatency\fR]
+Apply a 1-bit sigma-delta modulator producing DSD output.  The input
+should be previously upsampled, e.g. with the \fBrate\fR effect, to a
+high rate, 2\*d8224MHz for DSD64.  The \fB\-f\fR option selects the
+noise-shaping filter from the following list where the number indicates
+the order of the filter:
+.EX
+   clans-4      sdm-4
+   clans-5      sdm-5
+   clans-6      sdm-6
+   clans-7      sdm-7
+   clans-8      sdm-8
+.EE
+.TP
+\ 
+The noise filter may be combined with a partial trellis/viterbi search
+by supplying the following options:
+.RS
+.IP \fB\-t \fIorder\fR
+Trellis order, max 32.
+.IP \fB\-n \fInum\fR
+Number of paths to consider, max 32.
+.IP \fB\-l \fIlatency\fR
+Output latency, max 2048.
+.RE
+.TP
+\ 
+The result of using these parameters is hard to predict and can include
+high noise levels or instability.  Caution is advised.
+.TP
 \fBsilence \fR[\fB\-l\fR] \fIabove-periods\fR [\fIduration threshold\fR[\fBd\fR\^|\^\fB%\fR]
 [\fIbelow-periods duration threshold\fR[\fBd\fR\^|\^\fB%\fR]]
 .SP
diff --git a/soxformat.7 b/soxformat.7
index 5e53b9f9..645910ea 100644
--- a/soxformat.7
+++ b/soxformat.7
@@ -304,6 +304,15 @@ Example containing only 2 stereo samples of silence:
     0.00012481278	0	0
 .EE
 .TP
+.B .dff
+Direct Stream Digital Interchange File Format (DSDIFF). Format defined
+by Philips for storing 1-bit DSD data.  Used in SACD mastering and
+occasionally for online distribution.
+.TP
+.B .dsf
+DSD Stream File.  Format defined by Sony for storing 1-bit DSD data.
+Commonly used for online distribution of audiophile recordings.
+.TP
 \&\fB.dvms\fR, \fB.vms\fR
 Used in Germany to compress speech audio for voice mail.
 A self-describing variant of
diff --git a/src/Makefile.am b/src/Makefile.am
index 7cceaafd..553eb55c 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -69,17 +69,16 @@ libsox_la_SOURCES = adpcms.c adpcms.h aiff.c aiff.h cvsd.c cvsd.h cvsdfilt.h \
 libsox_la_SOURCES += \
 	band.h bend.c biquad.c biquad.h biquads.c chorus.c compand.c \
 	compandt.c compandt.h contrast.c dcshift.c delay.c dft_filter.c \
-	dft_filter.h dither.c dither.h divide.c downsample.c earwax.c \
+	dft_filter.h dither.c dither.h divide.c dop.c downsample.c earwax.c \
 	echo.c echos.c effects.c effects.h effects_i.c effects_i_dsp.c \
 	fade.c fft4g.c fft4g.h fifo.h fir.c firfit.c flanger.c gain.c \
 	hilbert.c input.c ladspa.h ladspa.c loudness.c mcompand.c \
 	mcompand_xover.h noiseprof.c noisered.c \
 	noisered.h output.c overdrive.c pad.c phaser.c rate.c \
 	rate_filters.h rate_half_fir.h rate_poly_fir0.h rate_poly_fir.h \
-	remix.c repeat.c reverb.c reverse.c silence.c sinc.c skeleff.c \
-	speed.c splice.c stat.c stats.c stretch.c swap.c \
-	synth.c tempo.c tremolo.c trim.c upsample.c vad.c vol.c \
-	ignore-warning.h
+	remix.c repeat.c reverb.c reverse.c sdm.c sdm.h sdm_x86.h silence.c \
+	sinc.c skeleff.c speed.c splice.c stat.c stats.c stretch.c swap.c \
+	synth.c tempo.c tremolo.c trim.c upsample.c vad.c vol.c
 if HAVE_PNG
     libsox_la_SOURCES += spectrogram.c
 endif
@@ -95,7 +94,7 @@ libsox_la_LIBADD += @GOMP_LIBS@
 
 libsox_la_CFLAGS = @WARN_CFLAGS@
 libsox_la_LDFLAGS = @APP_LDFLAGS@ -version-info @SHLIB_VERSION@ \
-  -export-symbols-regex '^(sox_.*|lsx_(check_read_params|(close|open)_dllibrary|(debug(_more|_most)?|fail|report|warn)_impl|eof|fail_errno|filelength|find_(enum_(text|value)|file_extension)|getopt(_init)?|lpc10_(create_(de|en)coder_state|(de|en)code)|raw(read|write)|read(_b_buf|buf|chars)|realloc|rewind|seeki|sigfigs3p?|strcasecmp|tell|unreadb|write(b|_b_buf|buf|s)))$$'
+  -export-symbols-regex '^(sox_.*|lsx_(([cm]|re)alloc|check_read_params|(close|open)_dllibrary|(debug(_more|_most)?|fail|report|warn)_impl|eof|error|fail_errno|filelength|find_(enum_(text|value)|file_extension)|flush|getopt(_init)?|id3_read_tag|lpc10_(create_(de|en)coder_state|(de|en)code)|raw(read|write)|read(_b_buf|buf|chars)|rewind|seeki|sigfigs3p?|strcasecmp|strdup|tell|unreadb|write(b|_b_buf|buf|s)))$$'
 
 if HAVE_WIN32_LTDL
   libsox_la_SOURCES += win32-ltdl.c win32-ltdl.h
@@ -121,11 +120,17 @@ libsox_la_SOURCES += raw-fmt.c s1-fmt.c s2-fmt.c s3-fmt.c \
   lu-fmt.c 8svx.c aiff-fmt.c aifc-fmt.c au.c avr.c cdr.c cvsd-fmt.c \
   dvms-fmt.c dat.c hcom.c htk.c maud.c prc.c sf.c smp.c \
   sounder.c soundtool.c sphere.c tx16w.c voc.c vox-fmt.c ima-fmt.c adpcm.c adpcm.h \
-  ima_rw.c ima_rw.h wav.c wve.c xa.c nulfile.c f4-fmt.c f8-fmt.c gsrt.c
+  ima_rw.c ima_rw.h wav.c wve.c xa.c nulfile.c f4-fmt.c f8-fmt.c gsrt.c dsf.c \
+  dsdiff.c
 
 libsox_la_LIBADD += @GSM_LIBS@ @LIBGSM_LIBADD@
 libsox_la_LIBADD += @LPC10_LIBS@ @LIBLPC10_LIBADD@
 
+if HAVE_ID3TAG
+  libsox_la_SOURCES += id3.c id3.h
+  libsox_la_LIBADD += @ID3_LIBS@
+endif
+
 pkglib_LTLIBRARIES =
 
 include optional-fmts.am
diff --git a/src/adpcm.c b/src/adpcm.c
index 2e13867e..f64b7d5c 100644
--- a/src/adpcm.c
+++ b/src/adpcm.c
@@ -71,6 +71,11 @@ const short lsx_ms_adpcm_i_coef[7][2] = {
                         { 392,-232}
 };
 
+extern void *lsx_ms_adpcm_alloc(unsigned chans)
+{
+        return lsx_malloc(chans * sizeof(MsState_t));
+}
+
 static inline sox_sample_t AdpcmDecode(sox_sample_t c, MsState_t *state,
                                sox_sample_t sample1, sox_sample_t sample2)
 {
@@ -102,6 +107,7 @@ static inline sox_sample_t AdpcmDecode(sox_sample_t c, MsState_t *state,
 
 /* lsx_ms_adpcm_block_expand_i() outputs interleaved samples into one output buffer */
 const char *lsx_ms_adpcm_block_expand_i(
+        void *priv,
         unsigned chans,          /* total channels             */
         int nCoef,
         const short *coef,
@@ -113,7 +119,7 @@ const char *lsx_ms_adpcm_block_expand_i(
   const unsigned char *ip;
   unsigned ch;
   const char *errmsg = NULL;
-  MsState_t state[4];  /* One decompressor state for each channel */
+  MsState_t *state = priv;  /* One decompressor state for each channel */
 
   /* Read the four-byte header for each channel */
   ip = ibuff;
diff --git a/src/adpcm.h b/src/adpcm.h
index af4d6f08..db5cc615 100644
--- a/src/adpcm.h
+++ b/src/adpcm.h
@@ -29,8 +29,11 @@
 /* default coef sets */
 extern const short lsx_ms_adpcm_i_coef[7][2];
 
+extern void *lsx_ms_adpcm_alloc(unsigned chans);
+
 /* lsx_ms_adpcm_block_expand_i() outputs interleaved samples into one output buffer */
 extern const char *lsx_ms_adpcm_block_expand_i(
+	void *priv,
 	unsigned chans,          /* total channels             */
 	int nCoef,
 	const short *coef,
diff --git a/src/aiff.c b/src/aiff.c
index 240d2e1f..197ccd4e 100644
--- a/src/aiff.c
+++ b/src/aiff.c
@@ -16,6 +16,7 @@
 
 #include "sox_i.h"
 #include "aiff.h"
+#include "id3.h"
 
 #include <time.h>      /* for time stamping comments */
 #include <stdlib.h>
@@ -62,7 +63,6 @@ int lsx_aiffstartread(sox_format_t * ft)
   size_t ssndsize = 0;
   char *annotation;
   char *author;
-  char *comment = NULL;
   char *copyright;
   char *nametext;
 
@@ -270,6 +270,7 @@ int lsx_aiffstartread(sox_format_t * ft)
       free(annotation);
     }
     else if (strncmp(buf, "COMT", (size_t)4) == 0) {
+      char *comment = NULL;
       rc = commentChunk(&comment, "Comment:", ft);
       if (rc) {
         /* Fail already called in function */
@@ -306,6 +307,13 @@ int lsx_aiffstartread(sox_format_t * ft)
       }
       free(copyright);
     }
+    else if (strncmp(buf, "ID3 ", (size_t)4) == 0) {
+      off_t offs;
+      lsx_readdw(ft, &chunksize);
+      offs = lsx_tell(ft);
+      lsx_id3_read_tag(ft, 0);
+      lsx_seeki(ft, offs + chunksize, SEEK_SET);
+    }
     else {
       if (lsx_eof(ft))
         break;
@@ -314,6 +322,8 @@ int lsx_aiffstartread(sox_format_t * ft)
       lsx_readdw(ft, &chunksize);
       if (lsx_eof(ft))
         break;
+      /* account for padding after odd-sized chunks */
+      chunksize += chunksize & 1;
       /* Skip the chunk using lsx_readb() so we may read
          from a pipe */
       while (chunksize-- > 0) {
diff --git a/src/amr.h b/src/amr.h
index 900bb94e..2bfb643c 100644
--- a/src/amr.h
+++ b/src/amr.h
@@ -249,9 +249,7 @@ static int startwrite(sox_format_t * ft)
   if (open_library_result != SOX_SUCCESS)
     return open_library_result;
 
-#define IGNORE_WARNING \
   p->state = AMR_CALL_ENCODER(p, AmrOpencoreEncoderInit, AmrGp3EncoderInit, ());
-#include "ignore-warning.h"
   if (!p->state)
   {
       closelibrary(p);
@@ -271,9 +269,7 @@ static sox_bool encode_1_frame(sox_format_t * ft)
 {
   priv_t * p = (priv_t *)ft->priv;
   uint8_t coded[AMR_CODED_MAX];
-#define IGNORE_WARNING \
   int n = AMR_CALL_ENCODER(p, AmrOpencoreEncoderEncode, AmrGp3EncoderEncode, (p->state, p->mode, p->pcm, coded, 1));
-#include "ignore-warning.h"
   sox_bool result = lsx_writebuf(ft, coded, (size_t) (size_t) (unsigned)n) == (unsigned)n;
   if (!result)
     lsx_fail_errno(ft, errno, "write error");
diff --git a/src/dither.c b/src/dither.c
index 33516151..c6fe6a5a 100644
--- a/src/dither.c
+++ b/src/dither.c
@@ -20,6 +20,7 @@
 #endif
 
 #include "sox_i.h"
+#include "sdm.h"
 #include <assert.h>
 
 #undef RANQD1
@@ -263,6 +264,7 @@ typedef struct {
   double const  * coefs;
   sox_bool      dither_off;
   sox_effect_handler_flow flow;
+  sdm_t         *sdm;
 } priv_t;
 
 #define CONVOLVE _ _ _ _
@@ -292,6 +294,13 @@ typedef struct {
 #define N 20
 #include "dither.h"
 
+static int flow_sdm(sox_effect_t * effp, const sox_sample_t * ibuf,
+    sox_sample_t * obuf, size_t * isamp, size_t * osamp)
+{
+  priv_t * p = (priv_t *)effp->priv;
+  return sdm_process(p->sdm, ibuf, obuf, isamp, osamp);
+}
+
 static int flow_no_shape(sox_effect_t * effp, const sox_sample_t * ibuf,
     sox_sample_t * obuf, size_t * isamp, size_t * osamp)
 {
@@ -364,16 +373,16 @@ static int start(sox_effect_t * effp)
   if (effp->in_signal.precision <= p->prec || p->prec > 24)
     return SOX_EFF_NULL;   /* Dithering not needed at this resolution */
 
+  effp->out_signal.precision = p->prec;
+
   if (p->prec == 1) {
-    /* The general dither routines don't work in this case, so notify
-       user and leave it at that for now.
-       TODO: Some special-case treatment of 1-bit noise shaping will be
-         needed for meaningful DSD write support. */
-    lsx_warn("Dithering/noise-shaping to 1 bit is currently not supported.");
-    return SOX_EFF_NULL;
-  }
+    p->sdm = sdm_init(NULL, effp->in_signal.rate, 0, 0, 0);
+    if (!p->sdm)
+      return SOX_EOF;
 
-  effp->out_signal.precision = p->prec;
+    p->flow = flow_sdm;
+    return SOX_SUCCESS;
+  }
 
   p->flow = flow_no_shape;
   if (p->filter_name) {
@@ -418,6 +427,23 @@ static int flow(sox_effect_t * effp, const sox_sample_t * ibuf,
   return p->flow(effp, ibuf, obuf, isamp, osamp);
 }
 
+static int drain(sox_effect_t * effp, sox_sample_t * obuf, size_t * osamp)
+{
+  priv_t * p = (priv_t *)effp->priv;
+  if (p->sdm)
+    return sdm_drain(p->sdm, obuf, osamp);
+  *osamp = 0;
+  return SOX_SUCCESS;
+}
+
+static int stop(sox_effect_t * effp)
+{
+  priv_t * p = (priv_t *)effp->priv;
+  if (p->sdm)
+    sdm_close(p->sdm);
+  return SOX_SUCCESS;
+}
+
 sox_effect_handler_t const * lsx_dither_effect_fn(void)
 {
   static sox_effect_handler_t handler = {
@@ -430,7 +456,7 @@ sox_effect_handler_t const * lsx_dither_effect_fn(void)
     "\n           shibata, low-shibata, high-shibata."
     "\n  -a       Automatically turn on & off dithering as needed (use with caution!)"
     "\n  -p bits  Override the target sample precision",
-    SOX_EFF_PREC, getopts, start, flow, 0, 0, 0, sizeof(priv_t)
+    SOX_EFF_PREC, getopts, start, flow, drain, stop, 0, sizeof(priv_t)
   };
   return &handler;
 }
diff --git a/src/dop.c b/src/dop.c
new file mode 100644
index 00000000..2ae02c2b
--- /dev/null
+++ b/src/dop.c
@@ -0,0 +1,164 @@
+/* DSD over PCM
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include "sox_i.h"
+
+typedef struct dop {
+  sox_sample_t *buf;
+  unsigned marker;
+  unsigned pos;
+} dop_t;
+
+#define DOP_MARKER 0x05
+
+static int dop_start(sox_effect_t *eff)
+{
+  dop_t *p = eff->priv;
+
+  if (eff->in_signal.precision != 1) {
+    lsx_fail("1-bit input required");
+    return SOX_EOF;
+  }
+
+  if (eff->in_signal.rate != 16 * eff->out_signal.rate) {
+    lsx_fail("incorrect output rate, should be %.1fk",
+             eff->in_signal.rate / 16 / 1000);
+    return SOX_EOF;
+  }
+
+  eff->out_signal.precision = 24;
+
+  p->buf = lsx_calloc(eff->out_signal.channels, sizeof(*p->buf));
+  p->marker = DOP_MARKER;
+
+  return SOX_SUCCESS;
+}
+
+static unsigned dop_load_bits(const sox_sample_t *ibuf, unsigned step,
+                              unsigned pos, unsigned num)
+{
+  unsigned shift = 23 - pos;
+  unsigned buf = 0;
+
+  while (num--) {
+    unsigned bit = *ibuf > 0 ? 1 : 0;
+    buf |= bit << shift;
+    ibuf += step;
+    shift--;
+  }
+
+  return buf;
+}
+
+static int dop_flow(sox_effect_t *eff, const sox_sample_t *ibuf,
+                    sox_sample_t *obuf, size_t *isamp, size_t *osamp)
+{
+  dop_t *p = eff->priv;
+  unsigned channels = eff->in_signal.channels;
+  const sox_sample_t *in = ibuf;
+  sox_sample_t *out = obuf;
+  size_t ilen = *isamp / channels;
+  size_t olen = *osamp / channels;
+  unsigned i;
+
+  if (p->pos) {
+    size_t n = min(16 - p->pos, ilen);
+    for (i = 0; i < channels; i++)
+        p->buf[i] |= dop_load_bits(in + i, channels, p->pos, n);
+    in += n * channels;
+    ilen -= n;
+    p->pos += n;
+    if (p->pos == 16) {
+      for (i = 0; i < channels; i++) {
+        *out++ = p->buf[i] | p->marker << 24;
+        p->buf[i] = 0;
+      }
+      olen--;
+      p->marker ^= 0xff;
+      p->pos = 0;
+    }
+  }
+
+  while (olen && ilen >= 16) {
+    for (i = 0; i < channels; i++)
+      *out++ = dop_load_bits(in + i, channels, 0, 16) | p->marker << 24;
+    olen--;
+    in += 16 * channels;
+    ilen -= 16;
+    p->marker ^= 0xff;
+  }
+
+  if (olen && ilen < 16) {
+    size_t n = min(16 - p->pos, ilen);
+    for (i = 0; i < channels; i++)
+      p->buf[i] |= dop_load_bits(in + i, channels, p->pos, n);
+    in += n * channels;
+    ilen -= n;
+    p->pos += n;
+    if (p->pos == 16) {
+      for (i = 0; i < channels; i++) {
+        *out++ = p->buf[i] | p->marker << 24;
+        p->buf[i] = 0;
+      }
+      olen--;
+      p->marker ^= 0xff;
+      p->pos = 0;
+    }
+  }
+
+  *isamp = in - ibuf;
+  *osamp = out - obuf;
+
+  return SOX_SUCCESS;
+}
+
+static int dop_drain(sox_effect_t *eff, sox_sample_t *obuf, size_t *osamp)
+{
+  dop_t *p = eff->priv;
+  unsigned i;
+
+  if (p->pos) {
+    unsigned silence = (0xffff00 >> p->pos) & 0x696900;
+    for (i = 0; i < eff->in_signal.channels; i++)
+      *obuf++ = p->buf[i] | p->marker << 24 | silence;
+    p->pos = 0;
+    *osamp = i;
+  } else {
+    *osamp = 0;
+  }
+
+  return SOX_SUCCESS;
+}
+
+static int dop_stop(sox_effect_t *eff)
+{
+  dop_t *p = eff->priv;
+  free(p->buf);
+  return SOX_SUCCESS;
+}
+
+const sox_effect_handler_t *lsx_dop_effect_fn(void)
+{
+  static sox_effect_handler_t handler = {
+    "dop", NULL,
+    SOX_EFF_MCHAN | SOX_EFF_PREC | SOX_EFF_RATE,
+    NULL, dop_start, dop_flow, dop_drain, dop_stop, NULL,
+    sizeof(dop_t),
+  };
+  return &handler;
+}
diff --git a/src/dsdiff.c b/src/dsdiff.c
new file mode 100644
index 00000000..9fc599aa
--- /dev/null
+++ b/src/dsdiff.c
@@ -0,0 +1,555 @@
+/* DSDIFF file support
+ *
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/* File format specification available at
+ * http://dsd-guide.com/sites/default/files/white-papers/DSDIFF_1.5_Spec.pdf
+ */
+
+#include "sox_i.h"
+
+struct dsdiff {
+	uint64_t data_size;
+	uint8_t *buf;
+	uint32_t bit_pos;
+};
+
+#define ID(a, b, c, d) ((a) << 24 | (b) << 16 | (c) << 8 | (d))
+
+static int dff_startread(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+	uint32_t ckid;
+	uint32_t cktype;
+	uint64_t cksize;
+	uint64_t f8size;
+	uint32_t fver;
+	uint64_t spos, epos;
+	uint32_t sample_rate;
+	uint16_t num_channels;
+
+	if (lsx_readdw(ft, &ckid) || ckid != ID('F', 'R', 'M', '8')) {
+		lsx_fail_errno(ft, SOX_EHDR, "FRM8 tag not found");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readqw(ft, &f8size)) {
+		lsx_fail_errno(ft, SOX_EHDR, "error reading chunk size");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readdw(ft, &cktype) || cktype != ID('D', 'S', 'D', ' ')) {
+		lsx_fail_errno(ft, SOX_EHDR, "DSD tag not found");
+		return SOX_EHDR;
+	}
+
+	do {
+		if (lsx_readdw(ft, &ckid) || lsx_readqw(ft, &cksize)) {
+			lsx_fail_errno(ft, SOX_EHDR, "read error");
+			return SOX_EHDR;
+		}
+
+		spos = lsx_tell(ft);
+
+		switch (ckid) {
+		case ID('F', 'V', 'E', 'R'):
+			if (cksize != 4)
+				return SOX_EHDR;
+			if (lsx_readdw(ft, &fver))
+				return SOX_EHDR;
+			if (fver >> 24 != 1) {
+				lsx_fail_errno(ft, SOX_EHDR, "unknown version");
+				return SOX_EHDR;
+			}
+			break;
+
+		case ID('P', 'R', 'O', 'P'):
+			if (cksize < 4)
+				return SOX_EHDR;
+			if (lsx_readdw(ft, &cktype))
+				return SOX_EHDR;
+			if (cktype == ID('S', 'N', 'D', ' '))
+				cksize = 4;
+			break;
+
+		case ID('F', 'S', ' ', ' '):
+			if (cksize < 4)
+				return SOX_EHDR;
+			if (lsx_readdw(ft, &sample_rate))
+				return SOX_EHDR;
+			break;
+
+		case ID('C', 'H', 'N', 'L'):
+			if (cksize < 4)
+				return SOX_EHDR;
+			if (lsx_readw(ft, &num_channels))
+				return SOX_EHDR;
+			break;
+
+		case ID('C', 'M', 'P', 'R'):
+			if (cksize < 4)
+				return SOX_EHDR;
+			if (lsx_readdw(ft, &cktype))
+				return SOX_EHDR;
+			if (cktype != ID('D', 'S', 'D', ' ')) {
+				lsx_fail_errno(ft, SOX_EHDR,
+					       "unsupported compression");
+				return SOX_EHDR;
+			}
+			break;
+
+		case ID('D', 'S', 'D', ' '):
+			if (cksize < 8)
+				return SOX_EHDR;
+			dff->data_size = cksize;
+			cksize = 0;
+			break;
+		}
+
+		cksize += cksize & 1;
+		epos = lsx_tell(ft);
+		if (epos != spos + cksize)
+			lsx_seeki(ft, (off_t)(spos + cksize - epos), SEEK_CUR);
+	} while (cksize && epos < f8size);
+
+	if (!sample_rate || !num_channels || !dff->data_size) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid file header");
+		return SOX_EHDR;
+	}
+
+	if (ckid != ID('D', 'S', 'D', ' ')) {
+		lsx_fail_errno(ft, SOX_EHDR, "unsupported data type");
+		return SOX_EHDR;
+	}
+
+	dff->buf = lsx_malloc(num_channels);
+	if (!dff->buf)
+		return SOX_ENOMEM;
+
+	ft->data_start = lsx_tell(ft);
+
+	ft->signal.rate = sample_rate;
+	ft->signal.channels = num_channels;
+	ft->signal.precision = 1;
+	ft->signal.length = dff->data_size * 8;
+
+	ft->encoding.encoding = SOX_ENCODING_DSD;
+	ft->encoding.bits_per_sample = 1;
+
+	return SOX_SUCCESS;
+}
+
+static size_t dff_read(sox_format_t *ft, sox_sample_t *buf, size_t len)
+{
+	struct dsdiff *dff = ft->priv;
+	size_t nc = ft->signal.channels;
+	size_t rsamp = 0;
+	unsigned i, j;
+
+	len /= nc;
+
+	while (len >= 8) {
+		unsigned bits = 8 - dff->bit_pos;
+
+		if (lsx_read_b_buf(ft, dff->buf, nc) < nc)
+			return rsamp * nc;
+
+		for (i = 0; i < nc; i++) {
+			unsigned d = dff->buf[i] << dff->bit_pos;
+
+			for (j = 0; j < 8; j++) {
+				buf[i + j * nc] = d & 128 ?
+					SOX_SAMPLE_MAX : -SOX_SAMPLE_MAX;
+				d <<= 1;
+			}
+		}
+
+		dff->bit_pos = 0;
+		buf += bits * nc;
+		rsamp += bits;
+		len -= bits;
+	}
+
+	return rsamp * nc;
+}
+
+static int dff_seek(sox_format_t * ft, sox_uint64_t offset)
+{
+	struct dsdiff *dff = ft->priv;
+	uint64_t byte_offset = offset / 8;
+	uint64_t data_offset = byte_offset * ft->signal.channels;
+	int err;
+
+	err = lsx_seeki(ft, ft->data_start + data_offset, SEEK_SET);
+	if (err != SOX_SUCCESS)
+		return err;
+
+	dff->bit_pos = offset % 8;
+
+	return SOX_SUCCESS;
+}
+
+static int dff_stopread(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+
+	free(dff->buf);
+
+	return SOX_SUCCESS;
+}
+
+#define DFF_MAX_CHANNELS	1000
+#define DFF_CMPR_NAME		"not compressed"
+
+static int dff_writeheader(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+	unsigned chnl_size = 2 + 4 * ft->signal.channels;
+	unsigned cmpr_size = 4 + 1 + sizeof(DFF_CMPR_NAME);
+	unsigned prop_size =
+		4 +			/* SND */
+		12 + 4 +		/* FS */
+		12 + chnl_size +
+		12 + cmpr_size;
+	uint64_t frm8_size =
+		4 +			/* DSD */
+		12 + 4 +		/* FVER */
+		12 + prop_size +
+		12 + dff->data_size;
+
+	if (lsx_writedw(ft, ID('F', 'R', 'M', '8')) ||
+	    lsx_writeqw(ft, dff->data_size ?
+			frm8_size + dff->data_size : SOX_UNKNOWN_LEN) ||
+            lsx_writedw(ft, ID('D', 'S', 'D', ' ')))
+		return SOX_EOF;
+
+	if (lsx_writedw(ft, ID('F', 'V', 'E', 'R')) ||
+	    lsx_writeqw(ft, 4) ||
+            lsx_writedw(ft, 0x01050000))
+		return SOX_EOF;
+
+	if (lsx_writedw(ft, ID('P', 'R', 'O', 'P')) ||
+	    lsx_writeqw(ft, prop_size) ||
+	    lsx_writedw(ft, ID('S', 'N', 'D', ' ')))
+		return SOX_EOF;
+
+	if (lsx_writedw(ft, ID('F', 'S', ' ', ' ')) ||
+	    lsx_writeqw(ft, 4) ||
+            lsx_writedw(ft, ft->signal.rate))
+		return SOX_EOF;
+
+	if (lsx_writedw(ft, ID('C', 'H', 'N', 'L')) ||
+            lsx_writeqw(ft, chnl_size) ||
+            lsx_writew(ft, ft->signal.channels))
+		return SOX_EOF;
+
+	if (ft->signal.channels == 2) {
+		if (lsx_writedw(ft, ID('S', 'L', 'F', 'T')) ||
+		    lsx_writedw(ft, ID('S', 'R', 'G', 'T')))
+			return SOX_EOF;
+	} else {
+		char ch[8];
+		unsigned i;
+
+		for (i = 0; i < ft->signal.channels; i++) {
+			snprintf(ch, sizeof(ch), "C%03d", i);
+			if (lsx_writedw(ft, ID(ch[0], ch[1], ch[2], ch[3])))
+				return SOX_EOF;
+		}
+	}
+
+	if (lsx_writedw(ft, ID('C', 'M', 'P', 'R')) ||
+	    lsx_writeqw(ft, cmpr_size) ||
+	    lsx_writedw(ft, ID('D', 'S', 'D', ' ')) ||
+	    lsx_writeb(ft, sizeof(DFF_CMPR_NAME)) ||
+	    lsx_writes(ft, DFF_CMPR_NAME) ||
+	    lsx_writeb(ft, 0))
+		return SOX_EOF;
+
+	if (lsx_writedw(ft, ID('D', 'S', 'D', ' ')) ||
+	    lsx_writeqw(ft, dff->data_size ? dff->data_size : SOX_UNKNOWN_LEN))
+		return SOX_EOF;
+
+	return SOX_SUCCESS;
+}
+
+static int dff_startwrite(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+
+	if (ft->signal.channels > DFF_MAX_CHANNELS) {
+		lsx_fail_errno(ft, SOX_EOF, "too many channels");
+		return SOX_EOF;
+	}
+
+	dff->data_size = 0;
+	dff->buf = lsx_malloc(ft->signal.channels);
+	if (!dff->buf)
+		return SOX_ENOMEM;
+
+	return dff_writeheader(ft);
+}
+
+static int dff_write_buf(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+	size_t wlen = ft->signal.channels;
+
+	if (lsx_write_b_buf(ft, dff->buf, wlen) < wlen)
+		return SOX_EOF;
+
+	memset(dff->buf, 0, wlen);
+
+	return SOX_SUCCESS;
+}
+
+static void dff_write_bits(struct dsdiff *dff, const sox_sample_t *buf,
+                           unsigned channels, unsigned start_bit, unsigned len)
+{
+	unsigned i, j;
+
+	for (i = 0; i < channels; i++) {
+		unsigned d = dff->buf[i];
+
+		for (j = 0; j < len; j++) {
+			d |= (buf[i + j * channels] > 0) <<
+				(7 - j - start_bit);
+		}
+
+		dff->buf[i] = d;
+	}
+}
+
+static size_t dff_write(sox_format_t *ft, const sox_sample_t *buf, size_t len)
+{
+	struct dsdiff *dff = ft->priv;
+	unsigned nchan = ft->signal.channels;
+	size_t wsamp = 0;
+
+	len /= nchan;
+
+	if (dff->bit_pos) {
+		unsigned pre = min(len, 8 - dff->bit_pos);
+
+		dff_write_bits(dff, buf, nchan, dff->bit_pos, pre);
+
+		dff->bit_pos += pre;
+		buf += pre * nchan;
+		wsamp += pre;
+		len -= pre;
+
+		if (dff->bit_pos == 8) {
+			dff->bit_pos = 0;
+
+			if (dff_write_buf(ft))
+				return 0;
+
+			dff->data_size += ft->signal.channels;
+		}
+	}
+
+	while (len >= 8) {
+		dff_write_bits(dff, buf, nchan, 0, 8);
+
+		buf += 8 * nchan;
+		wsamp += 8;
+		len -= 8;
+
+		if (dff_write_buf(ft))
+			return wsamp * nchan;
+
+		dff->data_size += ft->signal.channels;
+	}
+
+	if (len) {
+		dff_write_bits(dff, buf, nchan, 0, len);
+
+		dff->bit_pos = len;
+		wsamp += len;
+	}
+
+	return wsamp * nchan;
+}
+
+static int dff_stopwrite(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+	unsigned i;
+	int err = SOX_SUCCESS;
+
+	if (dff->bit_pos) {
+		unsigned silence = 0x69 & (0xff >> dff->bit_pos);
+		for (i = 0; i < ft->signal.channels; i++)
+			dff->buf[i] |= silence;
+
+		err = dff_write_buf(ft);
+	}
+
+	free(dff->buf);
+
+	if (err)
+		return err;
+
+	if (lsx_seeki(ft, 0, SEEK_SET)) {
+		lsx_fail_errno(ft, SOX_EOF,
+			       "error rewinding output to update header");
+		return SOX_EOF;
+	}
+
+	return dff_writeheader(ft);
+}
+
+LSX_FORMAT_HANDLER(dsdiff)
+{
+	static char const * const names[] = { "dff", NULL };
+	static unsigned const write_encodings[] = {
+		SOX_ENCODING_DSD, 1, 0,
+		0
+        };
+	static sox_format_handler_t const handler = {
+		SOX_LIB_VERSION_CODE,
+		"Direct Stream Digital Interchange File Format (DSDIFF)",
+		names, SOX_FILE_BIG_END,
+		dff_startread, dff_read, dff_stopread,
+		dff_startwrite, dff_write, dff_stopwrite,
+		dff_seek, write_encodings, NULL,
+		sizeof(struct dsdiff)
+	};
+	return &handler;
+}
+
+/*
+ * The WSD format uses the same data layout as DSDIFF with a different
+ * file header.
+ *
+ * http://1bitcons.acoust.ias.sci.waseda.ac.jp/pdf/wsd_file_format_ver1_1.pdf
+ */
+
+#define WSD_MAGIC ID('1', 'b', 'i', 't')
+
+static int wsd_startread(sox_format_t *ft)
+{
+	struct dsdiff *dff = ft->priv;
+	uint32_t magic;
+	uint32_t res32;
+	uint8_t version;
+	uint8_t res8;
+	uint32_t file_sz_l;
+	uint32_t file_sz_h;
+	uint64_t file_sz;
+	uint32_t text_sp;
+	uint32_t data_sp;
+	uint32_t pb_tm;
+	uint32_t fs;
+	uint8_t ch_n;
+	uint32_t ch_asn;
+	uint32_t emph;
+
+	if (lsx_readdw(ft, &magic) || magic != WSD_MAGIC) {
+		lsx_fail_errno(ft, SOX_EHDR, "signature not found");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readdw(ft, &res32) || res32 != 0 ||
+	    lsx_readb(ft, &version) ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readdw(ft, &file_sz_l) ||
+	    lsx_readdw(ft, &file_sz_h) ||
+	    lsx_readdw(ft, &text_sp) ||
+	    lsx_readdw(ft, &data_sp) ||
+	    lsx_readdw(ft, &res32) || res32 != 0) {
+		lsx_fail_errno(ft, SOX_EHDR, "error reading header");
+		return SOX_EHDR;
+	}
+
+	if (version != 0x10 && version != 0x11) {
+		lsx_fail_errno(ft, SOX_EHDR, "unknown format version 0x%02x",
+			       version);
+		return SOX_EHDR;
+	}
+
+	if (text_sp != 0x80 || data_sp != 0x800) {
+		lsx_fail_errno(ft, SOX_EHDR, "incorrect data offset");
+		return SOX_EHDR;
+	}
+
+	file_sz = (uint64_t)file_sz_h << 32 | file_sz_l;
+
+	if (file_sz <= data_sp) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid file size");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readdw(ft, &pb_tm) ||
+	    lsx_readdw(ft, &fs) ||
+	    lsx_readdw(ft, &res32) || res32 != 0 ||
+	    lsx_readb(ft, &ch_n) ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readb(ft, &res8) || res8 != 0 ||
+	    lsx_readdw(ft, &ch_asn) ||
+	    lsx_readdw(ft, &res32) || res32 != 0 ||
+	    lsx_readdw(ft, &res32) || res32 != 0 ||
+	    lsx_readdw(ft, &res32) || res32 != 0 ||
+	    lsx_readdw(ft, &emph) ||
+	    lsx_readdw(ft, &res32) || res32 != 0) {
+		lsx_fail_errno(ft, SOX_EHDR, "error reading header");
+		return SOX_EHDR;
+	}
+
+	if (emph) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid emphasis value");
+		return SOX_EHDR;
+	}
+
+	if (lsx_seeki(ft, data_sp, SEEK_SET))
+		return SOX_EOF;
+
+	dff->buf = lsx_malloc(ch_n);
+	if (!dff->buf)
+		return SOX_ENOMEM;
+
+	ft->data_start = data_sp;
+
+	ft->signal.rate = fs;
+	ft->signal.channels = ch_n;
+	ft->signal.precision = 1;
+	ft->signal.length = (file_sz - data_sp) * 8;
+
+	ft->encoding.encoding = SOX_ENCODING_DSD;
+	ft->encoding.bits_per_sample = 1;
+
+	return SOX_SUCCESS;
+}
+
+LSX_FORMAT_HANDLER(wsd)
+{
+	static char const * const names[] = { "wsd", NULL };
+	static sox_format_handler_t const handler = {
+		SOX_LIB_VERSION_CODE,
+		"Wideband Single-bit Data (WSD)",
+		names, SOX_FILE_BIG_END,
+		wsd_startread, dff_read, dff_stopread,
+		NULL, NULL, NULL,
+		dff_seek, NULL, NULL,
+		sizeof(struct dsdiff)
+	};
+	return &handler;
+}
diff --git a/src/dsf.c b/src/dsf.c
new file mode 100644
index 00000000..f49f5b7c
--- /dev/null
+++ b/src/dsf.c
@@ -0,0 +1,423 @@
+/* DSF file support
+ *
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/* File format specification available at
+ * http://dsd-guide.com/sites/default/files/white-papers/DSFFileFormatSpec_E.pdf
+ */
+
+#include "sox_i.h"
+#include "id3.h"
+
+struct dsf {
+	uint64_t file_size;
+	uint64_t metadata;
+	uint32_t version;
+	uint32_t format_id;
+	uint32_t chan_type;
+	uint32_t chan_num;
+	uint32_t sfreq;
+	uint32_t bps;
+	uint64_t scount;
+	uint32_t block_size;
+
+	uint32_t block_start;
+	uint32_t block_pos;
+	uint32_t bit_pos;
+	uint8_t *block;
+	uint64_t read_samp;
+};
+
+#define TAG(a, b, c, d) ((a) | (b) << 8 | (c) << 16 | (d) << 24)
+
+#define DSF_TAG  TAG('D', 'S', 'D', ' ')
+#define FMT_TAG  TAG('f', 'm', 't', ' ')
+#define DATA_TAG TAG('d', 'a', 't', 'a')
+
+#define HEADER_SIZE (28 + 52 + 12)
+
+static int dsf_startread(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+	uint32_t magic;
+	uint64_t csize;
+	uint32_t v;
+
+	if (lsx_readdw(ft, &magic) || magic != DSF_TAG) {
+		lsx_fail_errno(ft, SOX_EHDR, "DSF signature not found");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readqw(ft, &csize) || csize != 28) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid DSD chunk size");
+		return SOX_EHDR;
+	}
+
+	lsx_readqw(ft, &dsf->file_size);
+	lsx_readqw(ft, &dsf->metadata);
+
+	if (lsx_readdw(ft, &magic) || magic != FMT_TAG) {
+		lsx_fail_errno(ft, SOX_EHDR, "fmt chunk not found");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readqw(ft, &csize) || csize != 52) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid fmt chunk size");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readdw(ft, &dsf->version)   ||
+	    lsx_readdw(ft, &dsf->format_id) ||
+	    lsx_readdw(ft, &dsf->chan_type) ||
+	    lsx_readdw(ft, &dsf->chan_num)  ||
+	    lsx_readdw(ft, &dsf->sfreq)     ||
+	    lsx_readdw(ft, &dsf->bps)       ||
+	    lsx_readqw(ft, &dsf->scount)    ||
+	    lsx_readdw(ft, &dsf->block_size))
+		return SOX_EHDR;
+
+	if (lsx_readdw(ft, &v) || v) /* reserved */
+		return SOX_EHDR;
+
+	if (lsx_readdw(ft, &magic) || magic != DATA_TAG) {
+		lsx_fail_errno(ft, SOX_EHDR, "data chunk not found");
+		return SOX_EHDR;
+	}
+
+	if (lsx_readqw(ft, &csize) ||
+	    csize < 12 + dsf->block_size * dsf->chan_num) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid data chunk size");
+		return SOX_EHDR;
+	}
+
+	if (dsf->version != 1) {
+		lsx_fail_errno(ft, SOX_EHDR, "unknown format version %d",
+			       dsf->version);
+		return SOX_EHDR;
+	}
+
+	if (dsf->format_id != 0) {
+		lsx_fail_errno(ft, SOX_EFMT, "unknown format ID %d",
+			       dsf->format_id);
+		return SOX_EFMT;
+	}
+
+	if (dsf->chan_num < 1 || dsf->chan_num > 6) {
+		lsx_fail_errno(ft, SOX_EHDR, "invalid channel count %d",
+			       dsf->chan_num);
+		return SOX_EHDR;
+	}
+
+	if (dsf->bps != 1) {
+		lsx_fail_errno(ft, SOX_EFMT, "unsupported bit depth %d",
+			       dsf->bps);
+		return SOX_EFMT;
+	}
+
+	dsf->block = lsx_calloc(dsf->chan_num, (size_t)dsf->block_size);
+	if (!dsf->block)
+		return SOX_ENOMEM;
+
+	ft->data_start = lsx_tell(ft);
+
+	if (dsf->metadata && ft->seekable) {
+		if (!lsx_seeki(ft, dsf->metadata, SEEK_SET))
+			lsx_id3_read_tag(ft, sox_false);
+		lsx_seeki(ft, ft->data_start, SEEK_SET);
+	}
+
+	dsf->block_pos = dsf->block_size;
+	dsf->block_start = 0;
+
+	ft->signal.rate = dsf->sfreq;
+	ft->signal.channels = dsf->chan_num;
+	ft->signal.precision = 1;
+	ft->signal.length = dsf->scount * dsf->chan_num;
+
+	ft->encoding.encoding = SOX_ENCODING_DSD;
+	ft->encoding.bits_per_sample = 1;
+
+	return SOX_SUCCESS;
+}
+
+static void dsf_read_bits(struct dsf *dsf, sox_sample_t *buf,
+                          unsigned start, unsigned len)
+{
+	uint8_t *dsd = dsf->block + dsf->block_pos;
+	unsigned i, j;
+
+	for (i = 0; i < dsf->chan_num; i++) {
+		unsigned d = dsd[i * dsf->block_size] >> start;
+
+		for (j = 0; j < len; j++) {
+			buf[i + j * dsf->chan_num] = d & 1 ?
+				SOX_SAMPLE_MAX : -SOX_SAMPLE_MAX;
+			d >>= 1;
+		}
+	}
+}
+
+static size_t dsf_read(sox_format_t *ft, sox_sample_t *buf, size_t len)
+{
+	struct dsf *dsf = ft->priv;
+	uint64_t samp_left = dsf->scount - dsf->read_samp;
+	size_t rsamp = 0;
+
+	len /= dsf->chan_num;
+	len = min(len, samp_left);
+
+	while (len >= 8) {
+		unsigned bits = 8 - dsf->bit_pos;
+
+		if (dsf->block_pos >= dsf->block_size) {
+			size_t rlen = dsf->chan_num * dsf->block_size;
+			if (lsx_read_b_buf(ft, dsf->block, rlen) < rlen)
+				return rsamp * dsf->chan_num;
+			dsf->block_pos = dsf->block_start;
+			dsf->block_start = 0;
+		}
+
+		dsf_read_bits(dsf, buf, dsf->bit_pos, bits);
+		buf += bits * dsf->chan_num;
+		dsf->block_pos++;
+		dsf->bit_pos = 0;
+		rsamp += bits;
+		len -= bits;
+	}
+
+	if (len && samp_left < 8) {
+		dsf_read_bits(dsf, buf, 0, len);
+		rsamp += len;
+	}
+
+	dsf->read_samp += rsamp;
+
+	return rsamp * dsf->chan_num;
+}
+
+static int dsf_seek(sox_format_t * ft, sox_uint64_t offset)
+{
+	struct dsf *dsf = ft->priv;
+	uint64_t byte_offset;
+	uint64_t block_num;
+	unsigned block_start;
+        off_t data_offs;
+	int err;
+
+	if (offset > dsf->scount)
+		return SOX_EOF;
+
+	byte_offset = offset / 8;
+	block_num = byte_offset / dsf->block_size;
+	block_start = byte_offset % dsf->block_size;
+	data_offs = dsf->chan_num * dsf->block_size * block_num;
+
+	err = lsx_seeki(ft, ft->data_start + data_offs, SEEK_SET);
+	if (err != SOX_SUCCESS)
+		return err;
+
+	dsf->block_pos = dsf->block_size;
+	dsf->block_start = block_start;;
+	dsf->bit_pos = offset % 8;
+	dsf->read_samp = offset;
+
+	return SOX_SUCCESS;
+}
+
+static int dsf_stopread(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+
+	free(dsf->block);
+
+	return SOX_SUCCESS;
+}
+
+static int dsf_writeheader(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+	uint64_t data_size = dsf->file_size ? dsf->file_size - HEADER_SIZE : 0;
+
+	if (lsx_writedw(ft, DSF_TAG) ||
+	    lsx_writeqw(ft, (uint64_t)28) ||
+	    lsx_writeqw(ft, dsf->file_size) ||
+	    lsx_writeqw(ft, dsf->metadata) ||
+	    lsx_writedw(ft, FMT_TAG) ||
+	    lsx_writeqw(ft, (uint64_t)52) ||
+	    lsx_writedw(ft, dsf->version) ||
+	    lsx_writedw(ft, dsf->format_id) ||
+	    lsx_writedw(ft, dsf->chan_type) ||
+	    lsx_writedw(ft, dsf->chan_num) ||
+	    lsx_writedw(ft, dsf->sfreq) ||
+	    lsx_writedw(ft, dsf->bps) ||
+	    lsx_writeqw(ft, dsf->scount ? dsf->scount : SOX_UNKNOWN_LEN) ||
+	    lsx_writedw(ft, dsf->block_size) ||
+	    lsx_writedw(ft, 0) || /* reserved */
+	    lsx_writedw(ft, DATA_TAG) ||
+	    lsx_writeqw(ft, data_size + 12))
+		return SOX_EOF;
+
+	return SOX_SUCCESS;
+}
+
+static int dsf_startwrite(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+
+	dsf->version = 1;
+	dsf->format_id = 0;
+	dsf->chan_type = ft->signal.channels + (ft->signal.channels > 4);
+	dsf->chan_num = ft->signal.channels;
+	dsf->sfreq = ft->signal.rate;
+	dsf->bps = ft->encoding.bits_per_sample;
+	dsf->block_size = 4096;
+
+	dsf->block = lsx_calloc(dsf->chan_num, (size_t)dsf->block_size);
+	if (!dsf->block)
+		return SOX_ENOMEM;
+
+	return dsf_writeheader(ft);
+}
+
+static int dsf_write_buf(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+
+	if (dsf->block_pos == dsf->block_size) {
+		size_t wlen = dsf->chan_num * dsf->block_size;
+		if (lsx_write_b_buf(ft, dsf->block, wlen) < wlen)
+			return SOX_EOF;
+		dsf->block_pos = 0;
+		memset(dsf->block, 0, wlen);
+	}
+
+	return SOX_SUCCESS;
+}
+
+static void dsf_write_bits(struct dsf *dsf, const sox_sample_t *buf,
+			   unsigned start_bit, unsigned len)
+{
+	uint8_t *dsd = dsf->block + dsf->block_pos;
+	unsigned i, j;
+
+	for (i = 0; i < dsf->chan_num; i++) {
+		unsigned d = dsd[i * dsf->block_size];
+
+		for (j = 0; j < len; j++) {
+			d |= (buf[i + j * dsf->chan_num] > 0) <<
+				(j + start_bit);
+		}
+
+		dsd[i * dsf->block_size] = d;
+	}
+}
+
+static size_t dsf_write(sox_format_t *ft, const sox_sample_t *buf, size_t len)
+{
+	struct dsf *dsf = ft->priv;
+	unsigned nchan = dsf->chan_num;
+	size_t wsamp = 0;
+
+	len /= nchan;
+
+	if (dsf->bit_pos) {
+		unsigned pre = min(len, 8 - dsf->bit_pos);
+
+		dsf_write_bits(dsf, buf, dsf->bit_pos, pre);
+		buf += pre * nchan;
+		wsamp += pre;
+		len -= pre;
+		dsf->bit_pos += pre;
+
+		if (dsf->bit_pos == 8) {
+			dsf->block_pos++;
+			dsf->bit_pos = 0;
+			if (dsf_write_buf(ft))
+				return 0;
+		}
+	}
+
+	while (len >= 8) {
+		dsf_write_bits(dsf, buf, 0, 8);
+		buf += 8 * nchan;
+		dsf->block_pos++;
+		wsamp += 8;
+		len -= 8;
+
+		if (dsf_write_buf(ft))
+			return wsamp * nchan;
+	}
+
+	if (len) {
+		dsf_write_bits(dsf, buf, 0, (unsigned)len);
+		wsamp += len;
+		dsf->bit_pos = len;
+	}
+
+	dsf->scount += wsamp;
+
+	return wsamp * nchan;
+}
+
+static int dsf_stopwrite(sox_format_t *ft)
+{
+	struct dsf *dsf = ft->priv;
+	int err = SOX_SUCCESS;
+
+	if (dsf->bit_pos)
+		dsf->block_pos++;
+
+	if (dsf->block_pos) {
+		size_t wlen = dsf->chan_num * dsf->block_size;
+		if (lsx_write_b_buf(ft, dsf->block, wlen) < wlen)
+			err = SOX_EOF;
+	}
+
+	free(dsf->block);
+
+	if (err)
+		return err;
+
+	dsf->file_size = lsx_tell(ft);
+
+	if (lsx_seeki(ft, (off_t)0, SEEK_SET)) {
+		lsx_fail_errno(ft, SOX_EOF,
+			       "error rewinding output to update header");
+		return SOX_EOF;
+	}
+
+	return dsf_writeheader(ft);
+}
+
+LSX_FORMAT_HANDLER(dsf)
+{
+	static char const * const names[] = { "dsf", NULL };
+	static unsigned const write_encodings[] = {
+		SOX_ENCODING_DSD, 1, 0,
+		0 };
+	static sox_format_handler_t const handler = {
+		SOX_LIB_VERSION_CODE,
+		"Container for DSD data",
+		names, SOX_FILE_LIT_END,
+		dsf_startread, dsf_read, dsf_stopread,
+		dsf_startwrite, dsf_write, dsf_stopwrite,
+		dsf_seek, write_encodings, NULL,
+		sizeof(struct dsf)
+	};
+	return &handler;
+}
diff --git a/src/effects.h b/src/effects.h
index 450a5c2c..9e6ba100 100644
--- a/src/effects.h
+++ b/src/effects.h
@@ -32,6 +32,7 @@
   EFFECT(dft_filter) /* abstract */
   EFFECT(dither)
   EFFECT(divide)
+  EFFECT(dop)
   EFFECT(downsample)
   EFFECT(earwax)
   EFFECT(echo)
@@ -66,6 +67,7 @@
   EFFECT(reverb)
   EFFECT(reverse)
   EFFECT(riaa)
+  EFFECT(sdm)
   EFFECT(silence)
   EFFECT(sinc)
 #ifdef HAVE_PNG
diff --git a/src/example4.c b/src/example4.c
old mode 100755
new mode 100644
diff --git a/src/fap.c b/src/fap.c
index cc32a1a1..6cb25218 100644
--- a/src/fap.c
+++ b/src/fap.c
@@ -26,7 +26,7 @@ LSX_FORMAT_HANDLER(fap)
   static sox_format_handler_t handler;
   handler = *lsx_sndfile_format_fn();
   handler.description =
-    "Ensoniq PARIS digitial audio editing system (little endian)";
+    "Ensoniq PARIS digital audio editing system (little endian)";
   handler.names = names;
   handler.write_formats = write_encodings;
   return &handler;
diff --git a/src/flac.c b/src/flac.c
index 0d7829ec..07f45c1b 100644
--- a/src/flac.c
+++ b/src/flac.c
@@ -119,9 +119,10 @@ static void decoder_metadata_callback(FLAC__StreamDecoder const * const flac, FL
     p->total_samples = metadata->data.stream_info.total_samples;
   }
   else if (metadata->type == FLAC__METADATA_TYPE_VORBIS_COMMENT) {
+    const FLAC__StreamMetadata_VorbisComment *vc = &metadata->data.vorbis_comment;
     size_t i;
 
-    if (metadata->data.vorbis_comment.num_comments == 0)
+    if (vc->num_comments == 0)
       return;
 
     if (ft->oob.comments != NULL) {
@@ -129,8 +130,9 @@ static void decoder_metadata_callback(FLAC__StreamDecoder const * const flac, FL
       return;
     }
 
-    for (i = 0; i < metadata->data.vorbis_comment.num_comments; ++i)
-      sox_append_comment(&ft->oob.comments, (char const *) metadata->data.vorbis_comment.comments[i].entry);
+    for (i = 0; i < vc->num_comments; ++i)
+      if (vc->comments[i].entry)
+        sox_append_comment(&ft->oob.comments, (char const *) vc->comments[i].entry);
   }
 }
 
diff --git a/src/formats.c b/src/formats.c
index 724a4cda..4bd4ea5e 100644
--- a/src/formats.c
+++ b/src/formats.c
@@ -145,6 +145,7 @@ static sox_encodings_info_t const s_sox_encodings_info[] = {
   {sox_encodings_lossy2, "CVSD"         , "CVSD"},
   {sox_encodings_lossy2, "LPC10"        , "LPC10"},
   {sox_encodings_lossy2, "Opus"         , "Opus"},
+  {sox_encodings_none  , "DSD"          , "Direct Stream Digital"},
 };
 
 assert_static(array_length(s_sox_encodings_info) == SOX_ENCODINGS,
@@ -169,6 +170,7 @@ unsigned sox_precision(sox_encoding_t encoding, unsigned bits_per_sample)
 
     case SOX_ENCODING_ALAW:       return bits_per_sample == 8? 13: 0;
     case SOX_ENCODING_ULAW:       return bits_per_sample == 8? 14: 0;
+    case SOX_ENCODING_DSD:        return bits_per_sample;
 
     case SOX_ENCODING_CL_ADPCM:   return bits_per_sample? 8: 0;
     case SOX_ENCODING_CL_ADPCM16: return bits_per_sample == 4? 13: 0;
@@ -415,6 +417,8 @@ static void UNUSED rewind_pipe(FILE * fp)
   fp->_r += PIPE_AUTO_DETECT_SIZE;
 #elif defined __GLIBC__
   fp->_IO_read_ptr = fp->_IO_read_base;
+#elif defined _MSC_VER && _MSC_VER >= 1900
+  #define NO_REWIND_PIPE
 #elif defined _MSC_VER || defined _WIN32 || defined _WIN64 || \
       defined _ISO_STDIO_ISO_H || defined __sgi
   fp->_ptr = fp->_base;
diff --git a/src/formats.h b/src/formats.h
index a42ce270..05bb9860 100644
--- a/src/formats.h
+++ b/src/formats.h
@@ -26,6 +26,8 @@
   FORMAT(cvsd)
   FORMAT(cvu)
   FORMAT(dat)
+  FORMAT(dsdiff)
+  FORMAT(dsf)
   FORMAT(dvms)
   FORMAT(f4)
   FORMAT(f8)
@@ -60,6 +62,7 @@
   FORMAT(voc)
   FORMAT(vox)
   FORMAT(wav)
+  FORMAT(wsd)
   FORMAT(wve)
   FORMAT(xa)
 
diff --git a/src/hcom.c b/src/hcom.c
index e76820e9..1b0e09dd 100644
--- a/src/hcom.c
+++ b/src/hcom.c
@@ -150,6 +150,11 @@ static int startread(sox_format_t * ft)
                 lsx_debug("%d %d",
                        p->dictionary[i].dict_leftson,
                        p->dictionary[i].dict_rightson);
+                if ((unsigned) p->dictionary[i].dict_leftson >= dictsize ||
+                    (unsigned) p->dictionary[i].dict_rightson >= dictsize) {
+                        lsx_fail_errno(ft, SOX_EHDR, "Invalid dictionary");
+                        return SOX_EOF;
+                }
         }
         rc = lsx_skipbytes(ft, (size_t) 1); /* skip pad byte */
         if (rc)
@@ -432,9 +437,10 @@ static int stopwrite(sox_format_t * ft)
   int rc = SOX_SUCCESS;
 
   /* Compress it all at once */
-  if (compressed_len)
+  if (compressed_len) {
     compress(ft, &compressed_data, (int32_t *)&compressed_len);
-  free(p->data);
+    free(p->data);
+  }
 
   /* Write the header */
   lsx_writebuf(ft, "\000\001A", (size_t) 3); /* Dummy file name "A" */
diff --git a/src/id3.c b/src/id3.c
new file mode 100644
index 00000000..ffc47e33
--- /dev/null
+++ b/src/id3.c
@@ -0,0 +1,217 @@
+/* libSoX MP3 utilities  Copyright (c) 2007-9 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <id3tag.h>
+#include "sox_i.h"
+#include "id3.h"
+
+static char const * id3tagmap[][2] =
+{
+  {"TIT2", "Title"},
+  {"TPE1", "Artist"},
+  {"TALB", "Album"},
+  {"TCOM", "Composer"},
+  {"TRCK", "Tracknumber"},
+  {"TDRC", "Year"},
+  {"TCON", "Genre"},
+  {"COMM", "Comment"},
+  {"TPOS", "Discnumber"},
+  {NULL, NULL}
+};
+
+static id3_utf8_t * utf8_id3tag_findframe(
+    struct id3_tag * tag, const char * const frameid, unsigned index)
+{
+  struct id3_frame const * frame = id3_tag_findframe(tag, frameid, index);
+  if (frame) {
+    unsigned nfields = frame->nfields;
+
+    while (nfields--) {
+      union id3_field const *field = id3_frame_field(frame, nfields);
+      int ftype = id3_field_type(field);
+      const id3_ucs4_t *ucs4 = NULL;
+      unsigned nstrings;
+
+      switch (ftype) {
+      case ID3_FIELD_TYPE_STRING:
+        ucs4 = id3_field_getstring(field);
+        break;
+
+      case ID3_FIELD_TYPE_STRINGFULL:
+        ucs4 = id3_field_getfullstring(field);
+        break;
+
+      case ID3_FIELD_TYPE_STRINGLIST:
+        nstrings = id3_field_getnstrings(field);
+        while (nstrings--) {
+          ucs4 = id3_field_getstrings(field, nstrings);
+          if (ucs4)
+            break;
+        }
+        break;
+      }
+
+      if (ucs4)
+        return id3_ucs4_utf8duplicate(ucs4); /* Must call free() on this */
+    }
+  }
+  return NULL;
+}
+
+struct tag_info_node
+{
+    struct tag_info_node * next;
+    off_t start;
+    off_t end;
+};
+
+struct tag_info {
+  sox_format_t * ft;
+  struct tag_info_node * head;
+  struct id3_tag * tag;
+};
+
+static int add_tag(struct tag_info * info)
+{
+  struct tag_info_node * current;
+  off_t start, end;
+  id3_byte_t query[ID3_TAG_QUERYSIZE];
+  id3_byte_t * buffer;
+  long size;
+  int result = 0;
+
+  /* Ensure we're at the start of a valid tag and get its size. */
+  if (ID3_TAG_QUERYSIZE != lsx_readbuf(info->ft, query, ID3_TAG_QUERYSIZE) ||
+      !(size = id3_tag_query(query, ID3_TAG_QUERYSIZE))) {
+    return 0;
+  }
+  if (size < 0) {
+    if (0 != lsx_seeki(info->ft, size, SEEK_CUR) ||
+        ID3_TAG_QUERYSIZE != lsx_readbuf(info->ft, query, ID3_TAG_QUERYSIZE) ||
+        (size = id3_tag_query(query, ID3_TAG_QUERYSIZE)) <= 0) {
+      return 0;
+    }
+  }
+
+  /* Don't read a tag more than once. */
+  start = lsx_tell(info->ft);
+  end = start + size;
+  for (current = info->head; current; current = current->next) {
+    if (start == current->start && end == current->end) {
+      return 1;
+    } else if (start < current->end && current->start < end) {
+      return 0;
+    }
+  }
+
+  buffer = lsx_malloc((size_t)size);
+  if (!buffer) {
+    return 0;
+  }
+  memcpy(buffer, query, ID3_TAG_QUERYSIZE);
+  if ((unsigned long)size - ID3_TAG_QUERYSIZE ==
+      lsx_readbuf(info->ft, buffer + ID3_TAG_QUERYSIZE, (size_t)size - ID3_TAG_QUERYSIZE)) {
+    struct id3_tag * tag = id3_tag_parse(buffer, (size_t)size);
+    if (tag) {
+      current = lsx_malloc(sizeof(struct tag_info_node));
+      if (current) {
+        current->next = info->head;
+        current->start = start;
+        current->end = end;
+        info->head = current;
+        if (info->tag && (info->tag->extendedflags & ID3_TAG_EXTENDEDFLAG_TAGISANUPDATE)) {
+          struct id3_frame * frame;
+          unsigned i;
+          for (i = 0; (frame = id3_tag_findframe(tag, NULL, i)); i++) {
+            id3_tag_attachframe(info->tag, frame);
+          }
+          id3_tag_delete(tag);
+        } else {
+          if (info->tag) {
+            id3_tag_delete(info->tag);
+          }
+          info->tag = tag;
+        }
+      }
+    }
+  }
+  free(buffer);
+  return result;
+}
+
+void lsx_id3_read_tag(sox_format_t * ft, sox_bool search)
+{
+  struct tag_info   info;
+  id3_utf8_t        * utf8;
+  int               i;
+  int               has_id3v1 = 0;
+
+  info.ft = ft;
+  info.head = NULL;
+  info.tag = NULL;
+
+  /*
+  We look for:
+  ID3v1 at end (EOF - 128).
+  ID3v2 at start.
+  ID3v2 at end (but before ID3v1 from end if there was one).
+  */
+
+  if (search) {
+    if (0 == lsx_seeki(ft, -128, SEEK_END)) {
+      has_id3v1 =
+        add_tag(&info) &&
+        1 == ID3_TAG_VERSION_MAJOR(id3_tag_version(info.tag));
+    }
+    if (0 == lsx_seeki(ft, 0, SEEK_SET)) {
+      add_tag(&info);
+    }
+    if (0 == lsx_seeki(ft, has_id3v1 ? -138 : -10, SEEK_END)) {
+      add_tag(&info);
+    }
+  } else {
+    add_tag(&info);
+  }
+
+  if (info.tag && info.tag->frames) {
+    for (i = 0; id3tagmap[i][0]; ++i) {
+      if ((utf8 = utf8_id3tag_findframe(info.tag, id3tagmap[i][0], 0))) {
+        char * comment = lsx_malloc(strlen(id3tagmap[i][1]) + 1 + strlen((char *)utf8) + 1);
+        sprintf(comment, "%s=%s", id3tagmap[i][1], utf8);
+        sox_append_comment(&ft->oob.comments, comment);
+        free(comment);
+        free(utf8);
+      }
+    }
+    if ((utf8 = utf8_id3tag_findframe(info.tag, "TLEN", 0))) {
+      unsigned long tlen = strtoul((char *)utf8, NULL, 10);
+      if (tlen > 0 && tlen < ULONG_MAX) {
+        ft->signal.length= tlen; /* In ms; convert to samples later */
+        lsx_debug("got exact duration from ID3 TLEN");
+      }
+      free(utf8);
+    }
+  }
+  while (info.head) {
+    struct tag_info_node * head = info.head;
+    info.head = head->next;
+    free(head);
+  }
+  if (info.tag) {
+    id3_tag_delete(info.tag);
+  }
+}
diff --git a/src/ignore-warning.h b/src/id3.h
similarity index 66%
rename from src/ignore-warning.h
rename to src/id3.h
index d93a5ecb..c84a2f89 100644
--- a/src/ignore-warning.h
+++ b/src/id3.h
@@ -1,4 +1,6 @@
-/* This library is free software; you can redistribute it and/or modify it
+/* libSoX MP3 utilities  Copyright (c) 2007-9 SoX contributors
+ *
+ * This library is free software; you can redistribute it and/or modify it
  * under the terms of the GNU Lesser General Public License as published by
  * the Free Software Foundation; either version 2.1 of the License, or (at
  * your option) any later version.
@@ -13,20 +15,19 @@
  * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
-#if defined __GNUC__
-  #pragma GCC system_header
-#elif defined __SUNPRO_CC
-  #pragma disable_warn
-#elif defined _MSC_VER
-  #pragma warning(push, 1)
-#endif
+#ifndef SOX_ID3_H
+#define SOX_ID3_H
+
+#include "sox_i.h"
+
+#ifdef HAVE_ID3TAG
+
+void lsx_id3_read_tag(sox_format_t *ft, sox_bool search);
+
+#else
 
-  IGNORE_WARNING
-#undef IGNORE_WARNING
+#define lsx_id3_read_tag(ft, search) do { } while (0)
 
+#endif /* HAVE_ID3TAG */
 
-#if defined __SUNPRO_CC
-  #pragma enable_warn
-#elif defined _MSC_VER
-  #pragma warning(pop)
 #endif
diff --git a/src/mp3-util.h b/src/mp3-util.h
index 518743dd..1c4e835c 100644
--- a/src/mp3-util.h
+++ b/src/mp3-util.h
@@ -17,23 +17,6 @@
 
 #include <sys/stat.h>
 
-#ifdef USING_ID3TAG
-
-static char const * id3tagmap[][2] =
-{
-  {"TIT2", "Title"},
-  {"TPE1", "Artist"},
-  {"TALB", "Album"},
-  {"TRCK", "Tracknumber"},
-  {"TDRC", "Year"},
-  {"TCON", "Genre"},
-  {"COMM", "Comment"},
-  {"TPOS", "Discnumber"},
-  {NULL, NULL}
-};
-
-#endif /* USING_ID3TAG */
-
 #if defined(HAVE_LAME)
 
 static void write_comments(sox_format_t * ft)
@@ -79,165 +62,6 @@ static void write_comments(sox_format_t * ft)
 
 #endif /* HAVE_LAME */
 
-#ifdef USING_ID3TAG
-
-static id3_utf8_t * utf8_id3tag_findframe(
-    struct id3_tag * tag, const char * const frameid, unsigned index)
-{
-  struct id3_frame const * frame = id3_tag_findframe(tag, frameid, index);
-  if (frame) {
-    union id3_field  const * field = id3_frame_field(frame, 1);
-    unsigned nstrings = id3_field_getnstrings(field);
-    while (nstrings--){
-      id3_ucs4_t const * ucs4 = id3_field_getstrings(field, nstrings);
-      if (ucs4)
-        return id3_ucs4_utf8duplicate(ucs4); /* Must call free() on this */
-    }
-  }
-  return NULL;
-}
-
-struct tag_info_node
-{
-    struct tag_info_node * next;
-    off_t start;
-    off_t end;
-};
-
-struct tag_info {
-  sox_format_t * ft;
-  struct tag_info_node * head;
-  struct id3_tag * tag;
-};
-
-static int add_tag(struct tag_info * info)
-{
-  struct tag_info_node * current;
-  off_t start, end;
-  id3_byte_t query[ID3_TAG_QUERYSIZE];
-  id3_byte_t * buffer;
-  long size;
-  int result = 0;
-
-  /* Ensure we're at the start of a valid tag and get its size. */
-  if (ID3_TAG_QUERYSIZE != lsx_readbuf(info->ft, query, ID3_TAG_QUERYSIZE) ||
-      !(size = id3_tag_query(query, ID3_TAG_QUERYSIZE))) {
-    return 0;
-  }
-  if (size < 0) {
-    if (0 != lsx_seeki(info->ft, size, SEEK_CUR) ||
-        ID3_TAG_QUERYSIZE != lsx_readbuf(info->ft, query, ID3_TAG_QUERYSIZE) ||
-        (size = id3_tag_query(query, ID3_TAG_QUERYSIZE)) <= 0) {
-      return 0;
-    }
-  }
-
-  /* Don't read a tag more than once. */
-  start = lsx_tell(info->ft);
-  end = start + size;
-  for (current = info->head; current; current = current->next) {
-    if (start == current->start && end == current->end) {
-      return 1;
-    } else if (start < current->end && current->start < end) {
-      return 0;
-    }
-  }
-
-  buffer = lsx_malloc((size_t)size);
-  if (!buffer) {
-    return 0;
-  }
-  memcpy(buffer, query, ID3_TAG_QUERYSIZE);
-  if ((unsigned long)size - ID3_TAG_QUERYSIZE ==
-      lsx_readbuf(info->ft, buffer + ID3_TAG_QUERYSIZE, (size_t)size - ID3_TAG_QUERYSIZE)) {
-    struct id3_tag * tag = id3_tag_parse(buffer, (size_t)size);
-    if (tag) {
-      current = lsx_malloc(sizeof(struct tag_info_node));
-      if (current) {
-        current->next = info->head;
-        current->start = start;
-        current->end = end;
-        info->head = current;
-        if (info->tag && (info->tag->extendedflags & ID3_TAG_EXTENDEDFLAG_TAGISANUPDATE)) {
-          struct id3_frame * frame;
-          unsigned i;
-          for (i = 0; (frame = id3_tag_findframe(tag, NULL, i)); i++) {
-            id3_tag_attachframe(info->tag, frame);
-          }
-          id3_tag_delete(tag);
-        } else {
-          if (info->tag) {
-            id3_tag_delete(info->tag);
-          }
-          info->tag = tag;
-        }
-      }
-    }
-  }
-  free(buffer);
-  return result;
-}
-
-static void read_comments(sox_format_t * ft)
-{
-  struct tag_info   info;
-  id3_utf8_t        * utf8;
-  int               i;
-  int               has_id3v1 = 0;
-
-  info.ft = ft;
-  info.head = NULL;
-  info.tag = NULL;
-
-  /*
-  We look for:
-  ID3v1 at end (EOF - 128).
-  ID3v2 at start.
-  ID3v2 at end (but before ID3v1 from end if there was one).
-  */
-
-  if (0 == lsx_seeki(ft, -128, SEEK_END)) {
-    has_id3v1 =
-      add_tag(&info) &&
-      1 == ID3_TAG_VERSION_MAJOR(id3_tag_version(info.tag));
-  }
-  if (0 == lsx_seeki(ft, 0, SEEK_SET)) {
-    add_tag(&info);
-  }
-  if (0 == lsx_seeki(ft, has_id3v1 ? -138 : -10, SEEK_END)) {
-    add_tag(&info);
-  }
-  if (info.tag && info.tag->frames) {
-    for (i = 0; id3tagmap[i][0]; ++i) {
-      if ((utf8 = utf8_id3tag_findframe(info.tag, id3tagmap[i][0], 0))) {
-        char * comment = lsx_malloc(strlen(id3tagmap[i][1]) + 1 + strlen((char *)utf8) + 1);
-        sprintf(comment, "%s=%s", id3tagmap[i][1], utf8);
-        sox_append_comment(&ft->oob.comments, comment);
-        free(comment);
-        free(utf8);
-      }
-    }
-    if ((utf8 = utf8_id3tag_findframe(info.tag, "TLEN", 0))) {
-      unsigned long tlen = strtoul((char *)utf8, NULL, 10);
-      if (tlen > 0 && tlen < ULONG_MAX) {
-        ft->signal.length= tlen; /* In ms; convert to samples later */
-        lsx_debug("got exact duration from ID3 TLEN");
-      }
-      free(utf8);
-    }
-  }
-  while (info.head) {
-    struct tag_info_node * head = info.head;
-    info.head = head->next;
-    free(head);
-  }
-  if (info.tag) {
-    id3_tag_delete(info.tag);
-  }
-}
-
-#endif /* USING_ID3TAG */
-
 #ifdef HAVE_MAD_H
 
 static unsigned long xing_frames(priv_t * p, struct mad_bitptr ptr, unsigned bitlen)
diff --git a/src/mp3.c b/src/mp3.c
index 883e59e3..89f87d4a 100644
--- a/src/mp3.c
+++ b/src/mp3.c
@@ -45,6 +45,7 @@ typedef enum {
 
 #ifdef USING_ID3TAG
   #include <id3tag.h>
+  #include "id3.h"
 #if defined(HAVE_UNISTD_H)
   #include <unistd.h>
 #elif defined(HAVE_IO_H)
@@ -384,7 +385,7 @@ static int startread(sox_format_t * ft)
   ft->signal.length = SOX_UNSPEC;
   if (ft->seekable) {
 #ifdef USING_ID3TAG
-    read_comments(ft);
+    lsx_id3_read_tag(ft, sox_true);
     lsx_rewind(ft);
     if (!ft->signal.length)
 #endif
diff --git a/src/pad.c b/src/pad.c
index c04086f5..bd79949f 100644
--- a/src/pad.c
+++ b/src/pad.c
@@ -23,13 +23,20 @@ typedef struct {
     char * str;       /* Command-line argument to parse for this pad */
     uint64_t start; /* Start padding when in_pos equals this */
     uint64_t pad;   /* Number of samples to pad */
+    uint64_t align; /* Align output to multiple of this */
   } * pads;
 
   uint64_t in_pos;  /* Number of samples read from the input stream */
+  uint64_t out_pos; /* Number of samples written to the output stream */
   unsigned pads_pos;  /* Number of pads completed so far */
   uint64_t pad_pos; /* Number of samples through the current pad */
 } priv_t;
 
+static uint64_t pad_align(uint64_t pos, uint64_t align)
+{
+  return (align - pos % align) % align;
+}
+
 static int parse(sox_effect_t * effp, char * * argv, sox_rate_t rate)
 {
   priv_t * p = (priv_t *)effp->priv;
@@ -39,14 +46,24 @@ static int parse(sox_effect_t * effp, char * * argv, sox_rate_t rate)
   const uint64_t in_length = argv ? 0 :
     (effp->in_signal.length != SOX_UNKNOWN_LEN ?
      effp->in_signal.length / effp->in_signal.channels : SOX_UNKNOWN_LEN);
+  uint64_t pad_len = 0;
+  uint64_t *arg;
+  char *str;
 
   for (i = 0; i < p->npads; ++i) {
     if (argv) /* 1st parse only */
       p->pads[i].str = lsx_strdup(argv[i]);
-    next = lsx_parsesamples(rate, p->pads[i].str, &p->pads[i].pad, 't');
+    str = p->pads[i].str;
+    if (*str == '%') {
+      str++;
+      arg = &p->pads[i].align;
+    } else {
+      arg = &p->pads[i].pad;
+    }
+    next = lsx_parsesamples(rate, str, arg, 't');
     if (next == NULL) break;
     if (*next == '\0')
-      p->pads[i].start = i? UINT64_MAX : 0;
+      p->pads[i].start = i? in_length : 0;
     else {
       if (*next != '@') break;
       next = lsx_parseposition(rate, next+1, argv ? NULL : &p->pads[i].start,
@@ -57,6 +74,14 @@ static int parse(sox_effect_t * effp, char * * argv, sox_rate_t rate)
         p->pads[i].start = UINT64_MAX; /* currently the same value, but ... */
     }
     if (!argv) {
+      if (p->pads[i].align && p->pads[i].start != UINT64_MAX) {
+        p->pads[i].pad =
+          pad_align(p->pads[i].start + pad_len, p->pads[i].align);
+        p->pads[i].align = 0;
+      }
+
+      pad_len += p->pads[i].pad;
+
       /* Do this check only during the second pass when the actual
          sample rate is known, otherwise it might fail on legal
          commands like
@@ -107,9 +132,9 @@ static int start(sox_effect_t * effp)
     }
   }
 
-  p->in_pos = p->pad_pos = p->pads_pos = 0;
+  p->in_pos = p->out_pos = p->pad_pos = p->pads_pos = 0;
   for (i = 0; i < p->npads; ++i)
-    if (p->pads[i].pad)
+    if (p->pads[i].pad || p->pads[i].align)
       return SOX_SUCCESS;
   return SOX_EFF_NULL;
 }
@@ -138,6 +163,8 @@ static int flow(sox_effect_t * effp, const sox_sample_t * ibuf,
     }
   } while (idone < *isamp && odone < *osamp);
 
+  p->out_pos += odone;
+
   *isamp = idone * effp->in_signal.channels;
   *osamp = odone * effp->in_signal.channels;
   return SOX_SUCCESS;
@@ -147,8 +174,12 @@ static int drain(sox_effect_t * effp, sox_sample_t * obuf, size_t * osamp)
 {
   priv_t * p = (priv_t *)effp->priv;
   static size_t isamp = 0;
-  if (p->pads_pos != p->npads && p->in_pos != p->pads[p->pads_pos].start)
+  if (p->pads_pos != p->npads && p->in_pos != p->pads[p->pads_pos].start) {
+    if (p->pads[p->pads_pos].align)
+      p->pads[p->pads_pos].pad =
+        pad_align(p->pads[p->pads_pos].align, p->pads[p->pads_pos].align);
     p->in_pos = UINT64_MAX;  /* Invoke the final pad (with no given start) */
+  }
   return flow(effp, 0, obuf, &isamp, osamp);
 }
 
diff --git a/src/paf.c b/src/paf.c
index e8e4c32f..b1c51742 100644
--- a/src/paf.c
+++ b/src/paf.c
@@ -26,7 +26,7 @@ LSX_FORMAT_HANDLER(paf)
   static sox_format_handler_t handler;
   handler = *lsx_sndfile_format_fn();
   handler.description =
-    "Ensoniq PARIS digitial audio editing system (big endian)";
+    "Ensoniq PARIS digital audio editing system (big endian)";
   handler.names = names;
   handler.write_formats = write_encodings;
   return &handler;
diff --git a/src/sdm.c b/src/sdm.c
new file mode 100644
index 00000000..fab3677f
--- /dev/null
+++ b/src/sdm.c
@@ -0,0 +1,1149 @@
+/* Sigma-Delta modulator
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+/*
+ * References:
+ *
+ * Derk Reefman, Erwin Janssen. 2002.
+ * "Signal processing for Direct Stream Digital: A tutorial for
+ * digital Sigma Delta modulation and 1-bit digital audio processing"
+ * http://www.emmlabs.com/pdf/papers/DerkSigmaDelta.pdf
+ *
+ * P.J.A. Harpe. 2003.
+ * "Trellis-type Sigma Delta Modulators for Super Audio CD applications"
+ * http://www.pieterharpe.nl/docs/report_trunc.pdf
+ *
+ * Richard Schreier. 2000-2011.
+ * "Delta Sigma Toolbox"
+ * http://www.mathworks.com/matlabcentral/fileexchange/19-delta-sigma-toolbox
+ */
+
+#define _ISOC11_SOURCE
+
+#include "sox_i.h"
+#include "sdm.h"
+
+#define MAX_FILTER_ORDER 8
+#define PATH_HASH_SIZE 128
+#define PATH_HASH_MASK (PATH_HASH_SIZE - 1)
+
+typedef struct LSX_ALIGN(32) sdm_filter {
+  const double  a[MAX_FILTER_ORDER];
+  const double  g[MAX_FILTER_ORDER];
+  int32_t       order;
+  unsigned      freq;
+  const char   *name;
+  int           trellis_order;
+  int           trellis_num;
+  int           trellis_lat;
+} sdm_filter_t;
+
+typedef struct LSX_ALIGN(32) sdm_state {
+  double        state[MAX_FILTER_ORDER];
+  double        cost;
+  uint32_t      path;
+  uint8_t       next;
+  uint8_t       hist;
+  uint8_t       hist_used;
+  struct sdm_state *parent;
+  struct sdm_state *path_list;
+} sdm_state_t;
+
+typedef struct {
+  sdm_state_t   sdm[2 * SDM_TRELLIS_MAX_NUM];
+  sdm_state_t  *act[SDM_TRELLIS_MAX_NUM];
+} sdm_trellis_t;
+
+struct sdm {
+  sdm_trellis_t trellis[2];
+  sdm_state_t  *path_hash[PATH_HASH_SIZE];
+  uint8_t       hist_free[2 * SDM_TRELLIS_MAX_NUM];
+  unsigned      hist_fnum;
+  uint32_t      trellis_mask;
+  uint32_t      trellis_num;
+  uint32_t      trellis_lat;
+  unsigned      num_cands;
+  unsigned      pos;
+  unsigned      pending;
+  unsigned      draining;
+  unsigned      idx;
+  const sdm_filter_t *filter;
+  double        prev_y;
+  uint64_t      conv_fail;
+  uint8_t       hist[2 * SDM_TRELLIS_MAX_NUM][SDM_TRELLIS_MAX_LAT / 8];
+};
+
+static const sdm_filter_t sdm_filters[] = {
+  {
+    {
+      1.00323940832478e+00,
+      3.54975562370606e-01,
+      5.64754047673194e-02,
+      3.99067228430322e-03,
+    },
+    {
+      1.74071110561285e-05, 0,
+      1.11672812199443e-04, 0,
+    },
+    4,
+    256 * 44100,
+    "clans-4",
+    0, 0, 0
+  },
+  {
+    {
+      8.69746397840960e-01,
+      3.58080546314756e-01,
+      8.02654082306273e-02,
+      8.06528716282692e-03,
+    },
+    {
+      1.74071110561285e-05, 0,
+      1.11672812199443e-04, 0,
+    },
+    4,
+    256 * 44100,
+    "sdm-4",
+    0, 0, 0
+  },
+  {
+    {
+      1.10212073518628e+00,
+      4.33447134954244e-01,
+      7.17865111532609e-02,
+      4.48367825425951e-03,
+      8.60861641068938e-05,
+    },
+    {
+      0, 4.36651951230006e-05,
+      0, 1.23660417994961e-04,
+    },
+    5,
+    256 * 44100,
+    "clans-5",
+    0, 0, 0
+  },
+  {
+    {
+      8.07768375734983e-01,
+      3.16440095967511e-01,
+      7.38231738259889e-02,
+      1.01432044963374e-02,
+      6.46658652275506e-04,
+    },
+    {
+      0, 4.36651951230006e-05,
+      0, 1.23660417994961e-04,
+    },
+    5,
+    256 * 44100,
+    "sdm-5",
+    0, 0, 0
+  },
+  {
+    {
+      9.97000121097967e-01,
+      3.46002867430604e-01,
+      5.74352078895161e-02,
+      4.96197900435677e-03,
+      2.16319301330580e-04,
+      3.45938007947910e-06,
+    },
+    {
+      8.57500543083848e-06, 0,
+      6.58398680532347e-05, 0,
+      1.30939362595793e-04, 0,
+    },
+    6,
+    256 * 44100,
+    "clans-6",
+    0, 0, 0
+  },
+  {
+    {
+      8.08851952379691e-01,
+      3.20414766828429e-01,
+      7.85858596284593e-02,
+      1.24781319607895e-02,
+      1.21202847406105e-03,
+      5.51622876557856e-05,
+    },
+    {
+      8.57500543083848e-06, 0,
+      6.58398680532347e-05, 0,
+      1.30939362595793e-04, 0,
+    },
+    6,
+    256 * 44100,
+    "sdm-6",
+    0, 0, 0
+  },
+  {
+    {
+      1.10629931445134e+00,
+      4.22135693734657e-01,
+      7.54595882135669e-02,
+      7.07164815703843e-03,
+      3.53092575577382e-04,
+      8.89662856104825e-06,
+      5.79674109824069e-08,
+    },
+    {
+      0, 2.48046933669715e-05,
+      0, 8.28068362972358e-05,
+      0, 1.35653594733585e-04,
+    },
+    7,
+    256 * 44100,
+    "clans-7",
+    0, 0, 0
+  },
+  {
+    {
+      7.82785077952658e-01,
+      3.01888671316811e-01,
+      7.36594376027782e-02,
+      1.22068270909817e-02,
+      1.36572694403914e-03,
+      9.57806082134936e-05,
+      3.13239368043838e-06,
+    },
+    {
+      0, 2.48046933669715e-05,
+      0, 8.28068362972358e-05,
+      0, 1.35653594733585e-04,
+    },
+    7,
+    256 * 44100,
+    "sdm-7",
+    0, 0, 0
+  },
+  {
+    {
+      1.15188624720851e+00,
+      5.45054196257555e-01,
+      1.38703640845632e-01,
+      2.07076444822072e-02,
+      1.85506614417771e-03,
+      9.63403135615390e-05,
+      2.69174565706992e-06,
+      2.22594461751768e-08,
+    },
+    {
+      5.06749566262594e-06, 0,
+      4.15924517416912e-05, 0,
+      9.55783346944871e-05, 0,
+      1.38868728742641e-04, 0,
+    },
+    8,
+    256 * 44100,
+    "clans-8",
+    0, 0, 0
+  },
+  {
+    {
+      7.42329617949054e-01,
+      2.72509195471757e-01,
+      6.41424039739473e-02,
+      1.05299412132258e-02,
+      1.23178223428228e-03,
+      9.94985029720342e-05,
+      5.13169547054423e-06,
+      1.20466411041020e-07,
+    },
+    {
+      5.06749566262594e-06, 0,
+      4.15924517416912e-05, 0,
+      9.55783346944871e-05, 0,
+      1.38868728742641e-04, 0,
+    },
+    8,
+    256 * 44100,
+    "sdm-8",
+    0, 0, 0
+  },
+  {
+    {
+      1.19985242167687e+00,
+      5.39366678861047e-01,
+      1.07433710905069e-01,
+      7.85649993434925e-03,
+    },
+    {
+      6.96272321944526e-05, 0,
+      4.46641365529834e-04, 0,
+    },
+    4,
+    128 * 44100,
+    "clans-4",
+    0, 0, 0
+  },
+  {
+    {
+      8.69935494013007e-01,
+      3.57844753369190e-01,
+      8.00232187246903e-02,
+      7.95176796646842e-03,
+    },
+    {
+      6.96272321944526e-05, 0,
+      4.46641365529834e-04, 0,
+    },
+    4,
+    128 * 44100,
+    "sdm-4",
+    0, 0, 0
+  },
+  {
+    {
+      1.12849522129362e+00,
+      5.02128177800632e-01,
+      1.10084368682902e-01,
+      1.18635667860902e-02,
+      4.71059243536326e-04,
+    },
+    {
+      0, 1.74653153894942e-04,
+      0, 4.94580504383930e-04,
+    },
+    5,
+    128 * 44100,
+    "clans-5",
+    0, 0, 0
+  },
+  {
+    {
+      8.08016362125685e-01,
+      3.16129639744972e-01,
+      7.34835047943110e-02,
+      1.00377576971692e-02,
+      6.20309683440734e-04,
+    },
+    {
+      0, 1.74653153894942e-04,
+      0, 4.94580504383930e-04,
+    },
+    5,
+    128 * 44100,
+    "sdm-5",
+    0, 0, 0
+  },
+  {
+    {
+      1.13839804508630e+00,
+      5.16338264778321e-01,
+      1.20760874713903e-01,
+      1.53496744585395e-02,
+      1.00733946588732e-03,
+      2.18223963130981e-05,
+    },
+    {
+      3.42997276004814e-05, 0,
+      2.63342132660038e-04, 0,
+      5.23688869916463e-04, 0,
+    },
+    6,
+    128 * 44100,
+    "clans-6",
+    0, 0, 0
+  },
+  {
+    {
+      8.09157514480151e-01,
+      3.20038611545599e-01,
+      7.81955723892726e-02,
+      1.23074728674017e-02,
+      1.18346416730106e-03,
+      5.04301224894810e-05,
+    },
+    {
+      3.42997276004814e-05, 0,
+      2.63342132660038e-04, 0,
+      5.23688869916463e-04, 0,
+    },
+    6,
+    128 * 44100,
+    "sdm-6",
+    0, 0, 0
+  },
+  {
+    {
+      8.98180853333862e-01,
+      3.27985497323439e-01,
+      6.38803466871112e-02,
+      7.18262647412857e-03,
+      4.51845004995476e-04,
+      1.49685651672331e-05,
+      4.22554681245302e-08,
+    },
+    {
+      0, 9.92163123766340e-05,
+      0, 3.31199917300393e-04,
+      0, 5.42540771343282e-04,
+    },
+    7,
+    128 * 44100,
+    "clans-7",
+    0, 0, 0
+  },
+  {
+    {
+      7.83148010097334e-01,
+      3.01437231238902e-01,
+      7.31891646224574e-02,
+      1.20314098366875e-02,
+      1.32077937193861e-03,
+      9.11181979169687e-05,
+      2.59895240306562e-06,
+    },
+    {
+      0, 9.92163123766340e-05,
+      0, 3.31199917300393e-04,
+      0, 5.42540771343282e-04,
+    },
+    7,
+    128 * 44100,
+    "sdm-7",
+    0, 0, 0
+  },
+  {
+    {
+      1.04472698053970e+00,
+      4.62088167600438e-01,
+      1.13484722685479e-01,
+      1.68939738398161e-02,
+      1.55891676875336e-03,
+      8.23864822188133e-05,
+      2.39690238375972e-06,
+      -1.75063180618551e-09,
+    },
+    {
+      2.02698799324546e-05, 0,
+      1.66362887238597e-04, 0,
+      3.82276797905696e-04, 0,
+      5.55397776875272e-04, 0,
+    },
+    8,
+    128 * 44100,
+    "clans-8",
+    0, 0, 0
+  },
+  {
+    {
+      7.42763211426562e-01,
+      2.71983157679393e-01,
+      6.36389361390464e-02,
+      1.03289230528372e-02,
+      1.19045645863092e-03,
+      9.25357160397986e-05,
+      4.64982367004083e-06,
+      8.14280266547840e-08,
+    },
+    {
+      2.02698799324546e-05, 0,
+      1.66362887238597e-04, 0,
+      3.82276797905696e-04, 0,
+      5.55397776875272e-04, 0,
+    },
+    8,
+    128 * 44100,
+    "sdm-8",
+    0, 0, 0
+  },
+  {
+    {
+      1.27879853057675e+00,
+      6.11303913722028e-01,
+      1.28497083869344e-01,
+      9.36669621421730e-03,
+    },
+    {
+      2.78489536971958e-04, 0,
+      1.78576750808173e-03, 0,
+    },
+    4,
+    64 * 44100,
+    "clans-4",
+    0, 0, 0
+  },
+  {
+    {
+      8.70691905361989e-01,
+      3.56902669565715e-01,
+      7.90540396115068e-02,
+      7.49922172520510e-03,
+    },
+    {
+      2.78489536971958e-04, 0,
+      1.78576750808173e-03, 0,
+    },
+    4,
+    64 * 44100,
+    "sdm-4",
+    0, 0, 0
+  },
+  {
+    {
+      1.09979653514762e+00,
+      4.81149952106030e-01,
+      1.03481231987752e-01,
+      1.07520561970131e-02,
+      3.08801118488355e-04,
+    },
+    {
+      0, 6.98490600683106e-04,
+      0, 1.97734357803445e-03,
+    },
+    5,
+    64 * 44100,
+    "clans-5",
+    0, 0, 0
+  },
+  {
+    {
+      8.09008352716413e-01,
+      3.14889441429587e-01,
+      7.21235639855639e-02,
+      9.61769014140330e-03,
+      5.16726747047100e-04,
+    },
+    {
+      0, 6.98490600683106e-04,
+      0, 1.97734357803445e-03,
+    },
+    5,
+    64 * 44100,
+    "sdm-5",
+    0, 0, 0
+  },
+  {
+    {
+      1.07903996429881e+00,
+      4.81889508657128e-01,
+      1.12960470418260e-01,
+      1.41786764681378e-02,
+      8.90696638761455e-04,
+      3.12209321540191e-06,
+    },
+    {
+      1.37194204516672e-04, 0,
+      1.05309113432481e-03, 0,
+      2.09365847953595e-03, 0,
+    },
+    6,
+    64 * 44100,
+    "clans-6",
+    0, 0, 0
+  },
+  {
+    {
+      8.10379824203071e-01,
+      3.18536209193388e-01,
+      7.66325098232035e-02,
+      1.16280270347611e-02,
+      1.07113013239551e-03,
+      3.23564051386283e-05,
+    },
+    {
+      1.37194204516672e-04, 0,
+      1.05309113432481e-03, 0,
+      2.09365847953595e-03, 0,
+    },
+    6,
+    64 * 44100,
+    "sdm-6",
+    0, 0, 0
+  },
+  {
+    {
+      1.30828743581024e+00,
+      6.14252690035661e-01,
+      1.30284958810903e-01,
+      1.31280998331490e-02,
+      4.80497172614556e-04,
+      1.28747977598542e-07,
+      -1.01500259908072e-06,
+    },
+    {
+      0, 3.96825873999969e-04,
+      0, 1.32436089566069e-03,
+      0, 2.16898568341885e-03,
+    },
+    7,
+    64 * 44100,
+    "clans-7",
+    0, 0, 0
+  },
+  {
+    {
+      7.84599817960974e-01,
+      2.99634346028983e-01,
+      7.13049276218066e-02,
+      1.13334107086916e-02,
+      1.14497642818158e-03,
+      7.33018502803093e-05,
+      6.80633400002018e-07,
+    },
+    {
+      0, 3.96825873999969e-04,
+      0, 1.32436089566069e-03,
+      0, 2.16898568341885e-03,
+    },
+    7,
+    64 * 44100,
+    "sdm-7",
+    0, 0, 0
+  },
+  {
+    {
+      1.18730059129261e+00,
+      5.66733317291325e-01,
+      1.40117339676942e-01,
+      1.87599862200771e-02,
+      1.27685506908071e-03,
+      8.76397405988154e-06,
+      -1.90294986721073e-06,
+      -7.39020160622772e-08,
+    },
+    {
+      8.10778762576884e-05, 0,
+      6.65340842513387e-04, 0,
+      1.52852264942192e-03, 0,
+      2.22035724073886e-03, 0,
+    },
+    8,
+    64 * 44100,
+    "clans-8",
+    0, 0, 0
+  },
+  {
+    {
+      7.44453769826547e-01,
+      2.69850507860307e-01,
+      6.16093616071757e-02,
+      9.52771711245796e-03,
+      1.02903114196526e-03,
+      6.63758229311911e-05,
+      2.91124056073927e-06,
+      -4.29323230577427e-08,
+    },
+    {
+      8.10778762576884e-05, 0,
+      6.65340842513387e-04, 0,
+      1.52852264942192e-03, 0,
+      2.22035724073886e-03, 0,
+    },
+    8,
+    64 * 44100,
+    "sdm-8",
+    0, 0, 0
+  },
+};
+
+static const sdm_filter_t *sdm_find_filter(const char *name, unsigned freq)
+{
+  unsigned i;
+
+  for (i = 0; i < array_length(sdm_filters); i++)
+    if (!name || !strcmp(name, sdm_filters[i].name))
+      if (sdm_filters[i].freq <= freq)
+        return &sdm_filters[i];
+
+  return NULL;
+}
+
+#include "sdm_x86.h"
+
+#ifndef sdm_filter_calc
+static double sdm_filter_calc(const double *s, double *d,
+                              const sdm_filter_t *f,
+                              double x, double y)
+{
+  const double *a = f->a;
+  const double *g = f->g;
+  double v;
+  int i;
+
+  d[0] = s[0] - g[0] * s[1] + x - y;
+  v = x + a[0] * d[0];
+
+  for (i = 1; i < f->order - 1; i++) {
+    d[i] = s[i] + s[i - 1] - g[i] * s[i + 1];
+    v += a[i] * d[i];
+  }
+
+  d[i] = s[i] + s[i - 1];
+  v += a[i] * d[i];
+
+  return v;
+}
+#endif
+
+#ifndef sdm_filter_calc2
+static void sdm_filter_calc2(sdm_state_t *src, sdm_state_t *dst,
+                             const sdm_filter_t *f, double x)
+{
+  const double *a = f->a;
+  double v;
+  int i;
+
+  v = sdm_filter_calc(src->state, dst[0].state, f, x, 0.0);
+
+  for (i = 0; i < f->order; i++)
+    dst[1].state[i] = dst[0].state[i];
+
+  dst[0].state[0] += 1.0;
+  dst[1].state[0] -= 1.0;
+
+  dst[0].cost = src->cost + sqr(v + a[0]);
+  dst[1].cost = src->cost + sqr(v - a[0]);
+}
+#endif
+
+static inline unsigned sdm_histbuf_get(sdm_t *p)
+{
+  return p->hist_free[--p->hist_fnum];
+}
+
+static inline void sdm_histbuf_put(sdm_t *p, unsigned h)
+{
+  p->hist_free[p->hist_fnum++] = h;
+}
+
+static inline unsigned get_bit(uint8_t *p, unsigned i)
+{
+  return (p[i >> 3] >> (i & 7)) & 1;
+}
+
+static inline void put_bit(uint8_t *p, unsigned i, unsigned v)
+{
+  int b = p[i >> 3];
+  int s = i & 7;
+  b &= ~(1 << s);
+  b |= v << s;
+  p[i >> 3] = b;
+}
+
+static inline unsigned sdm_hist_get(sdm_t *p, unsigned h, unsigned i)
+{
+  return get_bit(p->hist[h], i);
+}
+
+static inline void sdm_hist_put(sdm_t *p, unsigned h, unsigned i, unsigned v)
+{
+  put_bit(p->hist[h], i, v);
+}
+
+static inline void sdm_hist_copy(sdm_t *p, unsigned d, unsigned s)
+{
+  memcpy(p->hist[d], p->hist[s], (size_t)(p->trellis_lat + 7) / 8);
+}
+
+static inline int64_t dbl2int64(double a)
+{
+  union { double d; int64_t i; } v;
+  v.d = a;
+  return v.i;
+}
+
+static inline int sdm_cmplt(sdm_state_t *a, sdm_state_t *b)
+{
+  return dbl2int64(a->cost) < dbl2int64(b->cost);
+}
+
+static inline int sdm_cmple(sdm_state_t *a, sdm_state_t *b)
+{
+  return dbl2int64(a->cost) <= dbl2int64(b->cost);
+}
+
+static sdm_state_t *sdm_check_path(sdm_t *p, sdm_state_t *s)
+{
+  unsigned index = s->path & PATH_HASH_MASK;
+  sdm_state_t **hash = p->path_hash;
+  sdm_state_t *t = hash[index];
+
+  while (t) {
+    if (t->path == s->path)
+      return t;
+    t = t->path_list;
+  }
+
+  s->path_list = hash[index];
+  hash[index] = s;
+
+  return NULL;
+}
+
+static unsigned sdm_sort_cands(sdm_t *p, sdm_trellis_t *st)
+{
+  sdm_state_t *r, *s, *t;
+  sdm_state_t *min;
+  unsigned i, j, n;
+
+  for (i = 0; i < 2 * p->num_cands; i++) {
+    s = &st->sdm[i];
+    p->path_hash[s->path & PATH_HASH_MASK] = NULL;
+    if (!i || sdm_cmplt(s, min))
+      min = s;
+  }
+
+  for (i = 0, n = 0; i < 2 * p->num_cands; i++) {
+    s = &st->sdm[i];
+
+    if (s->next != min->next)
+      continue;
+
+    if (n == p->trellis_num && sdm_cmple(st->act[n - 1], s))
+      continue;
+
+    t = sdm_check_path(p, s);
+
+    if (!t) {
+      for (j = n; j > 0; j--) {
+        t = st->act[j - 1];
+        if (sdm_cmple(t, s))
+          break;
+        st->act[j] = t;
+      }
+      if (j < p->trellis_num)
+        st->act[j] = s;
+      if (n < p->trellis_num)
+        n++;
+      continue;
+    }
+
+    if (sdm_cmple(t, s))
+      continue;
+
+    for (j = 0; j < n; j++) {
+      r = st->act[j];
+      if (sdm_cmple(s, r))
+        break;
+    }
+
+    st->act[j++] = s;
+
+    while (r != t && j < n) {
+      sdm_state_t *u = st->act[j];
+      st->act[j] = r;
+      r = u;
+      j++;
+    }
+  }
+
+  return n;
+}
+
+static inline void sdm_step(sdm_t *p, sdm_state_t *cur, sdm_state_t *next,
+                            double x)
+{
+  const sdm_filter_t *f = p->filter;
+  int i;
+
+  sdm_filter_calc2(cur, next, f, x);
+
+  for (i = 0; i < 2; i++) {
+    next[i].path = (cur->path << 1 | i) & p->trellis_mask;
+    next[i].hist = cur->hist;
+    next[i].next = cur->next;
+    next[i].parent = cur;
+  }
+}
+
+static sox_sample_t sdm_sample_trellis(sdm_t *p, double x)
+{
+  sdm_trellis_t *st_cur = &p->trellis[p->idx];
+  sdm_trellis_t *st_next = &p->trellis[p->idx ^ 1];
+  double min_cost;
+  unsigned new_cands;
+  unsigned next_pos;
+  unsigned output;
+  unsigned i;
+
+  next_pos = p->pos + 1;
+  if (next_pos == p->trellis_lat)
+    next_pos = 0;
+
+  for (i = 0; i < p->num_cands; i++) {
+    sdm_state_t *cur = st_cur->act[i];
+    sdm_state_t *next = &st_next->sdm[2 * i];
+    sdm_step(p, cur, next, x);
+    cur->next = sdm_hist_get(p, cur->hist, next_pos);
+    cur->hist_used = 0;
+  }
+
+  new_cands = sdm_sort_cands(p, st_next);
+  min_cost = st_next->act[0]->cost;
+  output = st_next->act[0]->next;
+
+  for (i = 0; i < new_cands; i++) {
+    sdm_state_t *s = st_next->act[i];
+    if (s->parent->hist_used) {
+      unsigned h = sdm_histbuf_get(p);
+      sdm_hist_copy(p, h, s->hist);
+      s->hist = h;
+    } else {
+      s->parent->hist_used = 1;
+    }
+
+    s->cost -= min_cost;
+    s->next = s->parent->next;
+    sdm_hist_put(p, s->hist, p->pos, s->path & 1);
+  }
+
+  for (i = 0; i < p->num_cands; i++) {
+    sdm_state_t *s = st_cur->act[i];
+    if (!s->hist_used)
+      sdm_histbuf_put(p, s->hist);
+  }
+
+  if (new_cands < p->num_cands)
+    p->conv_fail++;
+
+  p->num_cands = new_cands;
+  p->pos = next_pos;
+  p->idx ^= 1;
+
+  return output ? SOX_SAMPLE_MAX : -SOX_SAMPLE_MAX;
+}
+
+static sox_sample_t sdm_sample(sdm_t *p, double x)
+{
+  const sdm_filter_t *f = p->filter;
+  double *s0 = p->trellis[0].sdm[p->idx].state;
+  double *s1 = p->trellis[0].sdm[p->idx ^ 1].state;
+  double y, v;
+
+  v = sdm_filter_calc(s0, s1, f, x, p->prev_y);
+  y = signbit(v) ? -1.0 : 1.0;
+
+  p->idx ^= 1;
+  p->prev_y = y;
+
+  return y * SOX_SAMPLE_MAX;
+}
+
+int sdm_process(sdm_t *p, const sox_sample_t *ibuf, sox_sample_t *obuf,
+                size_t *ilen, size_t *olen)
+{
+  sox_sample_t *out = obuf;
+  size_t len = *ilen = min(*ilen, *olen);
+  double x;
+
+  if (p->trellis_mask) {
+    if (p->pending < p->trellis_lat) {
+      size_t pre = min(p->trellis_lat - p->pending, len);
+      p->pending += pre;
+      len -= pre;
+      while (pre--) {
+        x = *ibuf++ * (0.5 / SOX_SAMPLE_MAX);
+        sdm_sample_trellis(p, x);
+      }
+    }
+    while (len--) {
+      x = *ibuf++ * (0.5 / SOX_SAMPLE_MAX);
+      *out++ = sdm_sample_trellis(p, x);
+    }
+  } else {
+    while (len--) {
+      x = *ibuf++ * (0.5 / SOX_SAMPLE_MAX);
+      *out++ = sdm_sample(p, x);
+    }
+  }
+
+  *olen = out - obuf;
+
+  return SOX_SUCCESS;
+}
+
+int sdm_drain(sdm_t *p, sox_sample_t *obuf, size_t *olen)
+{
+  if (p->trellis_mask) {
+    size_t len = *olen = min(p->pending, *olen);
+
+    if (!p->draining && p->pending < p->trellis_lat) {
+      unsigned flush = p->trellis_lat - p->pending;
+      while (flush--)
+        sdm_sample_trellis(p, 0.0);
+    }
+
+    p->draining = 1;
+    p->pending -= len;
+
+    while (len--)
+      *obuf++ = sdm_sample_trellis(p, 0.0);
+  } else {
+    *olen = 0;
+  }
+
+  return SOX_SUCCESS;
+}
+
+sdm_t *sdm_init(const char *filter_name,
+                unsigned freq,
+                unsigned trellis_order,
+                unsigned trellis_num,
+                unsigned trellis_latency)
+{
+  sdm_t *p;
+  const sdm_filter_t *f;
+  sdm_trellis_t *st;
+  unsigned i;
+
+  if (trellis_order > SDM_TRELLIS_MAX_ORDER) {
+    lsx_fail("trellis order too high (max %d)", SDM_TRELLIS_MAX_ORDER);
+    return NULL;
+  }
+
+  if (trellis_num > SDM_TRELLIS_MAX_NUM) {
+    lsx_fail("trellis size too high (max %d)", SDM_TRELLIS_MAX_NUM);
+    return NULL;
+  }
+
+  if (trellis_latency > SDM_TRELLIS_MAX_LAT) {
+    lsx_fail("trellis latency too high (max %d)", SDM_TRELLIS_MAX_LAT);
+    return NULL;
+  }
+
+  p = aligned_alloc((size_t)32, sizeof(*p));
+  if (!p)
+    return NULL;
+
+  memset(p, 0, sizeof(*p));
+
+  p->filter = sdm_find_filter(filter_name, freq);
+  if (!p->filter) {
+    lsx_fail("invalid filter name `%s'", filter_name);
+    return NULL;
+  }
+
+  f = p->filter;
+  st = &p->trellis[0];
+
+  if (trellis_order || f->trellis_order) {
+    if (trellis_order < 1)
+      trellis_order = f->trellis_order ? f->trellis_order : 13;
+
+    if (trellis_num)
+      p->trellis_num = trellis_num;
+    else
+      p->trellis_num = f->trellis_num ? f->trellis_num : 8;
+
+    if (trellis_latency)
+      p->trellis_lat = trellis_latency;
+    else
+      p->trellis_lat = f->trellis_lat ? f->trellis_lat : 1024;
+
+    p->trellis_mask = ((uint64_t)1 << trellis_order) - 1;
+
+    for (i = 0; i < 2 * p->trellis_num; i++)
+      sdm_histbuf_put(p, i);
+
+    p->num_cands = 1;
+
+    st->sdm[0].hist = sdm_histbuf_get(p);
+    st->sdm[0].path = 0;
+    st->act[0] = &st->sdm[0];
+  }
+
+  return p;
+}
+
+void sdm_close(sdm_t *p)
+{
+  if (p->conv_fail)
+    lsx_warn("failed to converge %"PRId64" times", p->conv_fail);
+
+  aligned_free(p);
+}
+
+typedef struct sdm_effect {
+  sdm_t        *sdm;
+  const char   *filter_name;
+  uint32_t      trellis_order;
+  uint32_t      trellis_num;
+  uint32_t      trellis_lat;
+} sdm_effect_t;
+
+static int getopts(sox_effect_t *effp, int argc, char **argv)
+{
+  sdm_effect_t *p = effp->priv;
+  lsx_getopt_t optstate;
+  int c;
+
+  lsx_getopt_init(argc, argv, "+f:t:n:l:", NULL, lsx_getopt_flag_none,
+                  1, &optstate);
+
+  while ((c = lsx_getopt(&optstate)) != -1) switch (c) {
+    case 'f': p->filter_name = optstate.arg; break;
+    GETOPT_NUMERIC(optstate, 't', trellis_order, 3, SDM_TRELLIS_MAX_ORDER)
+    GETOPT_NUMERIC(optstate, 'n', trellis_num, 4, SDM_TRELLIS_MAX_NUM)
+    GETOPT_NUMERIC(optstate, 'l', trellis_lat, 100, SDM_TRELLIS_MAX_LAT)
+    default: lsx_fail("invalid option `-%c'", optstate.opt); return lsx_usage(effp);
+  }
+
+  return argc != optstate.ind ? lsx_usage(effp) : SOX_SUCCESS;
+}
+
+static int start(sox_effect_t *effp)
+{
+  sdm_effect_t *p = effp->priv;
+
+  p->sdm = sdm_init(p->filter_name, effp->in_signal.rate,
+                    p->trellis_order, p->trellis_num, p->trellis_lat);
+  if (!p->sdm)
+    return SOX_EOF;
+
+  effp->out_signal.precision = 1;
+
+  return SOX_SUCCESS;
+}
+
+static int flow(sox_effect_t *effp, const sox_sample_t *ibuf,
+                sox_sample_t *obuf, size_t *isamp, size_t *osamp)
+{
+  sdm_effect_t *p = effp->priv;
+  return sdm_process(p->sdm, ibuf, obuf, isamp, osamp);
+}
+
+static int drain(sox_effect_t *effp, sox_sample_t *obuf, size_t *osamp)
+{
+  sdm_effect_t *p = effp->priv;
+  return sdm_drain(p->sdm, obuf, osamp);
+}
+
+static int stop(sox_effect_t *effp)
+{
+  sdm_effect_t *p = effp->priv;
+  sdm_close(p->sdm);
+  return SOX_SUCCESS;
+}
+
+const sox_effect_handler_t *lsx_sdm_effect_fn(void)
+{
+  static sox_effect_handler_t handler = {
+    "sdm", "[-f filter] [-t order] [-n num] [-l latency]"
+    "\n  -f       Noise-shaping filter"
+    "\n           Advanced options:"
+    "\n  -t       Override trellis order"
+    "\n  -n       Override number of trellis paths"
+    "\n  -l       Override trellis latency",
+    SOX_EFF_PREC, getopts, start, flow, drain, stop, 0, sizeof(sdm_effect_t),
+  };
+  return &handler;
+}
diff --git a/src/sdm.h b/src/sdm.h
new file mode 100644
index 00000000..38c2e898
--- /dev/null
+++ b/src/sdm.h
@@ -0,0 +1,43 @@
+/* Sigma-Delta modulator
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#ifndef SOX_SDM_H
+#define SOX_SDM_H
+
+#include "sox_i.h"
+
+#define SDM_TRELLIS_MAX_ORDER 32
+#define SDM_TRELLIS_MAX_NUM   32
+#define SDM_TRELLIS_MAX_LAT   2048
+
+typedef struct sdm sdm_t;
+
+sdm_t *sdm_init(const char *filter_name,
+                unsigned freq,
+                unsigned trellis_order,
+                unsigned trellis_num,
+                unsigned trellis_latency);
+
+int sdm_process(sdm_t *s, const sox_sample_t *ibuf, sox_sample_t *obuf,
+                size_t *ilen, size_t *olen);
+
+int sdm_drain(sdm_t *s, sox_sample_t *obuf, size_t *olen);
+
+void sdm_close(sdm_t *s);
+
+#endif
diff --git a/src/sdm_x86.h b/src/sdm_x86.h
new file mode 100644
index 00000000..a40833d0
--- /dev/null
+++ b/src/sdm_x86.h
@@ -0,0 +1,235 @@
+/* Sigma-Delta modulator
+ * Copyright (c) 2015 Mans Rullgard <mans@mansr.com>
+ *
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or (at
+ * your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, write to the Free Software Foundation,
+ * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#ifndef SOX_SDM_X86_H
+#define SOX_SDM_X86_H
+
+#ifdef __AVX__
+
+#include <immintrin.h>
+
+#define SDM_FILTER_AVX(s0, s1, src, x) do {                               \
+    __m256d tx, t0, t1, t2;                                               \
+    __m256d p0, p1;                                                       \
+    __m256d sx;                                                           \
+                                                                          \
+    sx = _mm256_set1_pd(x);                                               \
+    s0 = _mm256_load_pd(src);                                             \
+    s1 = _mm256_load_pd(src + 4);                                         \
+                                                                          \
+    p0 = _mm256_permute_pd(s0, 5);                                        \
+    p1 = _mm256_permute_pd(s1, 5);                                        \
+                                                                          \
+    tx = _mm256_blend_pd(p0, _mm256_permute2f128_pd(sx, p0, 0x21), 0x5);  \
+    t0 = _mm256_blend_pd(p1, _mm256_permute2f128_pd(p0, p1, 0x21), 0x5);  \
+    t1 = _mm256_permute2f128_pd(tx, t0, 0x21);                            \
+    t2 = _mm256_blend_pd(p1, _mm256_permute2f128_pd(p1, p1, 0x21), 0xa);  \
+                                                                          \
+    s0 = _mm256_add_pd(s0, tx);                                           \
+    s1 = _mm256_add_pd(s1, t0);                                           \
+                                                                          \
+    s0 = _mm256_sub_pd(s0, _mm256_mul_pd(t1, _mm256_load_pd(g)));         \
+    s1 = _mm256_sub_pd(s1, _mm256_mul_pd(t2, _mm256_load_pd(g + 4)));     \
+  } while (0)
+
+#define sdm_filter_calc sdm_filter_calc_avx
+static double sdm_filter_calc_avx(const double *src, double *dst,
+                                  const sdm_filter_t *f,
+                                  double x, double y)
+{
+  const double *a = f->a;
+  const double *g = f->g;
+  __m256d s0, s1;
+  __m256d v0, v1;
+  __m128d v;
+
+  SDM_FILTER_AVX(s0, s1, src, x - y);
+
+  _mm256_store_pd(dst,     s0);
+  _mm256_store_pd(dst + 4, s1);
+
+  v0 = _mm256_mul_pd(s0, _mm256_load_pd(a));
+  v1 = _mm256_mul_pd(s1, _mm256_load_pd(a + 4));
+  v0 = _mm256_add_pd(v0, v1);
+
+  v = _mm_add_pd(_mm256_castpd256_pd128(v0), _mm256_extractf128_pd(v0, 1));
+  v = _mm_add_pd(v, _mm_permute_pd(v, 1));
+
+  return x + _mm_cvtsd_f64(v);
+}
+
+#define sdm_filter_calc2 sdm_filter_calc2_avx
+static void sdm_filter_calc2_avx(sdm_state_t *src, sdm_state_t *dst,
+                                 const sdm_filter_t *f, double x)
+{
+  const double *a = f->a;
+  const double *g = f->g;
+  __m256d s0, s1;
+  __m256d t0, t1;
+  __m256d v0, v1, v2;
+  __m128d r0, r1;
+  __m256d a0;
+
+  SDM_FILTER_AVX(s0, s1, src->state, x);
+
+  t1 = _mm256_set_pd(0.0, 0.0, 0.0, 1.0);
+  t0 = _mm256_sub_pd(s0, t1);
+  s0 = _mm256_add_pd(s0, t1);
+
+  _mm256_store_pd(dst[0].state,     s0);
+  _mm256_store_pd(dst[0].state + 4, s1);
+
+  _mm256_store_pd(dst[1].state,     t0);
+  _mm256_store_pd(dst[1].state + 4, s1);
+
+  a0 = _mm256_load_pd(a);
+  v0 = _mm256_mul_pd(s0, a0);
+  v1 = _mm256_mul_pd(t0, a0);
+  v2 = _mm256_mul_pd(s1, _mm256_load_pd(a + 4));
+
+  v0 = _mm256_add_pd(v0, v2);
+  v1 = _mm256_add_pd(v1, v2);
+
+  r0 = _mm_add_pd(_mm256_castpd256_pd128(v0), _mm256_extractf128_pd(v0, 1));
+  r1 = _mm_add_pd(_mm256_castpd256_pd128(v1), _mm256_extractf128_pd(v1, 1));
+
+  r0 = _mm_add_pd(r0, _mm_permute_pd(r1, 1));
+  r0 = _mm_add_pd(r0, _mm_set1_pd(x));
+  r0 = _mm_mul_pd(r0, r0);
+
+  r0 = _mm_add_pd(r0, _mm_load1_pd(&src->cost));
+
+  _mm_storel_pd(&dst[0].cost, r0);
+  _mm_storeh_pd(&dst[1].cost, r0);
+}
+
+#elif defined __SSE2__ || defined _M_X64 || \
+  (defined _M_IX86_FP && _M_IX86_FP >= 2)
+
+#include <emmintrin.h>
+
+#define SWAPHL(x) \
+  _mm_castsi128_pd(_mm_shuffle_epi32(_mm_castpd_si128(x), 0x4e))
+
+#define SDM_FILTER_SSE2(s0, s1, s2, s3, src, x) do {            \
+    __m128d tx, t0, t1, t2, t3;                                 \
+    __m128d sx;                                                 \
+                                                                \
+    sx = _mm_set1_pd(x);                                        \
+    s0 = _mm_load_pd(src);                                      \
+    s1 = _mm_load_pd(src + 2);                                  \
+    s2 = _mm_load_pd(src + 4);                                  \
+    s3 = _mm_load_pd(src + 6);                                  \
+                                                                \
+    tx = _mm_shuffle_pd(sx, s0, 1);                             \
+    t0 = _mm_shuffle_pd(s0, s1, 1);                             \
+    t1 = _mm_shuffle_pd(s1, s2, 1);                             \
+    t2 = _mm_shuffle_pd(s2, s3, 1);                             \
+    t3 = _mm_shuffle_pd(s3, s3, 1);                             \
+                                                                \
+    s0 = _mm_add_pd(s0, tx);                                    \
+    s1 = _mm_add_pd(s1, t0);                                    \
+    s2 = _mm_add_pd(s2, t1);                                    \
+    s3 = _mm_add_pd(s3, t2);                                    \
+                                                                \
+    s0 = _mm_sub_pd(s0, _mm_mul_pd(t0, _mm_load_pd(g)));        \
+    s1 = _mm_sub_pd(s1, _mm_mul_pd(t1, _mm_load_pd(g + 2)));    \
+    s2 = _mm_sub_pd(s2, _mm_mul_pd(t2, _mm_load_pd(g + 4)));    \
+    s3 = _mm_sub_pd(s3, _mm_mul_pd(t3, _mm_load_pd(g + 6)));    \
+  } while (0)
+
+#define sdm_filter_calc sdm_filter_calc_sse2
+static double sdm_filter_calc_sse2(const double *src, double *dst,
+                                   const sdm_filter_t *f,
+                                   double x, double y)
+{
+  const double *a = f->a;
+  const double *g = f->g;
+  __m128d s0, s1, s2, s3;
+  __m128d v0, v1;
+
+  SDM_FILTER_SSE2(s0, s1, s2, s3, src, x - y);
+
+  _mm_store_pd(dst,     s0);
+  _mm_store_pd(dst + 2, s1);
+  _mm_store_pd(dst + 4, s2);
+  _mm_store_pd(dst + 6, s3);
+
+  v0 = _mm_mul_pd(s0, _mm_load_pd(a));
+  v1 = _mm_mul_pd(s1, _mm_load_pd(a + 2));
+  v0 = _mm_add_pd(v0, _mm_mul_pd(s2, _mm_load_pd(a + 4)));
+  v1 = _mm_add_pd(v1, _mm_mul_pd(s3, _mm_load_pd(a + 6)));
+  v0 = _mm_add_pd(v0, v1);
+  v0 = _mm_add_pd(v0, SWAPHL(v0));
+
+  return x + _mm_cvtsd_f64(v0);
+}
+
+#define sdm_filter_calc2 sdm_filter_calc2_sse2
+static void sdm_filter_calc2_sse2(sdm_state_t *src, sdm_state_t *dst,
+                                  const sdm_filter_t *f, double x)
+{
+  const double *a = f->a;
+  const double *g = f->g;
+  __m128d s0, s1, s2, s3;
+  __m128d v0, v1, v2, v3;
+  __m128d t0, t1;
+  __m128d a0;
+
+  SDM_FILTER_SSE2(s0, s1, s2, s3, src->state, x);
+
+  t1 = _mm_set_sd(1.0);
+  t0 = _mm_sub_pd(s0, t1);
+  s0 = _mm_add_pd(s0, t1);
+
+  _mm_store_pd(dst[0].state,     s0);
+  _mm_store_pd(dst[0].state + 2, s1);
+  _mm_store_pd(dst[0].state + 4, s2);
+  _mm_store_pd(dst[0].state + 6, s3);
+
+  _mm_store_pd(dst[1].state,     t0);
+  _mm_store_pd(dst[1].state + 2, s1);
+  _mm_store_pd(dst[1].state + 4, s2);
+  _mm_store_pd(dst[1].state + 6, s3);
+
+  a0 = _mm_load_pd(a);
+  v0 = _mm_mul_pd(s0, a0);
+  t0 = _mm_mul_pd(t0, a0);
+  v1 = _mm_mul_pd(s1, _mm_load_pd(a + 2));
+  v2 = _mm_mul_pd(s2, _mm_load_pd(a + 4));
+  v3 = _mm_mul_pd(s3, _mm_load_pd(a + 6));
+
+  v1 = _mm_add_pd(v1, v2);
+  v1 = _mm_add_pd(v1, v3);
+
+  v0 = _mm_add_pd(v0, v1);
+  t0 = _mm_add_pd(t0, v1);
+
+  v0 = _mm_add_pd(v0, SWAPHL(t0));
+  v0 = _mm_add_pd(v0, _mm_set1_pd(x));
+
+  v0 = _mm_mul_pd(v0, v0);
+  v0 = _mm_add_pd(v0, _mm_load1_pd(&src->cost));
+
+  _mm_storel_pd(&dst[0].cost, v0);
+  _mm_storeh_pd(&dst[1].cost, v0);
+}
+
+#endif
+
+#endif
diff --git a/src/sox.h b/src/sox.h
index 155742e1..7d307427 100644
--- a/src/sox.h
+++ b/src/sox.h
@@ -32,6 +32,19 @@ extern "C" {
 #pragma GCC system_header
 #endif
 
+#if defined __GNUC__
+#define LSX_GCC(maj, min) \
+  ((__GNUC__ > (maj)) || (__GNUC__ == (maj) && __GNUC_MINOR__ >= (min)))
+#else
+#define LSX_GCC(maj, min) 0
+#endif
+
+#if LSX_GCC(4,9)
+#define _Ret_ __attribute__ ((returns_nonnull))
+#define _Ret_valid_ _Ret_
+#define _Ret_z_ _Ret_
+#endif
+
 /*****************************************************************************
 API decoration macros:
 Mostly for documentation purposes. For some compilers, decorations also affect
@@ -594,6 +607,7 @@ typedef enum sox_encoding_t {
   SOX_ENCODING_CVSD      , /**< Continuously Variable Slope Delta modulation */
   SOX_ENCODING_LPC10     , /**< Linear Predictive Coding */
   SOX_ENCODING_OPUS      , /**< Opus compression */
+  SOX_ENCODING_DSD       , /**< Direct Stream Digital */
 
   SOX_ENCODINGS            /**< End of list marker */
 } sox_encoding_t;
@@ -2450,7 +2464,7 @@ Finds the file extension for a filename.
 @returns the file extension, not including the '.', or null if filename does
 not have an extension.
 */
-LSX_RETURN_VALID_Z LSX_RETURN_PURE
+LSX_RETURN_OPT LSX_RETURN_PURE
 char const *
 LSX_API
 lsx_find_file_extension(
diff --git a/src/util.h b/src/util.h
index 87970bb9..b5cc9b89 100644
--- a/src/util.h
+++ b/src/util.h
@@ -184,6 +184,26 @@
 #define field_offset(type, field) ((size_t)&(((type *)0)->field))
 #define unless(x) if (!(x))
 
+/*----------------------------- Data alignment -------------------------------*/
+
+#ifdef __GNUC__
+#define LSX_ALIGN(n) __attribute__((aligned(n)))
+#elif defined _MSC_VER
+#define LSX_ALIGN(n) __declspec(align(n))
+#else
+#define LSX_ALIGN(n)
+#endif
+
+#ifdef HAVE_ALIGNED_ALLOC
+  #define aligned_free(p) free(p)
+#elif defined _MSC_VER
+  #define aligned_alloc(a, s) _aligned_malloc(s, a)
+  #define aligned_free(p) _aligned_free(p)
+#else
+  #define aligned_alloc(a, s) malloc(s)
+  #define aligned_free(p) free(p)
+#endif
+
 /*------------------------------- Maths stuff --------------------------------*/
 
 #include <math.h>
diff --git a/src/vorbis.c b/src/vorbis.c
index 267fb803..aafce7e2 100644
--- a/src/vorbis.c
+++ b/src/vorbis.c
@@ -316,9 +316,8 @@ static int startwrite(sox_format_t * ft)
     }
     quality = ft->encoding.compression;
   }
-#define IGNORE_WARNING \
+
   if (vorbis_encode_init_vbr(&ve->vi, ft->signal.channels, ft->signal.rate + .5, quality / 10))
-#include "ignore-warning.h"
   {
     lsx_fail_errno(ft, SOX_EFMT, "libVorbis cannot encode this sample-rate or # of channels");
     return SOX_EOF;
diff --git a/src/wav.c b/src/wav.c
index 5202556c..066be6d7 100644
--- a/src/wav.c
+++ b/src/wav.c
@@ -82,6 +82,7 @@ typedef struct {
     /* following used by *ADPCM wav files */
     unsigned short nCoefs;          /* ADPCM: number of coef sets */
     short         *lsx_ms_adpcm_i_coefs;          /* ADPCM: coef sets           */
+    void          *ms_adpcm_data;   /* Private data of adpcm decoder */
     unsigned char *packet;          /* Temporary buffer for packets */
     short         *samples;         /* interleaved samples buffer */
     short         *samplePtr;       /* Pointer to current sample  */
@@ -127,7 +128,7 @@ static unsigned short  ImaAdpcmReadBlock(sox_format_t * ft)
         /* work with partial blocks.  Specs say it should be null */
         /* padded but I guess this is better than trailing quiet. */
         samplesThisBlock = lsx_ima_samples_in((size_t)0, (size_t)ft->signal.channels, bytesRead, (size_t) 0);
-        if (samplesThisBlock == 0)
+        if (samplesThisBlock == 0 || samplesThisBlock > wav->samplesPerBlock)
         {
             lsx_warn("Premature EOF on .wav input file");
             return 0;
@@ -175,7 +176,7 @@ static unsigned short  AdpcmReadBlock(sox_format_t * ft)
         }
     }
 
-    errmsg = lsx_ms_adpcm_block_expand_i(ft->signal.channels, wav->nCoefs, wav->lsx_ms_adpcm_i_coefs, wav->packet, wav->samples, samplesThisBlock);
+    errmsg = lsx_ms_adpcm_block_expand_i(wav->ms_adpcm_data, ft->signal.channels, wav->nCoefs, wav->lsx_ms_adpcm_i_coefs, wav->packet, wav->samples, samplesThisBlock);
 
     if (errmsg)
         lsx_warn("%s", errmsg);
@@ -712,6 +713,11 @@ static int startread(sox_format_t * ft)
     else
         lsx_report("User options overriding channels read in .wav header");
 
+    if (ft->signal.channels == 0) {
+        lsx_fail_errno(ft, SOX_EHDR, "Channel count is zero");
+        return SOX_EOF;
+    }
+
     if (ft->signal.rate == 0 || ft->signal.rate == dwSamplesPerSecond)
         ft->signal.rate = dwSamplesPerSecond;
     else
@@ -786,6 +792,7 @@ static int startread(sox_format_t * ft)
 
         /* nCoefs, lsx_ms_adpcm_i_coefs used by adpcm.c */
         wav->lsx_ms_adpcm_i_coefs = lsx_malloc(wav->nCoefs * 2 * sizeof(short));
+        wav->ms_adpcm_data = lsx_ms_adpcm_alloc(wChannels);
         {
             int i, errct=0;
             for (i=0; len>=2 && i < 2*wav->nCoefs; i++) {
@@ -1211,6 +1218,7 @@ static int stopread(sox_format_t * ft)
     free(wav->packet);
     free(wav->samples);
     free(wav->lsx_ms_adpcm_i_coefs);
+    free(wav->ms_adpcm_data);
     free(wav->comment);
     wav->comment = NULL;
 
@@ -1374,6 +1382,12 @@ static int wavwritehdr(sox_format_t * ft, int second_header)
     long blocksWritten = 0;
     sox_bool isExtensible = sox_false;    /* WAVE_FORMAT_EXTENSIBLE? */
 
+    if (ft->signal.channels > UINT16_MAX) {
+        lsx_fail_errno(ft, SOX_EOF, "Too many channels (%u)",
+                       ft->signal.channels);
+        return SOX_EOF;
+    }
+
     dwSamplesPerSecond = ft->signal.rate;
     wChannels = ft->signal.channels;
     wBitsPerSample = ft->encoding.bits_per_sample;
diff --git a/src/xa.c b/src/xa.c
index 81a76772..9fc086ec 100644
--- a/src/xa.c
+++ b/src/xa.c
@@ -143,6 +143,12 @@ static int startread(sox_format_t * ft)
         lsx_report("User options overriding rate read in .xa header");
     }
 
+    if (ft->signal.channels == 0 || ft->signal.channels > UINT16_MAX) {
+        lsx_fail_errno(ft, SOX_EFMT, "invalid channel count %d",
+                       ft->signal.channels);
+        return SOX_EOF;
+    }
+
     /* Check for supported formats */
     if (ft->encoding.bits_per_sample != 16) {
         lsx_fail_errno(ft, SOX_EFMT, "%d-bit sample resolution not supported.",
diff --git a/src/xmalloc.c b/src/xmalloc.c
index 9bf15969..56fe6944 100644
--- a/src/xmalloc.c
+++ b/src/xmalloc.c
@@ -20,6 +20,16 @@
 #include "sox_i.h"
 #include <stdlib.h>
 
+static void *lsx_checkptr(void *ptr)
+{
+  if (!ptr) {
+    lsx_fail("out of memory");
+    exit(2);
+  }
+
+  return ptr;
+}
+
 /* Resize an allocated memory area; abort if not possible.
  *
  * For malloc, `If the size of the space requested is zero, the behavior is
@@ -34,10 +44,20 @@ void *lsx_realloc(void *ptr, size_t newsize)
     return NULL;
   }
 
-  if ((ptr = realloc(ptr, newsize)) == NULL) {
-    lsx_fail("out of memory");
-    exit(2);
-  }
+  return lsx_checkptr(realloc(ptr, newsize));
+}
 
-  return ptr;
+void *lsx_malloc(size_t size)
+{
+  return lsx_checkptr(malloc(size + !size));
+}
+
+void *lsx_calloc(size_t n, size_t size)
+{
+  return lsx_checkptr(calloc(n + !n, size + !size));
+}
+
+char *lsx_strdup(const char *s)
+{
+  return lsx_checkptr(strdup(s));
 }
diff --git a/src/xmalloc.h b/src/xmalloc.h
index 9ee77f63..92ac64d9 100644
--- a/src/xmalloc.h
+++ b/src/xmalloc.h
@@ -23,10 +23,11 @@
 #include <stddef.h>
 #include <string.h>
 
-#define lsx_malloc(size) lsx_realloc(NULL, (size))
-#define lsx_calloc(n,s) (((n)*(s))? memset(lsx_malloc((n)*(s)),0,(n)*(s)) : NULL)
+LSX_RETURN_VALID void *lsx_malloc(size_t size);
+LSX_RETURN_VALID void *lsx_calloc(size_t n, size_t size);
+LSX_RETURN_VALID char *lsx_strdup(const char *s);
+
 #define lsx_Calloc(v,n)  v = lsx_calloc(n,sizeof(*(v)))
-#define lsx_strdup(p) ((p)? strcpy((char *)lsx_malloc(strlen(p) + 1), p) : NULL)
 #define lsx_memdup(p,s) ((p)? memcpy(lsx_malloc(s), p, s) : NULL)
 #define lsx_valloc(v,n)  v = lsx_malloc((n)*sizeof(*(v)))
 #define lsx_revalloc(v,n)  v = lsx_realloc(v, (n)*sizeof(*(v)))
